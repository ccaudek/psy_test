

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>5. L’analisi di regressione &#8212; psy_test</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_measurement/015_regression';</script>
    <link rel="shortcut icon" href="../_static/increasing.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="6. Fondamenti teorici" href="../_ctt/020_ctt_1.html" />
    <link rel="prev" title="4. Probabilità congiunta" href="011_joint_prob.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="psy_test - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="psy_test - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Test psicometrici</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="002_measurement.html">1. La misurazione psicologica</a></li>
<li class="toctree-l1"><a class="reference internal" href="007_norms.html">2. Valutazioni normative e criteriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_expval_var.html">3. Variabili casuali</a></li>
<li class="toctree-l1"><a class="reference internal" href="011_joint_prob.html">4. Probabilità congiunta</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. L’analisi di regressione</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria classica dei test</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_ctt/020_ctt_1.html">6. Fondamenti teorici</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/021_ctt_2.html">7. L’affidabilità del test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/022_ctt_3.html">8. Metodi di stima dell’affidabilità</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/025_err_std_mis.html">9. L’errore standard della misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/026_err_std_stima.html">10. La stima del punteggio vero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/028_applications_ctt.html">11. Applicazioni della CTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/E_ctt_1.html">12. ✏️ Esercizi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Affidabilità tra giudici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_raters/030_multilevel_1.html">13. Modelli multilivello</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_raters/031_interrater_reliability.html">14. L’affidabilità tra giudici</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria della Generalizzabilità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_gtheory/041_gtheory.html">15. Teoria della generalizzabilità</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Validità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_validity/051_validity.html">16. La validità del test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_validity/055_relations_to_other_vars.html">17. Relazioni test-criterio</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi dei percorsi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_path_analysis/061_path_analysis.html">18. Analisi dei percorsi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi fattoriale</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_fa/150_intro_fa.html">19. Introduzione all’analisi fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/155_analisi_fattoriale_1.html">20. Il modello unifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/156_analisi_fattoriale_2.html">21. Il modello statistico dell’analisi fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/157_analisi_fattoriale_3.html">22. Il modello multifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/158_factor_scores.html">23. I punteggi fattoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/162_constraints_on_parms.html">24. Attendibilità e modello fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/163_total_score.html">25. Punteggio totale e modello fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/170_cfa_mod_comp.html">26. CFA: confronto tra modelli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/175_bifactor.html">27. Modello bifattoriale</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Costruzione di strumenti psicometrici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/201_valutare_le_matrici.html">28. Valutazione della matrice di correlazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/202_estrazione.html">29. L’estrazione dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/203_numero_fattori.html">30. Il numero dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/205_rotazione.html">31. La rotazione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/206_valutare_sol_fattoriale.html">32. Valutare e rifinire la soluzione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/225_mmm.html">33. CFA per matrici multi-tratto multi-metodo</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli di equazioni strutturali</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_sem/350_sem_intro.html">34. Introduzione ai Modelli SEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/351_data_preparation.html">35. Preparazione dei Dati</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/352_gof.html">36. Indici di bontà dell’adattamento</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/353_refine_solution.html">37. La revisione del modello</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/354_mod_comp.html">38. Confronto tra modelli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/355_group_invariance.html">39. Invarianza di misura</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/356_cat_data.html">40. Dati non gaussiani e categoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/357_multilevel_sem.html">41. Modelli di Equazioni Strutturali Multilivello</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/358_missing_data.html">42. Dati mancanti</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli IRT</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_irt/400_logistic_regr.html">43. Modello di regressione logistica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/401_rasch_model.html">44. Modello di Rasch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/402_assumptions.html">45. Assunzioni e Proprietà del Modello di Rasch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/403_estimation.html">46. Stima</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/405_1pl_2pl_3pl.html">47. Oltre il Modello di Rasch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/410_implementation.html">48. Implementazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/415_polytomous.html">49. Modelli per Risposte Politomiche</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_development/501_development.html">50. Sviluppo dello strumento</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_development/502_tutorial.html">51. Tutorial</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Curve di crescita latente</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_lgm/700_lgm_intro.html">52. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/701_lgm_prelims.html">53. Considerazioni Preliminari</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/702_time_effects.html">54. Dati longitudinali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/703_intro_panel.html">55. Specificare e Interpretare un Modello Longitudinale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/704_lgm_mixed.html">56. LGM e modelli misti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/705_growth_1.html">57. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/706_growth_cont.html">58. Il tempo su una metrica continua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/710_time_inv_cov.html">59. Covariate indipendenti dal tempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/711_growth_groups.html">60. Modelli di crescita latenti a gruppi multipli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/715_bivariate_growth_models.html">61. Modelli di crescita latenti bivariati</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/720_inv_measurement.html">62. Invarianza di misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/750_latent_change.html">63. Modello LCS univariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/751_biv_change.html">64. Modello LCS bivariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/755_lgm_meas_inv.html">65. Invarianza fattoriale nei modelli LGM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliografia</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../z_biblio.html">66. Bibliografia</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_appendix/901_intro_r.html">67. Linguaggio di programmazione R</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ccaudek/psy_test" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ccaudek/psy_test/issues/new?title=Issue%20on%20page%20%2F_measurement/015_regression.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_measurement/015_regression.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>L’analisi di regressione</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covarianza-e-correlazione">5.1. Covarianza e correlazione</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlazione">5.1.1. Correlazione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione">5.1.2. Interpretazione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-bivariata">5.2. Regressione bivariata</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regressori-centrati">5.2.1. Regressori centrati</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minimi-quadrati">5.2.2. Minimi quadrati</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relazione-tra-b-e-r">5.2.3. Relazione tra <span class="math notranslate nohighlight">\(b\)</span> e <span class="math notranslate nohighlight">\(r\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attenuazione">5.2.4. Attenuazione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#valori-predetti-e-residui">5.3. Valori predetti e residui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficiente-di-determinazione">5.4. Coefficiente di determinazione</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#errore-standard-della-regressione">5.4.1. Errore standard della regressione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-multipla">5.5. Regressione multipla</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#significato-dei-coefficienti-parziali-di-regressione">5.5.1. Significato dei coefficienti parziali di regressione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relazioni-causali">5.5.2. Relazioni causali</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#errore-di-specificazione">5.5.3. Errore di specificazione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soppressione">5.5.4. Soppressione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stepwise-regression">5.5.5. Stepwise regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-stepwise">5.5.6. Regressione Stepwise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proprieta-degli-stimatori-dei-minimi-quadrati">5.6. Proprietà degli stimatori dei minimi quadrati</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ipotesi-statistiche-e-statistica-test">5.6.1. Ipotesi statistiche e statistica test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#riportare-i-risultati">5.6.2. Riportare i risultati</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regola-di-decisione">5.6.2.1. Regola di decisione</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-conclusive">5.6.3. Considerazioni conclusive</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="l-analisi-di-regressione">
<h1><span class="section-number">5. </span>L’analisi di regressione<a class="headerlink" href="#l-analisi-di-regressione" title="Permalink to this heading">#</a></h1>
<p>La padronanza dell’analisi di regressione è fondamentale per comprendere la teoria classica dei test, l’analisi fattoriale e i modelli di equazioni strutturali. Sebbene le tecniche di analisi di regressione si concentrino esclusivamente sulle variabili osservate, i principi della regressione costituiscono la base per tecniche più avanzate che incorporano anche le variabili latenti. Questo capitolo fornisce una sintesi dei concetti fondamentali.</p>
<section id="covarianza-e-correlazione">
<h2><span class="section-number">5.1. </span>Covarianza e correlazione<a class="headerlink" href="#covarianza-e-correlazione" title="Permalink to this heading">#</a></h2>
<p>La discussione sull’associazione tra variabili inizia con la nozione di covarianza. La covarianza è una misura statistica che indica il grado di variazione congiunta di due variabili casuali. Se le variazioni delle due variabili tendono ad avvenire nella stessa direzione, la covarianza sarà positiva. Se tendono a variare in direzioni opposte, la covarianza sarà negativa. Una covarianza pari a zero indica che non c’è una relazione lineare tra le variabili.</p>
<p>La formula per calcolare la covarianza tra due variabili <span class="math notranslate nohighlight">\( X \)</span> e <span class="math notranslate nohighlight">\( Y \)</span> è:</p>
<div class="math notranslate nohighlight">
\[ \text{Cov}(X, Y) = \frac{\sum_{i=1}^{n} (X_i - \bar{X})(Y_i - \bar{Y})}{n-1}, \]</div>
<p>dove <span class="math notranslate nohighlight">\( \bar{X} \)</span> e <span class="math notranslate nohighlight">\( \bar{Y} \)</span> sono le medie delle variabili <span class="math notranslate nohighlight">\( X \)</span> e <span class="math notranslate nohighlight">\( Y \)</span>, rispettivamente, e <span class="math notranslate nohighlight">\( n \)</span> è il numero di osservazioni.</p>
<section id="correlazione">
<h3><span class="section-number">5.1.1. </span>Correlazione<a class="headerlink" href="#correlazione" title="Permalink to this heading">#</a></h3>
<p>La correlazione, invece, è una misura standardizzata della covarianza. Essa esprime il grado di relazione lineare tra due variabili in termini di forza e direzione, ma a differenza della covarianza, è indipendente dalle unità di misura delle variabili, rendendola più generale e facilmente interpretabile.</p>
<p>La formula della correlazione, nota anche come coefficiente di correlazione di Pearson, è:</p>
<div class="math notranslate nohighlight">
\[ r = \frac{\text{Cov}(X, Y)}{\sigma_X \sigma_Y}, \]</div>
<p>dove <span class="math notranslate nohighlight">\( \sigma_X \)</span> e <span class="math notranslate nohighlight">\( \sigma_Y \)</span> sono le deviazioni standard di <span class="math notranslate nohighlight">\( X \)</span> e <span class="math notranslate nohighlight">\( Y \)</span>. Il valore di <span class="math notranslate nohighlight">\( r \)</span> varia tra -1 e 1. Un valore di <span class="math notranslate nohighlight">\( r \)</span> vicino a 1 indica una forte correlazione positiva, un valore vicino a -1 indica una forte correlazione negativa, e un valore vicino a 0 indica che non c’è una correlazione lineare significativa.</p>
</section>
<section id="interpretazione">
<h3><span class="section-number">5.1.2. </span>Interpretazione<a class="headerlink" href="#interpretazione" title="Permalink to this heading">#</a></h3>
<p>Una correlazione elevata non implica necessariamente una relazione di causa ed effetto.</p>
<p>Esaminiamo un esempio numerico proposto da Bolin (2022).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rio</span><span class="o">::</span><span class="nf">import</span><span class="p">(</span><span class="s">&quot;data/bolin/chapter2ex.sav&quot;</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 6 x 3</caption>
<thead>
	<tr><th></th><th scope=col>effort</th><th scope=col>distraction</th><th scope=col>performance</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>14.76928</td><td>5.863615</td><td>2.560827</td></tr>
	<tr><th scope=row>2</th><td>15.37905</td><td>6.473276</td><td>3.040385</td></tr>
	<tr><th scope=row>3</th><td>15.03329</td><td>4.939044</td><td>4.610505</td></tr>
	<tr><th scope=row>4</th><td>14.43418</td><td>5.216717</td><td>2.315265</td></tr>
	<tr><th scope=row>5</th><td>13.89848</td><td>3.496717</td><td>1.130678</td></tr>
	<tr><th scope=row>6</th><td>15.46183</td><td>4.489045</td><td>3.021215</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">chart.Correlation</span><span class="p">(</span><span class="n">d</span><span class="p">,</span><span class="w"> </span><span class="n">histogram</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;pearson&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Warning message in par(usr):
&quot;argument 1 does not name a graphical parameter&quot;
Warning message in par(usr):
&quot;argument 1 does not name a graphical parameter&quot;
Warning message in par(usr):
&quot;argument 1 does not name a graphical parameter&quot;
</pre></div>
</div>
<img alt="../_images/632cbf9203407b85b268d186ae43b858530788e9da5eb5169e7295ce5d561f85.png" src="../_images/632cbf9203407b85b268d186ae43b858530788e9da5eb5169e7295ce5d561f85.png" />
</div>
</div>
</section>
</section>
<section id="regressione-bivariata">
<h2><span class="section-number">5.2. </span>Regressione bivariata<a class="headerlink" href="#regressione-bivariata" title="Permalink to this heading">#</a></h2>
<p>Il modello statistico della regressione bivariata descrive l’associazione tra il valore atteso di <span class="math notranslate nohighlight">\(Y \mid x_i\)</span> e <span class="math notranslate nohighlight">\(x\)</span> nei termini di una relazione lineare:</p>
<div class="math notranslate nohighlight">
\[
\mathbb{E}(Y \mid x_i) = \alpha + \beta x_i,
\]</div>
<p>dove i valori <span class="math notranslate nohighlight">\(x_i\)</span> sono considerati fissi per disegno. Nel modello “classico”, si assume che le distribuzioni <span class="math notranslate nohighlight">\(Y \mid x_i\)</span> siano Normali con deviazione standard <span class="math notranslate nohighlight">\(\sigma_\varepsilon\)</span>.</p>
<p>Il significato dei coefficienti di regressione è semplice:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\alpha\)</span> è il valore atteso di <span class="math notranslate nohighlight">\(Y\)</span> quando <span class="math notranslate nohighlight">\(X = 0\)</span>;</p></li>
<li><p><span class="math notranslate nohighlight">\(\beta\)</span> è l’incremento atteso nel valore atteso di <span class="math notranslate nohighlight">\(Y\)</span> quando <span class="math notranslate nohighlight">\(X\)</span> aumenta di un’unità.</p></li>
</ul>
<p>Il modello statistico della regressione bivariata è rappresentato nella figura seguente.</p>
<div class="cell tag_remove_input docutils container">
<div class="cell_output docutils container">
<img alt="../_images/6704838f98272e3e7969fcd5d2a0c9716257d7c8b5bcd997b5dfaaa66a6fb61b.png" src="../_images/6704838f98272e3e7969fcd5d2a0c9716257d7c8b5bcd997b5dfaaa66a6fb61b.png" />
</div>
</div>
<p>Per fare un esempio pratico, consideriamo i dati dell’antropologo Sahlins, il quale si è chiesto se esiste un’associazione tra l’ampiezza del clan (<code class="docutils literal notranslate"><span class="pre">consumers</span></code>) e l’area occupata da quel clan (<code class="docutils literal notranslate"><span class="pre">acres</span></code>) in una popolazione di cacciatori-raccoglitori. I dati sono i seguenti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(</span><span class="n">Sahlins</span><span class="p">)</span>
<span class="nf">head</span><span class="p">(</span><span class="n">Sahlins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 6 x 2</caption>
<thead>
	<tr><th></th><th scope=col>consumers</th><th scope=col>acres</th></tr>
	<tr><th></th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td>1.00</td><td>1.71</td></tr>
	<tr><th scope=row>2</th><td>1.08</td><td>1.52</td></tr>
	<tr><th scope=row>3</th><td>1.15</td><td>1.29</td></tr>
	<tr><th scope=row>4</th><td>1.15</td><td>3.09</td></tr>
	<tr><th scope=row>5</th><td>1.20</td><td>2.21</td></tr>
	<tr><th scope=row>6</th><td>1.30</td><td>2.26</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Sahlins</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">consumers</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acres</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">lm</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`geom_smooth()` using formula = &#39;y ~ x&#39;
</pre></div>
</div>
<img alt="../_images/9094c2322d5c2414c99f9ebacb66dddf2c170028cb1f65025fb9e22be45dc6e9.png" src="../_images/9094c2322d5c2414c99f9ebacb66dddf2c170028cb1f65025fb9e22be45dc6e9.png" />
</div>
</div>
<p>Eseguiamo l’analisi statistica con <code class="docutils literal notranslate"><span class="pre">lm()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">acres</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">consumers</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sahlins</span><span class="p">)</span>
<span class="n">fm</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>1.37564454847979</dd><dt>consumers</dt><dd>0.51632006009206</dd></dl>
</div></div>
</div>
<p>Dalla figura notiamo che, se <code class="docutils literal notranslate"><span class="pre">consumers</span></code> aumenta di un’unità (da 1.2 a 2.2), allora la retta di regressione (ovvero, il valore atteso di <span class="math notranslate nohighlight">\(Y\)</span>) aumenta di circa 0.5 punti – esattamente, aumenta di 0.5163 punti, come indicato dalla stima del coefficiente <span class="math notranslate nohighlight">\(\beta\)</span>. L’interpretazione del coefficiente <span class="math notranslate nohighlight">\(\alpha\)</span> è più problematica, perché non ha senso pensare ad un clan di ampiezza 0. Per affrontare questo problema, centriamo il predittore.</p>
<section id="regressori-centrati">
<h3><span class="section-number">5.2.1. </span>Regressori centrati<a class="headerlink" href="#regressori-centrati" title="Permalink to this heading">#</a></h3>
<p>Esprimiamo la variabile <code class="docutils literal notranslate"><span class="pre">consumers</span></code> nei termini degli scarti dalla media:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Sahlins</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sahlins</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="n">xc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">consumers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">consumers</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Svolgiamo nuovamente l’analisi di regressione con il nuovo predittore:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">acres</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">xc</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sahlins</span><span class="p">)</span>
<span class="n">fm1</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>2.162</dd><dt>xc</dt><dd>0.51632006009206</dd></dl>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Sahlins</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xc</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acres</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="n">lm</span><span class="p">,</span><span class="w"> </span><span class="n">se</span><span class="o">=</span><span class="kc">FALSE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>`geom_smooth()` using formula = &#39;y ~ x&#39;
</pre></div>
</div>
<img alt="../_images/be680f11b778337b80c7b077d43871efb4c3acbc8a8f8789346378c524bddeb1.png" src="../_images/be680f11b778337b80c7b077d43871efb4c3acbc8a8f8789346378c524bddeb1.png" />
</div>
</div>
<p>La stima di <span class="math notranslate nohighlight">\(\beta\)</span> è rimasta invariata ma ora possiamo attribuire un significato alla stima di <span class="math notranslate nohighlight">\(\alpha\)</span>: questo coefficiente indica il valore atteso della <span class="math notranslate nohighlight">\(Y\)</span> quando <span class="math notranslate nohighlight">\(X\)</span> assume il suo valore medio.</p>
</section>
<section id="minimi-quadrati">
<h3><span class="section-number">5.2.2. </span>Minimi quadrati<a class="headerlink" href="#minimi-quadrati" title="Permalink to this heading">#</a></h3>
<p>La stima dei coefficienti del modello di regressione può essere effettuata in modi diversi: massima verosimiglianza o metodi bayesiani. Se ci limitiamo qui alla massima verosimiglianza possiamo semplificare il problema assumento che le distribuzioni condizionate <span class="math notranslate nohighlight">\(Y \mid x\)</span> siano Normali. In tali circostanze, la stima dei coefficienti del modello di regressione può essere trovata con il metodo dei minimi quadrati.</p>
<p>In pratica, questo significa trovare i coefficienti <span class="math notranslate nohighlight">\(a\)</span> e <span class="math notranslate nohighlight">\(b\)</span> che minimizzano</p>
<div class="math notranslate nohighlight">
\[
SS_{\text{res}} = \sum(y_i - \hat{y}_i)^2,
\]</div>
<p>con <span class="math notranslate nohighlight">\(\hat{y}_i = a + b x_i\)</span>.</p>
<p>Per fornire un’idea di come questo viene fatto, usiamo una simulazione. Per semplicità, supponiamo di conoscere <span class="math notranslate nohighlight">\(a = 1.3756445\)</span> e di volere stimare <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sahlins</span><span class="o">$</span><span class="n">consumers</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span>
<span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1.3756445</span>

<span class="n">nrep</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1e3</span>
<span class="n">b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">seq</span><span class="p">(</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="n">length.out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nrep</span><span class="p">)</span>

<span class="n">ssres</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rep</span><span class="p">(</span><span class="kc">NA</span><span class="p">,</span><span class="w"> </span><span class="n">nrep</span><span class="p">)</span>
<span class="nf">for </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="m">1</span><span class="o">:</span><span class="n">nrep</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">yhat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span>
<span class="w">  </span><span class="n">ssres</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yhat</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<p>Un grafico di <span class="math notranslate nohighlight">\(SS_{\text{res}}\)</span> in funzione di <span class="math notranslate nohighlight">\(b\)</span> mostra che il valore <span class="math notranslate nohighlight">\(b\)</span> che minimizza <span class="math notranslate nohighlight">\(SS_{\text{res}}\)</span> corrisponde, appunto, a 0.5163.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">tibble</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">ssres</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssres</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/da3e5aca01800e368c647531cba26b01de66f4b93da105e627a3ff25e87e3768.png" src="../_images/da3e5aca01800e368c647531cba26b01de66f4b93da105e627a3ff25e87e3768.png" />
</div>
</div>
<p>Possiamo trovare il minimo della funzione rappresentata nella figura usando <code class="docutils literal notranslate"><span class="pre">optim()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define the function to calculate SSR</span>
<span class="n">ssr_function</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">function</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">yhat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span>
<span class="w">    </span><span class="nf">return</span><span class="p">(</span><span class="nf">sum</span><span class="p">((</span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yhat</span><span class="p">)</span><span class="o">^</span><span class="m">2</span><span class="p">))</span>
<span class="p">}</span>

<span class="c1"># Use optim to find the value of b that minimizes the SSR</span>
<span class="n">result</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">optim</span><span class="p">(</span>
<span class="w">    </span><span class="n">par</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.5</span><span class="p">,</span><span class="w"> </span><span class="c1"># starting value for b</span>
<span class="w">    </span><span class="n">fn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ssr_function</span><span class="p">,</span>
<span class="w">    </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">,</span>
<span class="w">    </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="p">,</span>
<span class="w">    </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">a</span><span class="p">,</span>
<span class="w">    </span><span class="n">method</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;BFGS&quot;</span>
<span class="p">)</span><span class="w"> </span><span class="c1"># optimization method, BFGS is a good default</span>

<span class="c1"># The optimal value of b</span>
<span class="n">optimal_b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">result</span><span class="o">$</span><span class="n">par</span>
<span class="n">optimal_b</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.516320090426755</div></div>
</div>
</section>
<section id="relazione-tra-b-e-r">
<h3><span class="section-number">5.2.3. </span>Relazione tra <span class="math notranslate nohighlight">\(b\)</span> e <span class="math notranslate nohighlight">\(r\)</span><a class="headerlink" href="#relazione-tra-b-e-r" title="Permalink to this heading">#</a></h3>
<p>Un altro modo per interpretare <span class="math notranslate nohighlight">\(b\)</span> è quello di considerare la relazione tra la pendenza della retta di regressione e il coefficiente di correlazione:</p>
<div class="math notranslate nohighlight">
\[
b_X = r_{XY} \frac{S_X}{S_Y}.
\]</div>
<p>L’equazione precedente rende chiaro che, se i dati sono standardizzati, <span class="math notranslate nohighlight">\(b = r\)</span>.</p>
<p>Verifichiamo iniziando a calcolare la correlazione tra <code class="docutils literal notranslate"><span class="pre">acres</span></code> e <code class="docutils literal notranslate"><span class="pre">consumers</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Sahlins</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">acres</span><span class="p">,</span><span class="w"> </span><span class="n">consumers</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">cor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 2 x 2 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>acres</th><th scope=col>consumers</th></tr>
</thead>
<tbody>
	<tr><th scope=row>acres</th><td>1.0000000</td><td>0.3756561</td></tr>
	<tr><th scope=row>consumers</th><td>0.3756561</td><td>1.0000000</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Eseguiamo ora l’analisi di regressione sui dati standardizzati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="nf">scale</span><span class="p">(</span><span class="n">acres</span><span class="p">)</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="nf">scale</span><span class="p">(</span><span class="n">consumers</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sahlins</span><span class="p">)</span>
<span class="n">fm2</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>9.91710589115135e-17</dd><dt>scale(consumers)</dt><dd>0.375656119968214</dd></dl>
</div></div>
</div>
</section>
<section id="attenuazione">
<h3><span class="section-number">5.2.4. </span>Attenuazione<a class="headerlink" href="#attenuazione" title="Permalink to this heading">#</a></h3>
<p>Il fenomeno dell’attenuazione si verifica quando <span class="math notranslate nohighlight">\(X\)</span> viene misurato con una componente di errore. Esaminiamo la seguente simulazione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">1234</span><span class="p">)</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">100</span>
<span class="n">x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span>
<span class="n">y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="nf">tibble</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a400ca81f8ca26f8021a07c5f59772d5650695edab2e95e4ad6eef02e3f57415.png" src="../_images/a400ca81f8ca26f8021a07c5f59772d5650695edab2e95e4ad6eef02e3f57415.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span>
<span class="n">fm3</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">sim_dat</span><span class="p">)</span>
<span class="n">fm</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>1.37564454847979</dd><dt>consumers</dt><dd>0.51632006009206</dd></dl>
</div></div>
</div>
<p>Aggiungendo una componente d’errore su <span class="math notranslate nohighlight">\(X\)</span>, la grandezza del coefficiente <span class="math notranslate nohighlight">\(b\)</span> diminuisce.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sim_dat</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">mutate</span><span class="p">(</span>
<span class="w">    </span><span class="n">x1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">)</span>
<span class="w">  </span><span class="p">)</span>

<span class="n">fm1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">sim_dat</span><span class="p">)</span>
<span class="n">fm1</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>8.38721756937908</dd><dt>x1</dt><dd>0.629592427655327</dd></dl>
</div></div>
</div>
</section>
</section>
<section id="valori-predetti-e-residui">
<h2><span class="section-number">5.3. </span>Valori predetti e residui<a class="headerlink" href="#valori-predetti-e-residui" title="Permalink to this heading">#</a></h2>
<p>Il modello lineare di regressione è caratterizzato dalla scomposizione dei punteggi oservati <span class="math notranslate nohighlight">\(Y\)</span> in una componente deterministica, predetta dal modello, ovvero <span class="math notranslate nohighlight">\(\hat{y}_i = a + b x_i\)</span> e una componente casuale di errore: <span class="math notranslate nohighlight">\(e_i = y_i - \hat{y}_i\)</span>.</p>
<p>Nel caso dei dati di Sahlins, i valori predetti sono i seguenti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">acres</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">consumers</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sahlins</span><span class="p">)</span>
<span class="n">a</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fm</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">1</span><span class="p">]</span>
<span class="n">b</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">fm</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">]</span>
<span class="n">yhat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Sahlins</span><span class="o">$</span><span class="n">consumers</span>
</pre></div>
</div>
</div>
</div>
<p>I residui sono i seguenti:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sahlins</span><span class="o">$</span><span class="n">consumers</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">yhat</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Sahlins</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">consumers</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acres</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># Punti osservati</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat</span><span class="p">),</span><span class="w"> </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;red&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># Punti predetti</span>
<span class="w">    </span><span class="nf">geom_segment</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">xend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">consumers</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">yhat</span><span class="p">,</span><span class="w"> </span><span class="n">yend</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">acres</span><span class="p">),</span><span class="w"> </span>
<span class="w">               </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;black&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="c1"># Segmenti dei residui</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Acres&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Consumers&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Grafico dei residui della regressione&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/1c734bb395292b2414584e3f33f767a94094e7600aa9726c6547db4b0f6554e2.png" src="../_images/1c734bb395292b2414584e3f33f767a94094e7600aa9726c6547db4b0f6554e2.png" />
</div>
</div>
</section>
<section id="coefficiente-di-determinazione">
<h2><span class="section-number">5.4. </span>Coefficiente di determinazione<a class="headerlink" href="#coefficiente-di-determinazione" title="Permalink to this heading">#</a></h2>
<p>Il coefficiente di determinazione misura il quadrato della correlazione tra i valori osservati e i valori predetti: <span class="math notranslate nohighlight">\(r_{y, \hat{y}}^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">cor</span><span class="p">(</span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span><span class="p">,</span><span class="w"> </span><span class="n">yhat</span><span class="p">)</span><span class="o">^</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.141117520469573</div></div>
</div>
<p>ovvero, il rapporto tra la devianza attribuibile alla retta di regressione,  <span class="math notranslate nohighlight">\(\sum_i(\hat{u}_i - \bar{y})^2\)</span>, e la devianza totale, <span class="math notranslate nohighlight">\(\sum_i (y_i - \bar{y})^2\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># devianza della regressione</span>
<span class="n">ssr</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">yhat</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="c1"># devianza totale</span>
<span class="n">sst</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sum</span><span class="p">((</span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">mean</span><span class="p">(</span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span><span class="p">))</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
<span class="c1"># coefficiente di determinazione</span>
<span class="n">ssr</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">sst</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.141117520469573</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">summary</span><span class="p">(</span><span class="n">fm</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = acres ~ consumers, data = Sahlins)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.8763 -0.1873 -0.0211  0.2135  1.1206 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   1.3756     0.4684   2.937  0.00881 **
consumers     0.5163     0.3002   1.720  0.10263   
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4543 on 18 degrees of freedom
Multiple R-squared:  0.1411,	Adjusted R-squared:  0.0934 
F-statistic: 2.957 on 1 and 18 DF,  p-value: 0.1026
</pre></div>
</div>
</div>
</div>
<section id="errore-standard-della-regressione">
<h3><span class="section-number">5.4.1. </span>Errore standard della regressione<a class="headerlink" href="#errore-standard-della-regressione" title="Permalink to this heading">#</a></h3>
<p>L’errore standard della regressione è una stima della dispersione di <span class="math notranslate nohighlight">\(y \mid x_i\)</span> nella popolazione.  Non è altro che la deviazione standard dei residui</p>
<div class="math notranslate nohighlight">
\[
e = y_i - \hat{y}_i
\]</div>
<p>che, al denominatore, riporta <span class="math notranslate nohighlight">\(n-2\)</span>. La ragione è che, per calcolare <span class="math notranslate nohighlight">\(\hat{y}\)</span>, vengono “perduti” due gradi di libertà – il calcolo di <span class="math notranslate nohighlight">\(\hat{y}\)</span> è basato sulla stima di due coefficienti: <span class="math notranslate nohighlight">\(a\)</span> e <span class="math notranslate nohighlight">\(b\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">e</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">yhat</span>
<span class="p">(</span><span class="nf">sum</span><span class="p">(</span><span class="n">e</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="nf">length</span><span class="p">(</span><span class="n">Sahlins</span><span class="o">$</span><span class="n">acres</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">sqrt</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.454317872037872</div></div>
</div>
<p>Il valore trovato corrisponde a quello riportato nell’output di <code class="docutils literal notranslate"><span class="pre">lm()</span></code>.</p>
</section>
</section>
<section id="regressione-multipla">
<h2><span class="section-number">5.5. </span>Regressione multipla<a class="headerlink" href="#regressione-multipla" title="Permalink to this heading">#</a></h2>
<p>Nella regressione multipla vengono utilizzati <span class="math notranslate nohighlight">\(k &gt; 1\)</span> predittori:</p>
<div class="math notranslate nohighlight">
\[
y_i = \alpha + \sum_{j=1}^k \beta_j x_i + \varepsilon_i.
\]</div>
<p>L’interpretazione geometrica è simile a quella del modello bivariato. Nel caso di due predittori, il valore atteso della <span class="math notranslate nohighlight">\(y\)</span> può essere rappresentato da un piano; nel caso di <span class="math notranslate nohighlight">\(k &gt; 2\)</span> predittori, da un iper-piano. Nel caso di <span class="math notranslate nohighlight">\(k=2\)</span>, tale piano è posto in uno spazio di dimensioni <span class="math notranslate nohighlight">\(x_1\)</span>, <span class="math notranslate nohighlight">\(x_2\)</span> (che possiamo immaginare definire un piano orizzontale) e <span class="math notranslate nohighlight">\(y\)</span> (ortogonale a tale piano). La superficie piana che rappresenta <span class="math notranslate nohighlight">\(\mathbb{E}(y)\)</span> è inclinata in maniera tale che l’angolo tra il piano e l’asse <span class="math notranslate nohighlight">\(x_1\)</span> corrisponde a <span class="math notranslate nohighlight">\(\beta_1\)</span> e l’angolo tra il piano e l’asse <span class="math notranslate nohighlight">\(x_2\)</span> corrisponde a <span class="math notranslate nohighlight">\(\beta_2\)</span>.</p>
<section id="significato-dei-coefficienti-parziali-di-regressione">
<h3><span class="section-number">5.5.1. </span>Significato dei coefficienti parziali di regressione<a class="headerlink" href="#significato-dei-coefficienti-parziali-di-regressione" title="Permalink to this heading">#</a></h3>
<p>Ai coefficienti parziali del modello di regressione multipla possiamo assegnare la seguente interpretazione:</p>
<p><em>Il coefficiente parziale di regressione <span class="math notranslate nohighlight">\(\beta_j\)</span> rappresenta l’incremento atteso della <span class="math notranslate nohighlight">\(y\)</span> se <span class="math notranslate nohighlight">\(x_j\)</span> viene incrementata di un’unità, tenendo costante il valore delle altre variabili indipendenti.</em></p>
<p>Un modo per interpretare la locuzione “al netto dell’effetto delle altre variabili indipendenti” è quello di esaminare la relazione tra la <span class="math notranslate nohighlight">\(y\)</span> parzializzata e la <span class="math notranslate nohighlight">\(x_j\)</span> parzializzata. In questo contesto, parzializzare significa decomporre una variabile di due componenti: una componente che è linearmente predicibile da una o più altre variabili e una componente che è linearmente incorrelata con tali varibili “terze”.</p>
<p>Se eseguiamo questa “depurazione” dell’effetto delle variabili “terze” sia sulla <span class="math notranslate nohighlight">\(y\)</span> sia su <span class="math notranslate nohighlight">\(x_j\)</span>, possiamo poi esaminare la relazione bivariata che intercorre tra la componente della <span class="math notranslate nohighlight">\(y\)</span> linearmente indipendente dalle variabili “terze” e la componente della <span class="math notranslate nohighlight">\(x_j\)</span> linearmente indipendente dalle variabili “terze”. Il coefficiente di regressione bivariato così ottenuto sarà identico al coefficiente parziale di regressione nel modello di regressione multipla. Questa procedura ci consente di assegnare un’interpretazione “intuitiva” al coefficiente parziale di regressione <span class="math notranslate nohighlight">\(\beta_j\)</span>.</p>
<p>Esaminiamo un caso concreto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">d</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">rio</span><span class="o">::</span><span class="nf">import</span><span class="p">(</span><span class="s">&quot;data/kidiq.dta&quot;</span><span class="p">)</span>
<span class="nf">glimpse</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Rows: 434
Columns: 5
$ kid_score &lt;dbl&gt; 65, 98, 85, 83, 115, 98, 69, 106, 102, 95, 91, 58, 84, 78, 1~
$ mom_hs    &lt;dbl&gt; 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, ~
$ mom_iq    &lt;dbl&gt; 121.11753, 89.36188, 115.44316, 99.44964, 92.74571, 107.9018~
$ mom_work  &lt;dbl&gt; 4, 4, 4, 3, 4, 1, 4, 3, 1, 1, 1, 4, 4, 4, 2, 1, 3, 3, 4, 3, ~
$ mom_age   &lt;dbl&gt; 27, 25, 27, 25, 27, 18, 20, 23, 24, 19, 23, 24, 27, 26, 24, ~
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span>
<span class="w">  </span><span class="n">kid_score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">mom_iq</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_work</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_hs</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span>
<span class="p">)</span>
<span class="n">fm</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>20.8226117032724</dd><dt>mom_iq</dt><dd>0.562081421559238</dd><dt>mom_work</dt><dd>0.1337287092913</dd><dt>mom_age</dt><dd>0.219859856510774</dd><dt>mom_hs</dt><dd>5.56117805423643</dd></dl>
</div></div>
</div>
<p>Eseguiamo la parzializzazione della <span class="math notranslate nohighlight">\(y\)</span> in funzione delle variabili <code class="docutils literal notranslate"><span class="pre">mom_work</span></code>, <code class="docutils literal notranslate"><span class="pre">mom_age</span></code> e <code class="docutils literal notranslate"><span class="pre">mom_hs</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm_y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">kid_score</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">mom_work</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_hs</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lo stesso per <code class="docutils literal notranslate"><span class="pre">mom_iq</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm_x</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">mom_iq</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">mom_work</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_age</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">mom_hs</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo ora la regressione bivariata tra le componenti parzializzate della <span class="math notranslate nohighlight">\(y\)</span> e di <span class="math notranslate nohighlight">\(x_j\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">fm_y</span><span class="o">$</span><span class="n">residuals</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">fm_x</span><span class="o">$</span><span class="n">residuals</span><span class="p">)</span>
<span class="n">mod</span><span class="o">$</span><span class="n">coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>-9.32814346191295e-16</dd><dt>fm_x$residuals</dt><dd>0.562081421559238</dd></dl>
</div></div>
</div>
<p>Si vede come il coefficiente di regressione bivariato risulta identico al corrispondente coefficiente parziale di regressione.</p>
</section>
<section id="relazioni-causali">
<h3><span class="section-number">5.5.2. </span>Relazioni causali<a class="headerlink" href="#relazioni-causali" title="Permalink to this heading">#</a></h3>
<p>Un altro modo per interpretare i coefficienti parziali di regressione è nell’ambito dei quelli che vengono chiamati i <em>path diagrams</em>. I diagrammi di percorso, che tratteremo in seguito e qui solo anticipiamo, descrivono le relazioni “causali” tra variabili: le variabili a monte del diagramma di percorso rappresentano le “cause” esogene e le variabili a valle indicano gli effetti, ovvero le variabili endogene. I coefficienti di percorso vengono rappresentati graficamente come frecce orientate e corrispondono all’effetto <em>diretto</em> sulla variabile verso cui punta la freccia della variabile a monte della freccia. In tale rappresentazione grafica, i coefficienti di percorso non sono altro che i coefficienti parziali di regressione del modello di regressione multipla. In questo contesto, indicano l’effetto <em>diretto</em> atteso sulla variabile endogena in conseguenza dell’incremento di un’unità della variabile esogena, <em>lasciano immutate tutte le altre relazioni strutturali</em> del modello.</p>
<p>Usiamo la funzione <code class="docutils literal notranslate"><span class="pre">sem()</span></code> del pacchetto <code class="docutils literal notranslate"><span class="pre">lavaan</span></code> per definire il modello rappresentato nel successivo diagramma di percorso:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;</span>
<span class="s">  kid_score ~ mom_hs + mom_iq + mom_work + mom_age</span>
<span class="s">&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Adattiamo il modello ai dati</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">sem</span><span class="p">(</span><span class="n">model</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">d</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il diagramma di percorso si ottiene con le seguenti istruzioni:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">semPaths</span><span class="p">(</span>
<span class="w">  </span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;est&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">posCol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;black&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">edge.label.cex</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0.9</span><span class="p">,</span>
<span class="w">  </span><span class="n">sizeMan</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">what</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;path&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/a0ecf96cdd01ef14ca1a2278c410a26ed9f550c75534f0e920c3802188dfc169.png" src="../_images/a0ecf96cdd01ef14ca1a2278c410a26ed9f550c75534f0e920c3802188dfc169.png" />
</div>
</div>
<p>Come indicato nel diagramma, l’effetto diretto di <code class="docutils literal notranslate"><span class="pre">mom_iq</span></code> su <code class="docutils literal notranslate"><span class="pre">kid_score</span></code> è identico al corrispondente coefficiente parziale di regressione.</p>
<p>Il problema di capire se sia appropriato utilizzare un modello di regressione per descrivere le relazioni causali tra le variabili è affrontato nel prossimo paragrafo in riferimento all’errore di specificazione.</p>
</section>
<section id="errore-di-specificazione">
<h3><span class="section-number">5.5.3. </span>Errore di specificazione<a class="headerlink" href="#errore-di-specificazione" title="Permalink to this heading">#</a></h3>
<p>Spiritosamente chiamato “heartbreak of L.O.V.E.” [Left-Out Variable Error; &#64;mauro1990understanding], l’errore di specificazione è una caratteristica fondamentale dei modelli di regressione che deve sempre essere tenuta a mente quando interpretiamo i risultati di questa tecnica di analisi statistica.</p>
<p>L’errore di specificazione si verifica quando escludiamo dal modello di regressione una variabile che ha due caratteristiche:</p>
<ul class="simple">
<li><p>è associata con altre variabili inserite nel modello,</p></li>
<li><p>ha un effetto diretto sulla <span class="math notranslate nohighlight">\(y\)</span>.</p></li>
</ul>
<p>Come conseguenza dell’errore di specificazione, l’intensità e il segno dei coefficienti parziali di regressione risultano sistematicamente distorti.</p>
<p>Consideriamo un esempio con dati simulati nei quali immaginiamo che la prestazione sia positivamente associata alla motivazione e negativamente associata all’ansia. Immaginiamo inoltre che vi sia una correlazione positiva tra ansia a motivazione. Ci chiediamo cosa succede al coefficiente parziale della variabile “motivazione” se la variabile “ansia” viene esclusa dal modello di regressione.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">400</span>
<span class="n">anxiety</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">1.5</span><span class="p">)</span>
<span class="n">motivation</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">4.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">anxiety</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3.5</span><span class="p">)</span>
<span class="nf">cor</span><span class="p">(</span><span class="n">anxiety</span><span class="p">,</span><span class="w"> </span><span class="n">motivation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.861770572096147</div></div>
</div>
<p>Creiamo la variabile <code class="docutils literal notranslate"><span class="pre">performance</span></code> come una combinazione lineare di motivazione e ansia nella quale la motivazione ha un effetto piccolo, ma positivo, sulla prestazione, e l’ansia ha un grande effetto negativo sulla prestazione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">performance</span><span class="w"> </span><span class="o">&lt;-</span><span class="w">  </span><span class="m">0.5</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">motivation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">5.0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">anxiety</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Salviamo i dati in un data frame:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sim_dat2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span><span class="n">performance</span><span class="p">,</span><span class="w"> </span><span class="n">motivation</span><span class="p">,</span><span class="w"> </span><span class="n">anxiety</span><span class="p">)</span>
<span class="n">sim_dat2</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 x 3</caption>
<thead>
	<tr><th scope=col>performance</th><th scope=col>motivation</th><th scope=col>anxiety</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>-26.53773</td><td>36.37970</td><td> 9.159287</td></tr>
	<tr><td>-32.98337</td><td>34.52866</td><td> 9.654734</td></tr>
	<tr><td>-35.55939</td><td>47.13063</td><td>12.338062</td></tr>
	<tr><td>-26.90895</td><td>40.32210</td><td>10.105763</td></tr>
	<tr><td>-28.57925</td><td>43.12316</td><td>10.193932</td></tr>
	<tr><td>-40.17393</td><td>44.51348</td><td>12.572597</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Eseguiamo l’analisi di regressione specificando il modello in maniera corretta, ovvero usando come predittori l’ansia e la depressione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">performance</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">motivation</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">anxiety</span><span class="p">,</span><span class="w"> </span><span class="n">sim_dat2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Le stime dei coefficienti parziali di regressione recuperano correttamente l’intensità e il segno dei coefficienti utilizzati nel modello generatore dei dati:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">coef</span><span class="p">(</span><span class="n">fm1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><style>
.dl-inline {width: auto; margin:0; padding: 0}
.dl-inline>dt, .dl-inline>dd {float: none; width: auto; display: inline-block}
.dl-inline>dt::after {content: ":\0020"; padding-right: .5ex}
.dl-inline>dt:not(:first-of-type) {padding-left: .5ex}
</style><dl class=dl-inline><dt>(Intercept)</dt><dd>1.37119646932026</dd><dt>motivation</dt><dd>0.49538855343619</dd><dt>anxiety</dt><dd>-5.10521755591757</dd></dl>
</div></div>
</div>
<p>Eseguiamo ora l’analisi di regressione ignorando il predittore <code class="docutils literal notranslate"><span class="pre">anxiety</span></code> che ha le due caratteristiche di essere associato a <code class="docutils literal notranslate"><span class="pre">motivation</span></code> e di avere un effetto diretto sulla prestazione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">performance</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">motivation</span><span class="p">,</span><span class="w"> </span><span class="n">sim_dat2</span><span class="p">)</span>
<span class="nf">summary</span><span class="p">(</span><span class="n">fm2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = performance ~ motivation, data = sim_dat2)

Residuals:
    Min      1Q  Median      3Q     Max 
-13.501  -3.409   0.005   3.311  12.616 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -12.39720    1.44591  -8.574 2.24e-16 ***
motivation   -0.43717    0.03553 -12.305  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 4.866 on 398 degrees of freedom
Multiple R-squared:  0.2756,	Adjusted R-squared:  0.2738 
F-statistic: 151.4 on 1 and 398 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<p>Si noti che il risultato prodotto dal modello di regressione è totalmente sbagliato: come conseguenza dell’errore di specificazione, il segno del coefficiente parziale di regressione della variabile “motivazione” è negativo, anche se nel modello generatore dei dati tale coefficiente aveva il segno opposto.</p>
<p>Quindi, se interpretassimo il coefficiente parziale ottenuto in termini casuali, saremmo portati a concludere che la motivazione fa diminuire la prestazione. Ma in realtà è vero l’opposto.</p>
<p>È facile vedere perché si verifica l’errore di specificazione. Supponiamo che il vero modello sia</p>
<div class="math notranslate nohighlight">
\[
y = \alpha + \beta_1 X_1 + \beta_2 X_2 + \varepsilon
\]</div>
<p>il quale verrebbe stimato da</p>
<div class="math notranslate nohighlight">
\[
y = a + b_1 X_1 + b_2 X_2 + e.
\]</div>
<p>Supponiamo però che il ricercatore creda invece che</p>
<div class="math notranslate nohighlight">
\[
y = \alpha^\prime + \beta_1^\prime X_1 + \varepsilon^\prime
\]</div>
<p>e quindi stimi</p>
<div class="math notranslate nohighlight">
\[
y = a^\prime + b_1^\prime X_1 + e^\prime
\]</div>
<p>omettendo <span class="math notranslate nohighlight">\(X_2\)</span> dal modello.</p>
<p>Per capire che relazione intercorre tra <span class="math notranslate nohighlight">\(b_1^\prime\)</span> e <span class="math notranslate nohighlight">\(b_1\)</span>, iniziamo a scrivere la formula per <span class="math notranslate nohighlight">\(b_1^\prime\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\begin{equation}
b_1^\prime = \frac{Cov(X_1, Y)}{Var(X_1)}.
\end{equation}
\]</div>
<p>Sviluppando, otteniamo</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{aligned}
b_1^\prime &amp;= \frac{Cov(X_1, a + b_1 X_1 + b_2 X_2 + e)}{Var(X_1)}\notag\\
&amp;= \frac{Cov(X_1, a)+b_1 Cov(X_1, X_1) + b_2 Cov(X_1, X_2) + Cov(X_1, e)}{Var(X_1)}\notag\\
&amp;= \frac{0 + b_1 Var(X_1) + b_2 Cov(X_1, X_2) + 0}{Var(X_1)}\notag\\
&amp;= b_1 + b_2 \frac{Cov(X_1, X_2)}{Var(X_1)}.
\end{aligned}
\end{equation}
\end{split}\]</div>
<p>Quindi, se erroneamente omettiamo <span class="math notranslate nohighlight">\(X_2\)</span> dal modello, abbiamo che</p>
<div class="math notranslate nohighlight" id="equation-eq-specific-err">
<span class="eqno">(5.1)<a class="headerlink" href="#equation-eq-specific-err" title="Permalink to this equation">#</a></span>\[
\begin{equation}
\mathbb{E}(b_1^\prime) = \beta_1 + \beta_2 \frac{\sigma_{12}}{\sigma_1^2}.
\end{equation}
\]</div>
<p>Verifichiamo tale conclusione per i dati dell’esempio che stiamo discutendo. Nel caso presente, <span class="math notranslate nohighlight">\(X_1\)</span> è <code class="docutils literal notranslate"><span class="pre">motivation</span></code> e <span class="math notranslate nohighlight">\(X_2\)</span> è <code class="docutils literal notranslate"><span class="pre">anxiety</span></code>. Applicando l’eq. <a class="reference internal" href="#equation-eq-specific-err">(5.1)</a> otteniamo lo stesso valore per il coefficiente di regressione associato a <code class="docutils literal notranslate"><span class="pre">motivation</span></code> che era stato ottenuto adattando ai dati il modello <code class="docutils literal notranslate"><span class="pre">performance</span> <span class="pre">~</span> <span class="pre">motivation</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm1</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w">  </span><span class="n">fm1</span><span class="o">$</span><span class="n">coef</span><span class="p">[</span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span>
<span class="w">  </span><span class="nf">cov</span><span class="p">(</span><span class="n">sim_dat2</span><span class="o">$</span><span class="n">motivation</span><span class="p">,</span><span class="w"> </span><span class="n">sim_dat2</span><span class="o">$</span><span class="n">anxiety</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>
<span class="w">  </span><span class="nf">var</span><span class="p">(</span><span class="n">sim_dat2</span><span class="o">$</span><span class="n">motivation</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><strong>motivation:</strong> -0.437167456259783</div></div>
</div>
<p>Possiamo dunque concludere che <span class="math notranslate nohighlight">\(b_1^\prime\)</span> è uno stimatore distorto di <span class="math notranslate nohighlight">\(\beta_1\)</span>. Si noti che questa distorsione non scompare all’aumentare della numerosità campionaria, il che (in termini statistici) significa che un tale stimatore è <em>inconsistente</em>. Quello che succede in pratica è che alla variabile <span class="math notranslate nohighlight">\(X_1\)</span> vengono attribuiti gli effetti delle variabili che sono state omesse dal modello. Si noti che una tale distorsione sistematica di <span class="math notranslate nohighlight">\(b_1^\prime\)</span> può essere evitata solo se si verificano due condizioni:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\beta_2 = 0\)</span>. Questo è ovvio, dato che, se <span class="math notranslate nohighlight">\(\beta_2 = 0\)</span>, ciò significa che il modello non è specificato in modo errato, cioè <span class="math notranslate nohighlight">\(X_2\)</span> non appartiene al modello perché non ha un effetto diretto sulla <span class="math notranslate nohighlight">\(Y\)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\(\sigma_{12} = 0\)</span>. Cioè, se <span class="math notranslate nohighlight">\(X_1\)</span> e <span class="math notranslate nohighlight">\(X_2\)</span> sono incorrelate, allora l’omissione di una delle due variabili non comporta stime distorte dell’effetto dell’altra.</p></li>
</ul>
</section>
<section id="soppressione">
<h3><span class="section-number">5.5.4. </span>Soppressione<a class="headerlink" href="#soppressione" title="Permalink to this heading">#</a></h3>
<p>Le conseguenze dell’errore di specificazione sono chiamate “soppressione” (<em>suppression</em>). In generale, si ha soppressione quando (1) il valore assoluto del peso beta di un predittore è maggiore di quello della sua correlazione bivariata con il criterio o (2) i due hanno segni opposti.</p>
<ul class="simple">
<li><p>L’esempio descritto sopra è un caso di <em>soppressione negativa</em>, dove il predittore ha correlazioni bivariate positive con il criterio, ma si riceve un peso beta negativo nell’analisi di regressione multipla.</p></li>
<li><p>Un secondo tipo di soppressione è la <em>soppressione classica</em>, in cui un predittore non è correlato al criterio ma riceve un peso beta diverso da zero.</p></li>
<li><p>C’è anche la <em>soppressione reciproca</em> che può verificarsi quando due variabili sono correlate positivamente con il criterio ma negativamente tra loro.</p></li>
</ul>
</section>
<section id="stepwise-regression">
<h3><span class="section-number">5.5.5. </span>Stepwise regression<a class="headerlink" href="#stepwise-regression" title="Permalink to this heading">#</a></h3>
<p>La sezione 3.5.5 sulla regressione stepwise tratta di come i predittori (variabili indipendenti) dovrebbero essere scelti per un modello di regressione. Ecco una riscrittura più chiara del testo:</p>
</section>
<section id="regressione-stepwise">
<h3><span class="section-number">5.5.6. </span>Regressione Stepwise<a class="headerlink" href="#regressione-stepwise" title="Permalink to this heading">#</a></h3>
<p>Nel contesto della regressione, è importante comprendere che i predittori non dovrebbero essere selezionati basandosi unicamente sulle loro correlazioni bivariate con la variabile dipendente (il criterio). Queste correlazioni, note come associazioni di “ordine zero”, non tengono conto dell’influenza degli altri predittori. Di conseguenza, i valori delle correlazioni bivariate possono risultare fuorvianti quando si considerano i coefficienti di regressione parziale per le stesse variabili.</p>
<p>La significatività statistica delle correlazioni bivariate con la variabile dipendente non è un criterio affidabile per la selezione dei predittori. Questo perché tali correlazioni non considerano gli effetti complessivi degli altri predittori nel modello.</p>
<p>Le procedure di selezione automatica dei predittori, come quelle impiegate nelle regressioni stepwise, possono essere seducenti per la loro facilità d’uso. Tuttavia, queste procedure sono rischiose. Anche piccole non-linearità o effetti indiretti tra i predittori, che potrebbero non essere immediatamente evidenti, possono distorcere in modo significativo i coefficienti di regressione parziale.</p>
<p>Invece di affidarsi a metodi automatici, è preferibile selezionare un numero limitato di predittori basandosi su considerazioni teoriche o sui risultati di ricerche precedenti. Questo approccio più ponderato aiuta a evitare le distorsioni che possono emergere dall’uso di procedure di selezione automatica.</p>
<p>Una volta che sono stati selezionati, i predittori possono essere inseriti nell’equazione di regressione in due modi diversi:</p>
<ul class="simple">
<li><p>tutti i predittori possono essere inseriti nel modello contemporaneamente;</p></li>
<li><p>i predittori possono essere inseriti nel modello sequenzialmente, mediante una serie di passaggi.</p></li>
</ul>
<p>L’ordine di ingresso può essere determinato in base a standard: teorici (razionali) o empirici (statistici). Lo standard razionale corrisponde alla <em>regressione gerarchica</em>, in cui si comunica al computer un ordine fisso per inserire i predittori. Ad esempio, a volte le variabili demografiche vengono inserite nel primo passaggio, quindi nel secondo passaggio viene inserita una variabile psicologica di interesse. Questo ordine non solo controlla le variabili demografiche ma permette anche di valutare il potere predittivo della variabile psicologica, al di là di quello delle semplici variabili demografiche. Quest’ultimo può essere stimato come l’aumento della correlazione multipla al quadrato, o <span class="math notranslate nohighlight">\(\Delta R^2\)</span>, da quella della fase 1 con solo predittori demografici a quella della fase 2 con tutti i predittori nell’equazione di regressione.</p>
<p>Un esempio di standard statistico è la regressione <em>stepwise</em>, in cui il computer seleziona l’inserimento dei predittori in base esclusivamente alla significatività statistica; cioè, viene chiesto: quale predittore, se inserito nell’equazione, avrebbe il valore_<span class="math notranslate nohighlight">\(p\)</span> più piccolo per il test del suo coefficiente di regressione parziale? Dopo la selezione, i predittori in una fase successiva possono essere rimossi dall’equazione di regressione in base ai loro valori-<span class="math notranslate nohighlight">\(p\)</span> (ad esempio, se <span class="math notranslate nohighlight">\(p \geq\)</span> .05). Il processo stepwise si interrompe quando, aggiungendo più predittori, <span class="math notranslate nohighlight">\(\Delta R^2\)</span> non migliora. Varianti della regressione stepwise includono <em>forward inclusion</em>, in cui i predittori selezionati non vengono successivamente rimossi dal modello, e <em>backward elimination</em>, che inizia con tutti i predittori nel modello per poi rimuoverne alcuni in passi successivi. Per le ragioni descritte nel paragrafo sull’errore di specificazione, i metodi basati sulle procedure di stepwise regression non dovrebbero mai essere usati. Infatti, i problemi relativi a tale procedura sono così gravi che varie riviste non accettano studi che fanno uso di una tale tecnica statistica. I risultati ottenuti con tali metodi, infatti, sono quasi certamente non replicabili in campioni diversi.</p>
<p>Una considerazione finale riguarda l’idea di rimuovere i predittori “non significativi” dal modello di regressione. Questa è una cattiva idea. Il ricercatore non deve sentirsi in dovere di trascurare quei predittore che non risultano “statisticamente significativi”. In campioni piccoli, la potenza dei test di significatività è  bassa e la rimozione di un predittore non significativo può alterare sostanzialmente la soluzione. Se c’è una buona ragione per includere un predittore, allora è meglio lasciarlo nel modello, fino a prova contraria. In termini generali, qualsiasi considerazione basata sulla “significatività statistia” è fuorviante.</p>
</section>
</section>
<section id="proprieta-degli-stimatori-dei-minimi-quadrati">
<h2><span class="section-number">5.6. </span>Proprietà degli stimatori dei minimi quadrati<a class="headerlink" href="#proprieta-degli-stimatori-dei-minimi-quadrati" title="Permalink to this heading">#</a></h2>
<p>Consideriamo ora il problema dell’inferenza statistica frequentista nel caso più semplice, quello della regressione bivariata. Il caso generale della regressione multipla segue lo stesso approccio, anche se le formule sono più complesse in quanto vengono formulate nei termini dell’albebra matriciale.</p>
<p>Per il caso bivariato, si può dire che il coefficiente dei minimi quadrati <span class="math notranslate nohighlight">\(b\)</span> è una combinazione lineare delle osservazioni <span class="math notranslate nohighlight">\(y_i\)</span>. Tale proprietà è importante perché consente di derivare la distribuzione di <span class="math notranslate nohighlight">\(b\)</span> dalla distribuzione delle <span class="math notranslate nohighlight">\(y_i\)</span>.
Può essere dimostrato che la formula per il calcolo di <span class="math notranslate nohighlight">\(b\)</span> si può scrivere nel modo seguente:</p>
<div class="math notranslate nohighlight">
\[
\begin{align}
b &amp;= \sum_i \left[\frac{x_i-\bar{x}}{\sum_j(x_j-\bar{x})^2}\right]y_i = \textstyle\sum m_i y_i,
\end{align}
\]</div>
<p>dove <span class="math notranslate nohighlight">\(m_i \triangleq (x_i-\bar{x}) / \sum (x_j-\bar{x})^2\)</span> è il peso associato a ciascun valore <span class="math notranslate nohighlight">\(y_i\)</span>. Dato che i valori <span class="math notranslate nohighlight">\(x_i\)</span> sono fissi e <span class="math notranslate nohighlight">\(m_i\)</span> dipende solo da <span class="math notranslate nohighlight">\(x_i\)</span>, anche i pesi <span class="math notranslate nohighlight">\(m_i\)</span> sono fissi.</p>
<p>Il valore atteso di <span class="math notranslate nohighlight">\(b\)</span> è uguale a</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
E(b) &amp;= \textstyle\sum m_i E(y_i)\notag\\ 
&amp;= \textstyle\sum m_i (\alpha + \beta x_i)\notag\\ 
&amp;= \textstyle\alpha\sum m_i + \beta \sum m_i x_i\notag\\
&amp;= \frac{\alpha \sum(x_i-\bar{x})}{\sum(x_i-\bar{x})^2} + \beta \frac{\sum(x_i-\bar{x})x_i}{\sum(x_i-\bar{x})^2}\notag\\
&amp;= 0 + \beta \frac{\sum x_i^2 -\bar{x}\sum x_i}{\sum(x_i-\bar{x})^2}\notag\\ 
&amp;= \beta \frac{\sum x_i^2 - n\bar{x}^2}{\sum(x_i-\bar{x})^2}\notag\\ 
&amp;= \beta.
\end{align}
\end{split}\]</div>
<p>Il coefficiente dei minimi quadrati <span class="math notranslate nohighlight">\(b\)</span> è dunque uno stimatore corretto di <span class="math notranslate nohighlight">\(\beta\)</span>. In maniera equivalente si può dimostrare che <span class="math notranslate nohighlight">\(E(a) = \alpha\)</span>.</p>
<p>Sotto le ipotesi di omoschedasticità <span class="math notranslate nohighlight">\(\big[ var(y_i) = var(\varepsilon_i)=\sigma^2_{\varepsilon}\big]\)</span> e indipendenza, la varianza di <span class="math notranslate nohighlight">\(b\)</span> è</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
var(b) &amp;= \textstyle var\big(\sum m_i y_i\big)\notag\\
&amp;= \textstyle\mathop{\sum m_i^2} var(y_i)\notag\\ 
&amp;= \textstyle\mathop{\sum m_i^2} \sigma^2_{\varepsilon}\notag\\
&amp;= \frac{\mathop{\sigma^2_{\varepsilon}} \textstyle\sum(x_i-\bar{x})^2}{\big[\textstyle\sum(x_i-\bar{x})^2\big]^2}\notag\\
&amp;= \frac{\sigma^2_{\varepsilon}}{\sum(x_i-\bar{x})^2}.
\end{align}
\end{split}\]</div>
<p>In maniera simile si dimostra che la varianza di <span class="math notranslate nohighlight">\(a\)</span> è</p>
<div class="math notranslate nohighlight">
\[
var(a)= \frac{\sigma^2_{\varepsilon} \textstyle\sum x_i^2}{n \textstyle\sum (x_i-\bar{x})^2}.
\]</div>
<p>Dato che sia <span class="math notranslate nohighlight">\(a\)</span> che <span class="math notranslate nohighlight">\(b\)</span> sono funzioni lineari di <span class="math notranslate nohighlight">\(y_i\)</span>, se i valori <span class="math notranslate nohighlight">\(y_i\)</span> seguono la distribuzione gaussiana, allora anche  <span class="math notranslate nohighlight">\(a\)</span> e <span class="math notranslate nohighlight">\(b\)</span> saranno distribuiti secondo una distribuzione normale. In conclusione,</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
b &amp;\sim \mathcal{N}\bigg(\beta,  \frac{\sigma^2_{\varepsilon}}{\sum(x_i-\bar{x})^2}\bigg),\\
a &amp;\sim \mathcal{N}\bigg(\alpha, \frac{\sigma^2_{\varepsilon}\textstyle\sum x_i^2}{n \textstyle\sum (x_i-\bar{x})^2} \bigg).
\end{align}
\end{split}\]</div>
<section id="ipotesi-statistiche-e-statistica-test">
<h3><span class="section-number">5.6.1. </span>Ipotesi statistiche e statistica test<a class="headerlink" href="#ipotesi-statistiche-e-statistica-test" title="Permalink to this heading">#</a></h3>
<p>Una volta definite le proprietà delle distribuzioni degli stimatori dei minimi quadrati è possibile procedere con l’inferenza sui parametri del modello di regressione.
L’inferenza statistica si articola nella formulazione degli intervalli di confidenza per i parametri di interesse e nei test di significatività statistica.</p>
<p>Un’ipotesi che viene frequentemente sottoposta a verifica è quella di significatività, cioè l’ipotesi che alla variabile esplicativa sia associato un coefficiente nullo.
In tal caso, l’ipotesi nulla è</p>
<div class="math notranslate nohighlight">
\[H_0:\beta=0\]</div>
<p>e l’ipotesi alternativa è</p>
<div class="math notranslate nohighlight">
\[H_1:\beta \neq 0.\]</div>
<p>Sotto l’ipotesi nulla <span class="math notranslate nohighlight">\(H_0: \beta = 0\)</span> la statistica</p>
<div class="math notranslate nohighlight">
\[
 t_{\hat{\beta}} = \frac{\hat{\beta}}{s_{\hat{\beta}}}
\]</div>
<p>si distribuisce come una variabile aleatoria <span class="math notranslate nohighlight">\(t\)</span> di Student con <span class="math notranslate nohighlight">\(n-2\)</span> gradi di libert{`a}.</p>
<p>Di fronte al problema di decidere se il valore stimato <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> sia sufficientemente “distante” da zero, in modo da respingere l’ipotesi nulla che il vero valore <span class="math notranslate nohighlight">\(\beta\)</span> sia nullo, non è sufficiente basarsi soltanto sul valore numerico assunto da <span class="math notranslate nohighlight">\(\hat{\beta}\)</span>, ma occorre tener conto della variabilità campionaria.
La statistica ottenuta dividendo <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> per la stima del suo errore standard, <span class="math notranslate nohighlight">\(s_{\hat{\beta}}\)</span>, ci permette di utilizzare la distribuzione <span class="math notranslate nohighlight">\(t\)</span> di  Student come metrica per stabilire se la stima trovata si debba considerare “diversa” da quanto ipotizzato sotto <span class="math notranslate nohighlight">\(H_0\)</span>.</p>
<p>L’ipotesi nulla viene rifiutata quando il valore assoluto del rapporto è esterno alla regione di accettazione, i cui limiti sono definiti dai valori critici della distribuzione <span class="math notranslate nohighlight">\(t\)</span> di Student con <span class="math notranslate nohighlight">\(n - 2\)</span> gradi di libertà per il livello di significatività <span class="math notranslate nohighlight">\(\alpha\)</span> prescelto.
Se l’ipotesi nulla viene rifiutata si dice che il coefficiente <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> è \enquote{statisticamente significativo} ammettendo così la possibilità di descrivere con un modello lineare la relazione esistente tra le  variabili <span class="math notranslate nohighlight">\(X\)</span> e <span class="math notranslate nohighlight">\(Y\)</span>.
Quando non si può rifiutare l’ipotesi nulla nel modello di regressione, si conclude che il coefficiente angolare della retta non risulta significativamente diverso da zero, individuando  così nella popolazione una retta parallela all’asse delle</p>
</section>
<section id="riportare-i-risultati">
<h3><span class="section-number">5.6.2. </span>Riportare i risultati<a class="headerlink" href="#riportare-i-risultati" title="Permalink to this heading">#</a></h3>
<p>È consuetudine riportare i risultati dell’analisi di regressione in modo che insieme alle stime dei coefficienti vengano riportati i rispettivi errori standard stimati. Il valore-<span class="math notranslate nohighlight">\(p\)</span> esprime la probabilità di ottenere un valore del test uguale o superiore a quello ottenuto nel campione esaminato, utilizzando la distribuzione campionaria del test sotto l’ipotesi nulla.
Se <span class="math notranslate nohighlight">\(t_{\hat{\beta}}\)</span> è il valore osservato del rapporto <span class="math notranslate nohighlight">\(t\)</span> per il coefficiente angolare della retta di regressione, allora il { <span class="math notranslate nohighlight">\(p\)</span>-valore} è dato da</p>
<div class="math notranslate nohighlight">
\[
p = 2 \times Pr(t \geq |t_{\hat{\beta}}|),
\]</div>
<p>dove <span class="math notranslate nohighlight">\(t\)</span> è il valore di una variabile aleatoria <span class="math notranslate nohighlight">\(t\)</span> di Student con <span class="math notranslate nohighlight">\((n-2)\)</span> gradi di libertà.</p>
<section id="regola-di-decisione">
<h4><span class="section-number">5.6.2.1. </span>Regola di decisione<a class="headerlink" href="#regola-di-decisione" title="Permalink to this heading">#</a></h4>
<p>Ogni volta che il <span class="math notranslate nohighlight">\(p\)</span>-valore del test è inferiore al livello di significatività che si è scelto per <span class="math notranslate nohighlight">\(H_0\)</span>, il test porta al rifiuto dell’ipotesi nulla.
Solitamente si sceglie un livello <span class="math notranslate nohighlight">\(\alpha\)</span> pari a 0.05 o 0.01.</p>
<p>I test di significatività possono essere eseguiti con R, utilizzando la funzione <span class="math notranslate nohighlight">\(\texttt{summary()}\)</span> applicata all’oggetto creato da <span class="math notranslate nohighlight">\(\texttt{lm()}\)</span>.</p>
<p>Il test statistico sul parametro <span class="math notranslate nohighlight">\(\beta\)</span> del modello di regressione verifica l’ipotesi nulla di indipendenza, ovvero l’ipotesi che, nella popolazione, la pendenza della retta di regressione sia uguale a zero. Più informativo del test statistico <span class="math notranslate nohighlight">\(H_0: \beta=0\)</span> è  l’intervallo di confidenza per il parametro <span class="math notranslate nohighlight">\(\beta\)</span>:</p>
<div class="math notranslate nohighlight">
\[
\hat{\beta} \pm t_{\alpha/2} s_{\hat{\beta}}.
\]</div>
</section>
</section>
<section id="considerazioni-conclusive">
<h3><span class="section-number">5.6.3. </span>Considerazioni conclusive<a class="headerlink" href="#considerazioni-conclusive" title="Permalink to this heading">#</a></h3>
<p>Il modello di regressione lineare semplice è un metodo per studiare la relazione tra due variabili e per prevedere il valore della variabile dipendente in base alla variabile indipendente. Tuttavia, questo modello è limitato poiché si concentra solo sulla relazione tra una singola variabile indipendente e la variabile dipendente. Quando ci sono più variabili indipendenti, il modello di regressione diventa più complesso e richiede l’uso dell’algebra matriciale. Questo modello può includere variabili indipendenti sia quantitative che qualitative e può essere utilizzato anche per l’analisi della varianza. Il modello lineare è alla base dell’analisi fattoriale, una tecnica ampiamente utilizzata per la costruzione e la validazione dei test psicometrici.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./_measurement"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="011_joint_prob.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Probabilità congiunta</p>
      </div>
    </a>
    <a class="right-next"
       href="../_ctt/020_ctt_1.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">6. </span>Fondamenti teorici</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#covarianza-e-correlazione">5.1. Covarianza e correlazione</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#correlazione">5.1.1. Correlazione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione">5.1.2. Interpretazione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-bivariata">5.2. Regressione bivariata</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regressori-centrati">5.2.1. Regressori centrati</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#minimi-quadrati">5.2.2. Minimi quadrati</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relazione-tra-b-e-r">5.2.3. Relazione tra <span class="math notranslate nohighlight">\(b\)</span> e <span class="math notranslate nohighlight">\(r\)</span></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#attenuazione">5.2.4. Attenuazione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#valori-predetti-e-residui">5.3. Valori predetti e residui</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficiente-di-determinazione">5.4. Coefficiente di determinazione</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#errore-standard-della-regressione">5.4.1. Errore standard della regressione</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-multipla">5.5. Regressione multipla</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#significato-dei-coefficienti-parziali-di-regressione">5.5.1. Significato dei coefficienti parziali di regressione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#relazioni-causali">5.5.2. Relazioni causali</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#errore-di-specificazione">5.5.3. Errore di specificazione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#soppressione">5.5.4. Soppressione</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stepwise-regression">5.5.5. Stepwise regression</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regressione-stepwise">5.5.6. Regressione Stepwise</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#proprieta-degli-stimatori-dei-minimi-quadrati">5.6. Proprietà degli stimatori dei minimi quadrati</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ipotesi-statistiche-e-statistica-test">5.6.1. Ipotesi statistiche e statistica test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#riportare-i-risultati">5.6.2. Riportare i risultati</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#regola-di-decisione">5.6.2.1. Regola di decisione</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-conclusive">5.6.3. Considerazioni conclusive</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>