
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>17. Modelli multilivello &#8212; psy_test</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css?v=ca93fcec" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/a11y.css?v=ffeaf963" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=6ba04eab" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '_raters/01_multilevel_1';</script>
    <script src="../_static/custom.js?v=3f5092eb"></script>
    <link rel="icon" href="../_static/increasing.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="18. L’affidabilità tra giudici" href="02_interrater_reliability.html" />
    <link rel="prev" title="16. ✏️ Esercizi" href="../_ctt/E2_item_analyses.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="psy_test - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="psy_test - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Introduzione allo scaling psicometrico</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_measurement/01_measurement.html">1. La misurazione psicologica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/02_norms.html">2. Valutazioni normative e criteriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/03_expval_var.html">3. Variabili casuali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/04_joint_prob.html">4. Probabilità congiunta</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/05_regression.html">5. L’analisi di regressione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/E1_likert.html">6. ✏️ Esercizi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/E2_optimal_scoring.html">7. ✏️ Esercizi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_measurement/E3_thurstone.html">8. ✏️ Esercizi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria classica dei test</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_ctt/01_ctt_1.html">9. Fondamenti teorici</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/02_ctt_2.html">10. L’affidabilità del test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/03_ctt_3.html">11. Metodi di stima dell’affidabilità</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/04_err_std_mis.html">12. L’errore standard della misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/05_err_std_stima.html">13. La stima del punteggio vero</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/06_applications_ctt.html">14. Applicazioni della CTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/E1_ctt.html">15. ✏️ Esercizi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_ctt/E2_item_analyses.html">16. ✏️ Esercizi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Affidabilità tra giudici</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">17. Modelli multilivello</a></li>
<li class="toctree-l1"><a class="reference internal" href="02_interrater_reliability.html">18. L’affidabilità tra giudici</a></li>
<li class="toctree-l1"><a class="reference internal" href="E1_irr.html">19. ✏️ Esercizi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria della Generalizzabilità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_gtheory/01_gtheory.html">20. Teoria della generalizzabilità</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Validità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_validity/01_validity.html">21. La validità del test</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_validity/02_relations_to_other_vars.html">22. Relazioni test-criterio</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Sviluppo degli item</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_items/01_item_development.html">23. Lo sviluppo degli item</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_items/02_item_analysis.html">24. Analisi degli item</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi dei percorsi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_path_analysis/01_path_analysis.html">25. Analisi dei percorsi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi fattoriale esplorativa</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_fa/01_intro_fa.html">26. Introduzione all’analisi fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/02_analisi_fattoriale_1.html">27. Il modello unifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/03_analisi_fattoriale_2.html">28. Il modello statistico dell’analisi fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/04_analisi_fattoriale_3.html">29. Il modello multifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/05_factor_scores.html">30. I punteggi fattoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/06_constraints_on_parms.html">31. Attendibilità e modello fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_fa/07_total_score.html">32. Punteggio totale e modello fattoriale</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Costruzione di strumenti psicometrici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/01_valutare_le_matrici.html">33. Valutazione della matrice di correlazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/02_estrazione.html">34. L’estrazione dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/03_numero_fattori.html">35. Il numero dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/04_rotazione.html">36. La rotazione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_psychometric_methods/05_valutare_sol_fattoriale.html">37. Valutare e rifinire la soluzione fattoriale</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi fattoriale confermativa</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_cfa/01_cfa.html">38. Analisti Fattoriale Confermativa</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_cfa/E_01.html">39. ✏️ Esercizi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_cfa/02_meanstructure.html">40. La struttura delle medie</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_cfa/03_cat_data.html">41. Dati non gaussiani e categoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_cfa/04_mmm.html">42. CFA per matrici multi-tratto multi-metodo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_cfa/05_bifactor.html">43. Modello bifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_cfa/06_efa_lavaan.html">44. Analisi Fattoriale Esplorativa</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli di equazioni strutturali</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_sem/01_sem_intro.html">45. Introduzione ai Modelli SEM</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/02_data_preparation.html">46. Preparazione dei Dati</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/E_01.html">47. ✏️ Esercizi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/03_gof.html">48. Test del Modello e Indicizzazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/04_mod_comp.html">49. Confronto tra modelli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/05_cfa_mod_comp.html">50. CFA: confronto tra modelli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/06_refine_solution.html">51. La revisione del modello</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/07_group_invariance.html">52. Invarianza di misura</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/08_multilevel_sem.html">53. Modelli di Equazioni Strutturali Multilivello</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/09_structural_regr.html">54. Modelli di Regressione Strutturale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/10_missing_data.html">55. Dati mancanti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/11_small_samples.html">56. Modellizzazione SEM in Piccoli Campioni</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_sem/12_temp_reliability.html">57. Affidabilità longitudinale</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli IRT</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_irt/01_logistic_regr.html">58. Modello di Regressione Logistica</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/E_01.html">59. ✏️ Esercizi</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/02_rasch_model.html">60. Modello di Rasch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/03_assumptions.html">61. Assunzioni e Proprietà del Modello di Rasch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/04_estimation.html">62. Stima</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/05_1pl_2pl_3pl.html">63. Oltre il Modello di Rasch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/06_implementation.html">64. Implementazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_irt/07_polytomous.html">65. Modelli per Risposte Politomiche</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Mokken Scales</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_mokken/01_core_issues.html">66. Analisi della Scala di Mokken</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_mokken/02_applications.html">67. Applicazione Pratica</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_development/01_development.html">68. Sviluppo dello strumento</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_development/02_tutorial.html">69. Tutorial</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Curve di crescita latente</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_lgm/01_lgm_intro.html">70. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/02_lgm_prelims.html">71. Considerazioni Preliminari</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/03_time_effects.html">72. Dati longitudinali</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/04_invariance.html">73. Invarianza Fattoriale Longitudinale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/05_intro_panel.html">74. Specificare e Interpretare un Modello Longitudinale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/06_lgm_mixed.html">75. LGM e modelli misti</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/07_growth_1.html">76. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/08_growth_cont.html">77. Il tempo su una metrica continua</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/09_time_inv_cov.html">78. Covariate indipendenti dal tempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/10_growth_groups.html">79. Modelli di crescita latenti a gruppi multipli</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/11_bivariate_tvc_models.html">80. Modelli di crescita latenti bivariati</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/12_inv_measurement.html">81. Invarianza di Misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/13_latent_change.html">82. Modello LCS univariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/750_latent_change.html">83. Modello LCS univariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_lgm/751_biv_change.html">84. Modello LCS bivariato</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliografia</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../z_biblio.html">85. Bibliografia</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../_appendix/901_intro_r.html">86. Linguaggio di programmazione R</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ccaudek/psy_test" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ccaudek/psy_test/issues/new?title=Issue%20on%20page%20%2F_raters/01_multilevel_1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/_raters/01_multilevel_1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Modelli multilivello</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduzione">17.1. Introduzione</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descrizione-del-disegno-sperimentale">17.1.1. Descrizione del Disegno Sperimentale</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparazione-dei-dati">17.1.2. Preparazione dei Dati</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisi-della-relazione-tra-tempo-di-reazione-e-privazione-del-sonno">17.1.3. Analisi della Relazione tra Tempo di Reazione e Privazione del Sonno</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-pooling">17.2. Complete pooling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caratteristiche-del-complete-pooling">17.2.1. Caratteristiche del Complete Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitazioni-dell-approccio-di-complete-pooling">17.2.2. Limitazioni dell’Approccio di Complete Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-di-regressione-lineare-in-complete-pooling">17.2.3. Modello di Regressione Lineare in Complete Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementazione-in-r">17.2.4. Implementazione in R</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-del-modello-di-regressione-e-visualizzazione-grafica">17.2.5. Interpretazione del Modello di Regressione e Visualizzazione Grafica</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-sui-limiti-del-modello">17.2.5.1. Considerazioni sui Limiti del Modello</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aggiunta-delle-previsioni-al-grafico">17.2.5.2. Aggiunta delle Previsioni al Grafico</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approccio-di-no-pooling">17.3. Approccio di No Pooling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caratteristiche-del-no-pooling">17.3.1. Caratteristiche del No Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementazione-del-modello-di-no-pooling">17.3.2. Implementazione del Modello di No Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verifica-del-fattore-subject">17.3.3. Verifica del Fattore <code class="docutils literal notranslate"><span class="pre">Subject</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approccio-di-partial-pooling">17.4. Approccio di Partial Pooling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementazione-dei-modelli-a-effetti-misti">17.4.1. Implementazione dei Modelli a Effetti Misti</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#articolazione-e-applicazione-del-modello-multilivello">17.4.2. Articolazione e Applicazione del Modello Multilivello</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#livello-1-modellazione-della-relazione-individuale">17.4.2.1. Livello 1: Modellazione della Relazione Individuale</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#livello-2-modellazione-delle-variazioni-tra-soggetti">17.4.2.2. Livello 2: Modellazione delle Variazioni Tra Soggetti</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#componenti-di-varianza">17.4.2.3. Componenti di Varianza</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-complessiva-del-modello">17.4.2.4. Interpretazione Complessiva del Modello</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-degli-effetti-fissi-e-casuali">17.4.2.5. Interpretazione degli Effetti Fissi e Casuali</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#uso-di-campioni-per-informare-sulla-popolazione">17.4.2.6. Uso di Campioni per Informare sulla Popolazione</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spiegazione-della-matrice-di-varianza-covarianza-nel-modello-multilivello">17.4.3. Spiegazione della Matrice di Varianza-Covarianza nel Modello Multilivello</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#componenti-della-matrice">17.4.3.1. Componenti della Matrice</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#significato-e-importanza-di-sigma">17.4.3.2. Significato e Importanza di <span class="math notranslate nohighlight">\(\Sigma\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabella-delle-variabili">17.4.4. Tabella delle Variabili</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiegazione-delle-categorie-di-variabili-nel-modello-multilivello">17.4.4.1. Spiegazione delle Categorie di Variabili nel Modello Multilivello</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#variabili-fisse">17.4.4.1.1. Variabili Fisse</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#variabili-casuali">17.4.4.1.2. Variabili Casuali</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#variabili-derivate">17.4.4.1.3. Variabili Derivate</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stimare-i-parametri-del-modello">17.5. Stimare i parametri del modello</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretare-l-output-di-lmer-ed-estrarre-le-stime">17.6. Interpretare l’output di <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> ed estrarre le stime</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effetti-fissi">17.6.1. Effetti fissi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effetti-random">17.6.2. Effetti random</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-conclusive">17.7. Considerazioni Conclusive</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="modelli-multilivello">
<span id="multilevel-notebook"></span><h1><span class="section-number">17. </span>Modelli multilivello<a class="headerlink" href="#modelli-multilivello" title="Link to this heading">#</a></h1>
<section id="introduzione">
<h2><span class="section-number">17.1. </span>Introduzione<a class="headerlink" href="#introduzione" title="Link to this heading">#</a></h2>
<p>I modelli multilivello, noti anche come modelli gerarchici o a effetti misti, rappresentano una metodologia statistica potente e flessibile, particolarmente adatta per analizzare dati strutturati in più livelli. Questi modelli permettono di considerare simultaneamente variazioni a livelli diversi, come quello individuale e quello di gruppo, fornendo una comprensione più dettagliata e accurata dei fenomeni studiati.</p>
<p>In psicologia i modelli multilivello assumono un’importanza cruciale. Gli psicologi utilizzano  frequentemente dati raccolti in contesti complessi, dove gli effetti individuali e contestuali si intrecciano. Ad esempio, nella valutazione delle prestazioni cognitive o della risposta emotiva, i modelli multilivello consentono di distinguere tra variazioni dovute a caratteristiche individuali (come l’abilità cognitiva o la personalità) e quelle derivanti da fattori esterni (come l’ambiente scolastico o familiare).</p>
<p>I modelli multilivello sono particolarmente utili per:</p>
<ul class="simple">
<li><p>Analizzare dati longitudinali, dove le misurazioni ripetute sugli stessi soggetti introducono correlazioni naturali.</p></li>
<li><p>Studiare l’impatto di fattori contestuali su variabili psicologiche, consentendo di esaminare come l’ambiente influenzi i comportamenti o gli stati mentali.</p></li>
<li><p>Gestire la variabilità intra-individuale e inter-individuale in modo più efficace, offrendo una rappresentazione più realistica della complessità dei fenomeni psicologici.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">source</span><span class="p">(</span><span class="s">&quot;../_common.R&quot;</span><span class="p">)</span>

<span class="nf">suppressPackageStartupMessages</span><span class="p">({</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;rio&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;car&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;lme4&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;lavaan&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;semPlot&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;repr&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;kableExtra&quot;</span><span class="p">)</span>
<span class="p">})</span>
<span class="nf">set.seed</span><span class="p">(</span><span class="m">42</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In questo capitolo, ci focalizzeremo sull’analisi di un’indagine sperimentale condotta per studiare l’impatto della deprivazione del sonno sulle prestazioni psicomotorie. I dati utilizzati provengono dallo studio di Belenky et al. (2003) sugli effetti della deprivazione del sonno. Questi dati sono accessibili nel dataset <code class="docutils literal notranslate"><span class="pre">sleepstudy</span></code>, incluso nel pacchetto <code class="docutils literal notranslate"><span class="pre">lme4</span></code> di R <span id="id1">Bates <em>et al.</em> [<a class="reference internal" href="../z_biblio.html#id13" title="Douglas Bates, Martin Mächler, Ben Bolker, and Steve Walker. Fitting linear mixed-effects models using lme4. arXiv preprint arXiv:1406.5823, 2014.">BMachlerBW14</a>]</span>.</p>
<p>Importiamo i dati.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">data</span><span class="p">(</span><span class="n">sleepstudy</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il data frame comprende 180 righe (osservazioni) e tre variabili:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Reaction</span></code>: Average reaction time (ms)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Days</span></code>: Number of days of sleep deprivation</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Subject</span></code>: Subject number on which the observation was made.</p></li>
</ul>
<p>Questi dati forniscono un esempio di dati multilivello, caratterizzati da misurazioni ripetute su una stessa variabile dipendente - in questo caso, il tempo medio di reazione (RT) - raccolte dai medesimi partecipanti per un periodo di dieci giorni. Tale struttura di dati è molto diffusa in psicologia, dove spesso si valutano le variazioni delle risposte o dei comportamenti di individui nel tempo.</p>
<p>Il dataset esaminato focalizza su diciotto partecipanti, sottoposti a una condizione di sonno limitato a tre ore. Nell’arco di dieci giorni, questi partecipanti hanno partecipato quotidianamente a un “test di vigilanza psicomotoria” della durata di dieci minuti. Durante il test, era richiesto loro di monitorare uno schermo e di premere un pulsante quanto più rapidamente possibile alla comparsa di uno stimolo. La variabile dipendente principale dello studio è il tempo medio di risposta (RT) di ciascun partecipante.</p>
<p>Per analizzare questi dati, è utile iniziare con una rappresentazione grafica. Ci concentreremo inizialmente sui dati di un singolo soggetto. Questo approccio ci permette di osservare le tendenze e le variazioni nel tempo di reazione di quel particolare individuo, fornendo insight su come la restrizione del sonno possa influire sulle sue prestazioni nel corso dei dieci giorni.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">just_308</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sleepstudy</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">Subject</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;308&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">just_308</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Days</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2.5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">9</span><span class="p">)</span><span class="w"> </span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/c0c07d002d2142f7c19190a9769c0c4e99fe2144221adc73765e0e59523819dd.png" src="../_images/c0c07d002d2142f7c19190a9769c0c4e99fe2144221adc73765e0e59523819dd.png" />
</div>
</div>
<p>Esaminiamo i dati di tutti i 18 soggetti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">sleepstudy</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Days</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">9</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">Subject</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5a618bb0b0804868a6e3e0b28ee94f58d4ebf08ae0a0ca25b867e04cd3b85f86.png" src="../_images/5a618bb0b0804868a6e3e0b28ee94f58d4ebf08ae0a0ca25b867e04cd3b85f86.png" />
</div>
</div>
<section id="descrizione-del-disegno-sperimentale">
<h3><span class="section-number">17.1.1. </span>Descrizione del Disegno Sperimentale<a class="headerlink" href="#descrizione-del-disegno-sperimentale" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Fase di Adattamento e Baseline</strong>: I primi tre giorni dello studio (T1, T2 e B) sono stati utilizzati per l’adattamento e l’addestramento (T1 e T2), seguiti da una misurazione baseline (B). Durante questo periodo, ai soggetti è stato chiesto di rimanere a letto per 8 ore (dalle 23:00 alle 07:00).</p></li>
<li><p><strong>Condizioni di Sonno</strong>: Dal quarto giorno in poi, per sette giorni (E1-E7), i soggetti hanno sperimentato diverse condizioni di sonno, variando la durata del tempo a letto (TIB) da 3 a 9 ore.</p></li>
</ul>
<p>I primi due giorni (codificati come 0 e 1) sono stati dedicati all’adattamento e all’addestramento, mentre il terzo giorno (codificato come 2) ha visto la misurazione baseline. L’analisi dovrebbe idealmente partire dal giorno di baseline per riflettere l’effetto della restrizione del sonno sulle prestazioni. Per evitare che l’adattamento influenzi i risultati, i giorni 0 e 1 devono dunque essere esclusi dall’analisi, poiché qualsiasi variazione di prestazione in questi giorni è attribuibile all’addestramento piuttosto che alla restrizione del sonno.</p>
</section>
<section id="preparazione-dei-dati">
<h3><span class="section-number">17.1.2. </span>Preparazione dei Dati<a class="headerlink" href="#preparazione-dei-dati" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Rimozione delle Osservazioni Iniziali</strong>: Dal dataset, eliminiamo le osservazioni dove la variabile “Days” è codificata come 0 o 1.</p></li>
<li><p><strong>Creazione di una Nuova Variabile “days_deprived”</strong>: Creiamo una nuova variabile basata su “Days”, iniziando la sequenza dal giorno 2. In questa nuova variabile, il giorno 2 viene ricodificato come 0, il giorno 3 come 1, e così via. Questa variabile rappresenta il numero di giorni di privazione del sonno. Salviamo il dataset modificato con il nome <code class="docutils literal notranslate"><span class="pre">sleep2</span></code>, che ora riflette accuratamente il periodo di restrizione del sonno per l’analisi.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sleep2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sleepstudy</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">filter</span><span class="p">(</span><span class="n">Days</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="m">2L</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">days_deprived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Days</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="m">2L</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sleep2</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">count</span><span class="p">(</span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">Days</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 8 × 3</caption>
<thead>
	<tr><th scope=col>days_deprived</th><th scope=col>Days</th><th scope=col>n</th></tr>
	<tr><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>0</td><td>2</td><td>18</td></tr>
	<tr><td>1</td><td>3</td><td>18</td></tr>
	<tr><td>2</td><td>4</td><td>18</td></tr>
	<tr><td>3</td><td>5</td><td>18</td></tr>
	<tr><td>4</td><td>6</td><td>18</td></tr>
	<tr><td>5</td><td>7</td><td>18</td></tr>
	<tr><td>6</td><td>8</td><td>18</td></tr>
	<tr><td>7</td><td>9</td><td>18</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">sleep2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reaction Time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Days deprived of sleep (0 = baseline)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/84c173e705c34c1d70f0314d96c824f0ac8f5cc28f586835979953ee169f319e.png" src="../_images/84c173e705c34c1d70f0314d96c824f0ac8f5cc28f586835979953ee169f319e.png" />
</div>
</div>
</section>
<section id="analisi-della-relazione-tra-tempo-di-reazione-e-privazione-del-sonno">
<h3><span class="section-number">17.1.3. </span>Analisi della Relazione tra Tempo di Reazione e Privazione del Sonno<a class="headerlink" href="#analisi-della-relazione-tra-tempo-di-reazione-e-privazione-del-sonno" title="Link to this heading">#</a></h3>
<p>Nel contesto dello studio sulla privazione del sonno, l’analisi dei dati suggerisce che, a parte una singola eccezione (il soggetto 335), il tempo di reazione medio tende ad aumentare progressivamente con ogni giorno aggiuntivo di privazione del sonno. Questo pattern indica che potrebbe essere utile descrivere le prestazioni di ciascun partecipante attraverso un modello di regressione lineare.</p>
<p>La regressione lineare è rappresentata dall’equazione generale:</p>
<div class="math notranslate nohighlight">
\[ Y = \beta_0 + \beta_1 X, \]</div>
<p>dove <span class="math notranslate nohighlight">\( Y \)</span> è la variabile dipendente (in questo caso, il tempo di reazione), <span class="math notranslate nohighlight">\( \beta_0 \)</span> rappresenta l’intercetta (il tempo di reazione medio al giorno zero, prima dell’inizio della privazione del sonno) e <span class="math notranslate nohighlight">\( \beta_1 \)</span> è la pendenza (la variazione del tempo di reazione per ogni giorno aggiuntivo di privazione del sonno). Questi parametri (<span class="math notranslate nohighlight">\( \beta_0 \)</span> e <span class="math notranslate nohighlight">\( \beta_1 \)</span>) sono stimati dai dati.</p>
<p>Quando si modellano i dati di ciascun partecipante, emergono diverse domande: dobbiamo adattare lo stesso modello di regressione lineare a tutti i partecipanti, o sarebbe più appropriato utilizzare un modello diverso per ogni soggetto? Oppure esiste un approccio intermedio che bilancia questi estremi?</p>
<p>Per rispondere a queste domande, esploriamo tre approcci differenti, come illustrato da <span id="id2"></span>:</p>
<ol class="arabic simple">
<li><p><strong>Complete Pooling</strong>: Questo approccio implica l’utilizzo di un unico modello di regressione lineare per tutti i partecipanti. Significa che assumiamo la stessa relazione lineare (stessa intercetta e pendenza) per tutti, ignorando le differenze individuali.</p></li>
<li><p><strong>No Pooling</strong>: In questo approccio, ogni partecipante ha un proprio modello di regressione lineare individuale, con intercetta e pendenza uniche. Qui si riconosce che ogni individuo può rispondere diversamente alla privazione del sonno, e quindi il modello è personalizzato per ciascun soggetto.</p></li>
<li><p><strong>Partial Pooling</strong>: Questo approccio intermedio cerca di bilanciare gli estremi dei due metodi precedenti. Include alcuni elementi comuni tra i soggetti (ad esempio, una pendenza media) ma permette anche una certa variazione individuale.</p></li>
</ol>
</section>
</section>
<section id="complete-pooling">
<h2><span class="section-number">17.2. </span>Complete pooling<a class="headerlink" href="#complete-pooling" title="Link to this heading">#</a></h2>
<p>L’approccio di “complete pooling” in analisi statistica implica l’utilizzo di un modello che calcola un’unica intercetta e una sola pendenza per l’intero dataset. Questo metodo si basa sull’ipotesi che tutti i soggetti nel dataset condividano le stesse caratteristiche di base riguardo alla relazione tra la variabile dipendente e indipendente.</p>
<section id="caratteristiche-del-complete-pooling">
<h3><span class="section-number">17.2.1. </span>Caratteristiche del Complete Pooling<a class="headerlink" href="#caratteristiche-del-complete-pooling" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Unicità delle Stime</strong>: Il modello stima un singolo set di parametri (intercetta e pendenza) per tutti i dati, considerando l’intero campione come un’unità omogenea.</p></li>
<li><p><strong>Ignorare le Variazioni Individuali</strong>: Questo approccio non tiene conto delle possibili differenze individuali nelle intercette o nelle pendenze tra i diversi soggetti. Ad esempio, ignorara come ciascun soggetto reagisce in modo diverso alla privazione del sonno.</p></li>
</ul>
</section>
<section id="limitazioni-dell-approccio-di-complete-pooling">
<h3><span class="section-number">17.2.2. </span>Limitazioni dell’Approccio di Complete Pooling<a class="headerlink" href="#limitazioni-dell-approccio-di-complete-pooling" title="Link to this heading">#</a></h3>
<p>Dall’analisi preliminare dei dati, abbiamo notato che l’approccio di complete pooling potrebbe non essere adatto per il nostro studio. La visualizzazione dei dati suggerisce che ogni partecipante potrebbe avere una propria relazione unica tra il tempo di reazione e i giorni di privazione del sonno, indicando la necessità di valori individuali per le intercette e le pendenze.</p>
</section>
<section id="modello-di-regressione-lineare-in-complete-pooling">
<h3><span class="section-number">17.2.3. </span>Modello di Regressione Lineare in Complete Pooling<a class="headerlink" href="#modello-di-regressione-lineare-in-complete-pooling" title="Link to this heading">#</a></h3>
<p>Il modello generale lineare (GLM) per l’approccio di complete pooling è formulato come segue:</p>
<div class="math notranslate nohighlight">
\[Y_{sd} = \beta_0 + \beta_1 X_{sd} + e_{sd},\]</div>
<p>dove:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Y_{sd} \)</span> rappresenta il tempo di reazione medio del soggetto <span class="math notranslate nohighlight">\( s \)</span> nel giorno <span class="math notranslate nohighlight">\( d \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( X_{sd} \)</span> è il numero di giorni di privazione del sonno (variabile “days_deprived”), che varia da 0 a 7.</p></li>
<li><p><span class="math notranslate nohighlight">\( e_{sd} \)</span> è il termine di errore, che rappresenta le fluttuazioni casuali non spiegate dal modello.</p></li>
</ul>
</section>
<section id="implementazione-in-r">
<h3><span class="section-number">17.2.4. </span>Implementazione in R<a class="headerlink" href="#implementazione-in-r" title="Link to this heading">#</a></h3>
<p>Per adattare questo modello in R, si utilizza la funzione <code class="docutils literal notranslate"><span class="pre">lm()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cp_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">Reaction</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">sleep2</span><span class="p">)</span>

<span class="nf">summary</span><span class="p">(</span><span class="n">cp_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Reaction ~ days_deprived, data = sleep2)

Residuals:
     Min       1Q   Median       3Q      Max 
-112.284  -26.732    2.143   27.734  140.453 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)    267.967      7.737  34.633  &lt; 2e-16 ***
days_deprived   11.435      1.850   6.183 6.32e-09 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 50.85 on 142 degrees of freedom
Multiple R-squared:  0.2121,	Adjusted R-squared:  0.2066 
F-statistic: 38.23 on 1 and 142 DF,  p-value: 6.316e-09
</pre></div>
</div>
</div>
</div>
</section>
<section id="interpretazione-del-modello-di-regressione-e-visualizzazione-grafica">
<h3><span class="section-number">17.2.5. </span>Interpretazione del Modello di Regressione e Visualizzazione Grafica<a class="headerlink" href="#interpretazione-del-modello-di-regressione-e-visualizzazione-grafica" title="Link to this heading">#</a></h3>
<p>Il modello di regressione che abbiamo considerato offre una stima del tempo di risposta medio per i soggetti allo studio al Giorno 0 (prima della privazione del sonno) e la variazione media del tempo di risposta per ogni giorno aggiuntivo di privazione. Secondo questo modello, il tempo di risposta medio iniziale è stimato essere di circa 268 millisecondi, con un incremento medio di circa 11 millisecondi per ogni giorno successivo di privazione del sonno.</p>
<section id="considerazioni-sui-limiti-del-modello">
<h4><span class="section-number">17.2.5.1. </span>Considerazioni sui Limiti del Modello<a class="headerlink" href="#considerazioni-sui-limiti-del-modello" title="Link to this heading">#</a></h4>
<p>È importante notare, tuttavia, che questo modello potrebbe avere delle limitazioni nella sua applicabilità:</p>
<ul class="simple">
<li><p><strong>Assunzione di Indipendenza</strong>: Il modello assume che tutte le osservazioni siano indipendenti. Questa assunzione potrebbe non essere valida nel nostro studio, dato che le osservazioni provengono da misurazioni ripetute sugli stessi soggetti.</p></li>
<li><p><strong>Errori Standard dei Coefficienti</strong>: La presunta indipendenza delle osservazioni implica che gli errori standard dei coefficienti di regressione potrebbero non essere completamente affidabili.</p></li>
</ul>
</section>
<section id="aggiunta-delle-previsioni-al-grafico">
<h4><span class="section-number">17.2.5.2. </span>Aggiunta delle Previsioni al Grafico<a class="headerlink" href="#aggiunta-delle-previsioni-al-grafico" title="Link to this heading">#</a></h4>
<p>Per visualizzare meglio questi risultati, possiamo aggiungere le previsioni del modello al grafico che abbiamo già creato. Utilizziamo la funzione <code class="docutils literal notranslate"><span class="pre">geom_abline()</span></code> di R per tracciare la linea di regressione stimata direttamente sul grafico esistente:</p>
<ul class="simple">
<li><p><strong>Utilizzo di <code class="docutils literal notranslate"><span class="pre">geom_abline()</span></code></strong>: Questa funzione ci permette di aggiungere una linea di regressione al grafico, specificando l’intercetta e la pendenza.</p></li>
<li><p><strong>Coefficienti del Modello</strong>: Utilizziamo <code class="docutils literal notranslate"><span class="pre">coef(cp_model)</span></code> per ottenere i coefficienti di regressione (intercetta e pendenza) dal nostro modello. Questa funzione restituisce un vettore con due elementi corrispondenti all’intercetta e alla pendenza, che possono essere poi utilizzati per definire la linea nel grafico.</p></li>
</ul>
<p>In conclusione, l’aggiunta delle previsioni del modello al grafico fornisce una rappresentazione visiva dell’effetto stimato della privazione del sonno sul tempo di risposta. Tuttavia, è essenziale tenere presente le limitazioni e le assunzioni del modello, in particolare l’indipendenza delle osservazioni, che potrebbe non essere una rappresentazione accurata dei dati nel contesto di misurazioni ripetute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">sleep2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_abline</span><span class="p">(</span>
<span class="w">        </span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">cp_model</span><span class="p">)[</span><span class="m">1</span><span class="p">],</span>
<span class="w">        </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">cp_model</span><span class="p">)[</span><span class="m">2</span><span class="p">],</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reaction Time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Days deprived of sleep (0 = baseline)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f59d56ee5567266e091e399d842f8127ec0503b62fbbf1c19efac023e78c23d6.png" src="../_images/f59d56ee5567266e091e399d842f8127ec0503b62fbbf1c19efac023e78c23d6.png" />
</div>
</div>
<p>Dall’analisi effettuata, emerge che il modello attuale non si adatta in modo ottimale ai dati raccolti. Questa situazione indica la necessità di esplorare un approccio diverso per modellare in modo più accurato le relazioni presenti nei dati.</p>
</section>
</section>
</section>
<section id="approccio-di-no-pooling">
<h2><span class="section-number">17.3. </span>Approccio di No Pooling<a class="headerlink" href="#approccio-di-no-pooling" title="Link to this heading">#</a></h2>
<p>In alternativa al modello di “complete pooling”, consideriamo l’approccio di “no pooling”. Questo approccio si basa sull’idea di adattare modelli di regressione separati per ogni partecipante, trattando ogni individuo come un’entità distinta.</p>
<section id="caratteristiche-del-no-pooling">
<h3><span class="section-number">17.3.1. </span>Caratteristiche del No Pooling<a class="headerlink" href="#caratteristiche-del-no-pooling" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Indipendenza delle Stime</strong>: In questo approccio, ogni partecipante ha il proprio set di stime per l’intercetta e la pendenza. Le stime relative a un partecipante non sono influenzate dalle stime degli altri.</p></li>
<li><p><strong>Stime Individualizzate</strong>: Si stima separatamente una coppia di intercetta/pendenza per ciascuno dei 18 partecipanti, riconoscendo la possibilità di variazioni significative nelle risposte individuali.</p></li>
</ul>
</section>
<section id="implementazione-del-modello-di-no-pooling">
<h3><span class="section-number">17.3.2. </span>Implementazione del Modello di No Pooling<a class="headerlink" href="#implementazione-del-modello-di-no-pooling" title="Link to this heading">#</a></h3>
<p>Esistono due modi principali per implementare questo approccio:</p>
<ol class="arabic simple">
<li><p><strong>Regressioni Separate per Ogni Partecipante</strong>: Eseguire una serie di regressioni lineari individuali, una per ogni soggetto.</p></li>
<li><p><strong>Modello di Regressione Unificato con Effetti Principali e Interazione</strong>: Utilizzare un unico modello di regressione che includa sia gli effetti principali sia l’interazione tra le variabili <code class="docutils literal notranslate"><span class="pre">Subject</span></code> (soggetto) e <code class="docutils literal notranslate"><span class="pre">Day</span></code> (giorno). Questo metodo permette di includere tutte le stime in un unico modello.</p></li>
</ol>
<p>Per il secondo approccio, è necessario considerare le seguenti fasi:</p>
<ul class="simple">
<li><p><strong>Creazione di Variabili Dummy per il Fattore <code class="docutils literal notranslate"><span class="pre">Subject</span></code></strong>: Poiché <code class="docutils literal notranslate"><span class="pre">Subject</span></code> ha 18 livelli, saranno necessarie 17 variabili dummy per rappresentare questi livelli. In R, questo può essere fatto automaticamente definendo <code class="docutils literal notranslate"><span class="pre">Subject</span></code> come un fattore.</p></li>
<li><p><strong>Includere <code class="docutils literal notranslate"><span class="pre">Subject</span></code> come Fattore nel Modello</strong>: Aggiungere <code class="docutils literal notranslate"><span class="pre">Subject</span></code>, definito come un fattore, come predittore nel modello. L’inclusione dell’interazione tra <code class="docutils literal notranslate"><span class="pre">Subject</span></code> e <code class="docutils literal notranslate"><span class="pre">days_deprived</span></code> permette variazioni nelle intercette e nelle pendenze tra i soggetti.</p></li>
</ul>
</section>
<section id="verifica-del-fattore-subject">
<h3><span class="section-number">17.3.3. </span>Verifica del Fattore <code class="docutils literal notranslate"><span class="pre">Subject</span></code><a class="headerlink" href="#verifica-del-fattore-subject" title="Link to this heading">#</a></h3>
<p>Prima di procedere, è importante assicurarsi che <code class="docutils literal notranslate"><span class="pre">Subject</span></code> sia definito correttamente come un fattore. Questo può essere verificato utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">summary()</span></code> in R, che fornisce una sintesi delle caratteristiche della variabile, compreso se è trattata come un fattore.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sleep2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">    </span><span class="nf">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Reaction          Days         Subject   days_deprived 
 Min.   :203.0   Min.   :2.00   308    : 8   Min.   :0.00  
 1st Qu.:265.2   1st Qu.:3.75   309    : 8   1st Qu.:1.75  
 Median :303.2   Median :5.50   310    : 8   Median :3.50  
 Mean   :308.0   Mean   :5.50   330    : 8   Mean   :3.50  
 3rd Qu.:347.7   3rd Qu.:7.25   331    : 8   3rd Qu.:5.25  
 Max.   :466.4   Max.   :9.00   332    : 8   Max.   :7.00  
                                (Other):96                 
</pre></div>
</div>
</div>
</div>
<p>La funzione <code class="docutils literal notranslate"><span class="pre">pull()</span></code> viene utilizzata per estrarre una specifica colonna da un data frame. Con le seguenti istruzioni verifichiamo se la colonna <code class="docutils literal notranslate"><span class="pre">Subject</span></code> è codificata come <code class="docutils literal notranslate"><span class="pre">factor</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">sleep2</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">is.factor</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">TRUE</div></div>
</div>
<p>Adattiamo il modello di regressione ai dati. Si noti che la sintassi seguente può essere semplificata utilizzando <code class="docutils literal notranslate"><span class="pre">Reaction</span> <span class="pre">~</span> <span class="pre">days_deprived</span> <span class="pre">*</span> <span class="pre">Subject</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">np_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">Reaction</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">days_deprived</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Subject</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">days_deprived</span><span class="o">:</span><span class="n">Subject</span><span class="p">,</span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sleep2</span>
<span class="p">)</span>

<span class="nf">summary</span><span class="p">(</span><span class="n">np_model</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Call:
lm(formula = Reaction ~ days_deprived + Subject + days_deprived:Subject, 
    data = sleep2)

Residuals:
     Min       1Q   Median       3Q      Max 
-106.521   -8.541    1.143    8.889  128.545 

Coefficients:
                         Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)              288.2175    16.4772  17.492  &lt; 2e-16 ***
days_deprived             21.6905     3.9388   5.507 2.49e-07 ***
Subject309               -87.9262    23.3023  -3.773 0.000264 ***
Subject310               -62.2856    23.3023  -2.673 0.008685 ** 
Subject330               -14.9533    23.3023  -0.642 0.522422    
Subject331                 9.9658    23.3023   0.428 0.669740    
Subject332                27.8157    23.3023   1.194 0.235215    
Subject333                -2.7581    23.3023  -0.118 0.906000    
Subject334               -50.2051    23.3023  -2.155 0.033422 *  
Subject335               -25.3429    23.3023  -1.088 0.279207    
Subject337                24.6143    23.3023   1.056 0.293187    
Subject349               -59.2183    23.3023  -2.541 0.012464 *  
Subject350               -40.2023    23.3023  -1.725 0.087343 .  
Subject351               -24.2467    23.3023  -1.041 0.300419    
Subject352                43.0655    23.3023   1.848 0.067321 .  
Subject369               -21.5040    23.3023  -0.923 0.358154    
Subject370               -53.3072    23.3023  -2.288 0.024107 *  
Subject371               -30.4896    23.3023  -1.308 0.193504    
Subject372                 2.4772    23.3023   0.106 0.915535    
days_deprived:Subject309 -17.3334     5.5703  -3.112 0.002380 ** 
days_deprived:Subject310 -17.7915     5.5703  -3.194 0.001839 ** 
days_deprived:Subject330 -13.6849     5.5703  -2.457 0.015613 *  
days_deprived:Subject331 -16.8231     5.5703  -3.020 0.003154 ** 
days_deprived:Subject332 -19.2947     5.5703  -3.464 0.000765 ***
days_deprived:Subject333 -10.8151     5.5703  -1.942 0.054796 .  
days_deprived:Subject334  -3.5745     5.5703  -0.642 0.522423    
days_deprived:Subject335 -25.8995     5.5703  -4.650 9.47e-06 ***
days_deprived:Subject337   0.7518     5.5703   0.135 0.892895    
days_deprived:Subject349  -5.2644     5.5703  -0.945 0.346731    
days_deprived:Subject350   1.6007     5.5703   0.287 0.774382    
days_deprived:Subject351 -13.1681     5.5703  -2.364 0.019867 *  
days_deprived:Subject352 -14.4019     5.5703  -2.585 0.011057 *  
days_deprived:Subject369  -7.8948     5.5703  -1.417 0.159273    
days_deprived:Subject370  -1.0495     5.5703  -0.188 0.850912    
days_deprived:Subject371  -9.3443     5.5703  -1.678 0.096334 .  
days_deprived:Subject372 -10.6041     5.5703  -1.904 0.059613 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 25.53 on 108 degrees of freedom
Multiple R-squared:  0.849,	Adjusted R-squared:  0.8001 
F-statistic: 17.35 on 35 and 108 DF,  p-value: &lt; 2.2e-16
</pre></div>
</div>
</div>
</div>
<p>Per chiarire, il soggetto di riferimento è il 308; in R, la modalità predefinita è quella di ordinare i livelli del fattore in ordine alfabetico e di scegliere il primo come soggetto di riferimento. Questo significa che l’intercetta e la pendenza per il soggetto 308 sono rappresentate rispettivamente da <code class="docutils literal notranslate"><span class="pre">(Intercept)</span></code> e <code class="docutils literal notranslate"><span class="pre">days_deprived</span></code>, poiché tutte le altre 17 variabili dummy saranno nulle per il soggetto 308.</p>
<p>Tutti i coefficienti di regressione degli altri soggetti sono rappresentati come scostamenti da questo soggetto di riferimento. Se desideriamo calcolare l’intercetta e la pendenza per un dato soggetto, dobbiamo semplicemente sommare gli scostamenti corrispondenti. Pertanto, abbiamo:</p>
<p>Intercetta per 308: 288.217<br />
Pendenza per 308: 21.69</p>
<p>Intercetta per 335: <code class="docutils literal notranslate"><span class="pre">(Intercept)</span> <span class="pre">+</span> <span class="pre">Subject335</span></code> = 288.217 + -25.343 = 262.874<br />
Pendenza per 335: <code class="docutils literal notranslate"><span class="pre">days_deprived</span> <span class="pre">+</span> <span class="pre">days_deprived:Subject335</span></code> = 21.69 + -25.899 = -4.209</p>
<p>E così via.</p>
<p>Nel modello “no pooling”, non viene stimata un’intercetta e una pendenza complessive per l’intera popolazione; in questo caso, <code class="docutils literal notranslate"><span class="pre">(Intercept)</span></code> e <code class="docutils literal notranslate"><span class="pre">days_deprived</span></code> sono stime dell’intercetta e della pendenza per il soggetto 308, che è stato scelto (arbitrariamente) come soggetto di riferimento. Per ottenere stime per l’intera popolazione, è possibile procedere con una seconda fase dell’analisi statistica in cui calcoliamo le medie delle intercette e delle pendenze individuali.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">all_intercepts</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="nf">coef</span><span class="p">(</span><span class="n">np_model</span><span class="p">)[</span><span class="s">&quot;(Intercept)&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nf">coef</span><span class="p">(</span><span class="n">np_model</span><span class="p">)[</span><span class="m">3</span><span class="o">:</span><span class="m">19</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">np_model</span><span class="p">)[</span><span class="s">&quot;(Intercept)&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">all_slopes</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="nf">coef</span><span class="p">(</span><span class="n">np_model</span><span class="p">)[</span><span class="s">&quot;days_deprived&quot;</span><span class="p">],</span>
<span class="w">    </span><span class="nf">coef</span><span class="p">(</span><span class="n">np_model</span><span class="p">)[</span><span class="m">20</span><span class="o">:</span><span class="m">36</span><span class="p">]</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">coef</span><span class="p">(</span><span class="n">np_model</span><span class="p">)[</span><span class="s">&quot;days_deprived&quot;</span><span class="p">]</span>
<span class="p">)</span>

<span class="n">ids</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">sleep2</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">levels</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">factor</span><span class="p">()</span>

<span class="c1"># make a tibble with the data extracted above</span>
<span class="n">np_coef</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">tibble</span><span class="p">(</span>
<span class="w">    </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ids</span><span class="p">,</span>
<span class="w">    </span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">all_intercepts</span><span class="p">,</span>
<span class="w">    </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">all_slopes</span>
<span class="p">)</span>

<span class="n">np_coef</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 18 × 3</caption>
<thead>
	<tr><th scope=col>Subject</th><th scope=col>intercept</th><th scope=col>slope</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;dbl&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>308</td><td>288.2175</td><td>21.690495</td></tr>
	<tr><td>309</td><td>200.2913</td><td> 4.357144</td></tr>
	<tr><td>310</td><td>225.9318</td><td> 3.898995</td></tr>
	<tr><td>330</td><td>273.2642</td><td> 8.005643</td></tr>
	<tr><td>331</td><td>298.1833</td><td> 4.867369</td></tr>
	<tr><td>332</td><td>316.0332</td><td> 2.395811</td></tr>
	<tr><td>333</td><td>285.4593</td><td>10.875389</td></tr>
	<tr><td>334</td><td>238.0123</td><td>18.115979</td></tr>
	<tr><td>335</td><td>262.8746</td><td>-4.208992</td></tr>
	<tr><td>337</td><td>312.8318</td><td>22.442265</td></tr>
	<tr><td>349</td><td>228.9991</td><td>16.426131</td></tr>
	<tr><td>350</td><td>248.0152</td><td>23.291223</td></tr>
	<tr><td>351</td><td>263.9708</td><td> 8.522405</td></tr>
	<tr><td>352</td><td>331.2829</td><td> 7.288607</td></tr>
	<tr><td>369</td><td>266.7134</td><td>13.795664</td></tr>
	<tr><td>370</td><td>234.9102</td><td>20.641012</td></tr>
	<tr><td>371</td><td>257.7279</td><td>12.346217</td></tr>
	<tr><td>372</td><td>290.6947</td><td>11.086360</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Esaminiamo l’adattamento di questo modello ai dati.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">sleep2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_abline</span><span class="p">(</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">np_coef</span><span class="p">,</span>
<span class="w">        </span><span class="n">mapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span>
<span class="w">            </span><span class="n">intercept</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">intercept</span><span class="p">,</span>
<span class="w">            </span><span class="n">slope</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">slope</span>
<span class="w">        </span><span class="p">),</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reaction Time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Days deprived of sleep (0 = baseline)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/661b4f8081ea6feb2f7bc333b2bceddd8e9432f1605ca4c5c675b1cc9761b35d.png" src="../_images/661b4f8081ea6feb2f7bc333b2bceddd8e9432f1605ca4c5c675b1cc9761b35d.png" />
</div>
</div>
<p>Questa situazione è notevolmente migliorata rispetto al modello di pooling completo. Se desideriamo testare l’ipotesi nulla secondo cui la pendenza della retta di regressione è uguale a zero, possiamo farlo eseguendo un test <span class="math notranslate nohighlight">\(t\)</span> di Student sul campione di pendenze individuali.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">np_coef</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">slope</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">t.test</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>	One Sample t-test

data:  pull(np_coef, slope)
t = 6.1971, df = 17, p-value = 9.749e-06
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
  7.542244 15.328613
sample estimates:
mean of x 
 11.43543 
</pre></div>
</div>
</div>
</div>
<p>Questo test suggerisce che la pendenza media di 11.435 è diversa da zero, <span class="math notranslate nohighlight">\(t(\)</span>17) = 6.20 <span class="math notranslate nohighlight">\(p &lt;\)</span> .001.</p>
</section>
</section>
<section id="approccio-di-partial-pooling">
<h2><span class="section-number">17.4. </span>Approccio di Partial Pooling<a class="headerlink" href="#approccio-di-partial-pooling" title="Link to this heading">#</a></h2>
<p>Nell’ambito dell’analisi dei dati psicologici, i ricercatori si trovano spesso a dover gestire un delicato equilibrio. Da un lato, vi è l’approccio di <em>complete pooling</em>, che tratta tutti i dati come se appartenessero a un unico gruppo omogeneo, e dall’altro, l’approccio di <em>no-pooling</em>, che considera i dati di ciascun soggetto in modo isolato, senza sfruttare le informazioni aggregate. Entrambi gli estremi hanno limitazioni significative: il <em>complete pooling</em> può mascherare le variazioni individuali, mentre il <em>no-pooling</em> può non sfruttare appieno le informazioni disponibili dall’intero set di dati.</p>
<p>Per superare queste limitazioni, emerge l’approccio di <em>partial pooling</em>. Questo metodo utilizza i modelli lineari a effetti misti, che rappresentano una via di mezzo tra i due estremi menzionati. Il <em>partial pooling</em> permette di trarre vantaggio dalle informazioni provenienti dall’insieme dei partecipanti, migliorando così le stime dei soggetti individuali. Attraverso questo approccio, si ottengono stime che non solo tengono conto delle peculiarità di ciascun individuo ma sono anche informate dalle tendenze generali osservate nel gruppo più ampio.</p>
<p>L’approccio di <em>partial pooling</em> permette di separare più efficacemente le tendenze generali dagli errori casuali in ciascun partecipante e si dimostra più adatto per generalizzare i risultati a una popolazione più ampia, al di là dei soggetti specifici coinvolti nello studio.</p>
<section id="implementazione-dei-modelli-a-effetti-misti">
<h3><span class="section-number">17.4.1. </span>Implementazione dei Modelli a Effetti Misti<a class="headerlink" href="#implementazione-dei-modelli-a-effetti-misti" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Trattare i Soggetti come Fattori Casuali</strong>: Nel <em>partial pooling</em>, i soggetti vengono considerati come un fattore casuale anziché fisso. Ciò implica che i livelli del fattore (i soggetti nel nostro caso) sono visti come un campione casuale da una popolazione più ampia.</p></li>
<li><p><strong>Modello Lineare a Effetti Misti</strong>: Questo tipo di modello statistico consente di includere i fattori casuali nell’analisi. In un modello misto, le stime per ogni soggetto sono “informate” o influenzate dalle informazioni aggregate degli altri soggetti.</p></li>
<li><p><strong>Shrinkage o Restringimento</strong>: Il fenomeno dello <em>shrinkage</em> indica che le stime per ciascun soggetto vengono regolate o “spostate” verso le stime medie della popolazione, permettendo una valutazione più equilibrata e meno influenzata da variazioni estreme o casuali.</p></li>
</ul>
</section>
<section id="articolazione-e-applicazione-del-modello-multilivello">
<h3><span class="section-number">17.4.2. </span>Articolazione e Applicazione del Modello Multilivello<a class="headerlink" href="#articolazione-e-applicazione-del-modello-multilivello" title="Link to this heading">#</a></h3>
<p>Il modello multilivello che analizziamo è strutturato per cogliere le relazioni dinamiche tra variabili a livelli diversi. Esaminiamo i dettagli di ogni livello e il loro significato nel contesto del modello.</p>
<section id="livello-1-modellazione-della-relazione-individuale">
<h4><span class="section-number">17.4.2.1. </span>Livello 1: Modellazione della Relazione Individuale<a class="headerlink" href="#livello-1-modellazione-della-relazione-individuale" title="Link to this heading">#</a></h4>
<p>Il primo livello del modello esprime la relazione lineare individuale tra la variabile di risposta (tempo di reazione) e i predittori (giorni di privazione del sonno):</p>
<div class="math notranslate nohighlight">
\[
Y_{sd} = \beta_{0s} + \beta_{1s} X_{sd} + e_{sd},
\]</div>
<p>dove <span class="math notranslate nohighlight">\(Y_{sd}\)</span> è il tempo di reazione del soggetto <span class="math notranslate nohighlight">\(s\)</span> al giorno <span class="math notranslate nohighlight">\(d\)</span>, <span class="math notranslate nohighlight">\(\beta_{0s}\)</span> e <span class="math notranslate nohighlight">\(\beta_{1s}\)</span> sono i parametri individuali di intercetta e pendenza, e <span class="math notranslate nohighlight">\(e_{sd}\)</span> rappresenta l’errore per ogni soggetto e giorno. I parametri <span class="math notranslate nohighlight">\(\beta_{0s}\)</span> e <span class="math notranslate nohighlight">\(\beta_{1s}\)</span> sono considerati derivati, poiché dipendono dalle variabili a Livello 2.</p>
</section>
<section id="livello-2-modellazione-delle-variazioni-tra-soggetti">
<h4><span class="section-number">17.4.2.2. </span>Livello 2: Modellazione delle Variazioni Tra Soggetti<a class="headerlink" href="#livello-2-modellazione-delle-variazioni-tra-soggetti" title="Link to this heading">#</a></h4>
<p>Al secondo livello, definiamo come l’intercetta e la pendenza cambiano tra i soggetti:</p>
<div class="math notranslate nohighlight">
\[
\beta_{0s} = \gamma_{0} + S_{0s},
\]</div>
<div class="math notranslate nohighlight">
\[
\beta_{1s} = \gamma_{1} + S_{1s}.
\]</div>
<p>Qui, <span class="math notranslate nohighlight">\(\gamma_0\)</span> e <span class="math notranslate nohighlight">\(\gamma_1\)</span> sono gli effetti fissi che rappresentano l’intercetta e la pendenza medie della popolazione, mentre <span class="math notranslate nohighlight">\(S_{0s}\)</span> e <span class="math notranslate nohighlight">\(S_{1s}\)</span> sono gli effetti casuali che permettono variazioni individuali.</p>
</section>
<section id="componenti-di-varianza">
<h4><span class="section-number">17.4.2.3. </span>Componenti di Varianza<a class="headerlink" href="#componenti-di-varianza" title="Link to this heading">#</a></h4>
<p>Le componenti di varianza nel modello sono espresse come:</p>
<div class="math notranslate nohighlight">
\[
\langle S_{0s}, S_{1s} \rangle \sim N(\langle 0, 0 \rangle, \mathbf{\Sigma}),
\]</div>
<div class="math notranslate nohighlight">
\[\begin{split}
\mathbf{\Sigma} = \begin{pmatrix}{\tau_{00}}^2 &amp; \rho\tau_{00}\tau_{11} \\ \rho\tau_{00}\tau_{11} &amp; {\tau_{11}}^2 \end{pmatrix},
\end{split}\]</div>
<div class="math notranslate nohighlight">
\[
e_{sd} \sim N(0, \sigma^2).
\]</div>
<p>La matrice <span class="math notranslate nohighlight">\(\mathbf{\Sigma}\)</span> determina la distribuzione degli effetti casuali, con <span class="math notranslate nohighlight">\({\tau_{00}}^2\)</span> e <span class="math notranslate nohighlight">\({\tau_{11}}^2\)</span> che indicano le varianze delle intercette e delle pendenze casuali, mentre <span class="math notranslate nohighlight">\(\rho\)</span> è la correlazione tra questi effetti.</p>
</section>
<section id="interpretazione-complessiva-del-modello">
<h4><span class="section-number">17.4.2.4. </span>Interpretazione Complessiva del Modello<a class="headerlink" href="#interpretazione-complessiva-del-modello" title="Link to this heading">#</a></h4>
<p>Unendo le equazioni di Livello 1 e Livello 2, otteniamo una visione completa del modello:</p>
<div class="math notranslate nohighlight">
\[
Y_{sd} = \gamma_0 + S_{0s} + (\gamma_1 + S_{1s}) X_{sd} + e_{sd},
\]</div>
<p>dove</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\( Y_{sd} \)</span>: È il valore osservato della variabile di risposta per il soggetto <span class="math notranslate nohighlight">\( s \)</span> al giorno <span class="math notranslate nohighlight">\( d \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( \gamma_0 \)</span> e <span class="math notranslate nohighlight">\( \gamma_1 \)</span>: Sono gli effetti fissi. <span class="math notranslate nohighlight">\( \gamma_0 \)</span> rappresenta l’intercetta generale, ovvero la media della popolazione per la variabile di risposta quando la variabile predittiva <span class="math notranslate nohighlight">\( X \)</span> è zero. <span class="math notranslate nohighlight">\( \gamma_1 \)</span> rappresenta la pendenza generale, che indica come la variabile di risposta cambia in media con un’unità di incremento della variabile predittiva <span class="math notranslate nohighlight">\( X \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( S_{0s} \)</span> e <span class="math notranslate nohighlight">\( S_{1s} \)</span>: Sono gli effetti casuali. <span class="math notranslate nohighlight">\( S_{0s} \)</span> è l’effetto casuale dell’intercetta per il soggetto <span class="math notranslate nohighlight">\( s \)</span>, mentre <span class="math notranslate nohighlight">\( S_{1s} \)</span> è l’effetto casuale della pendenza. Questi termini rappresentano come ciascun soggetto si discosta dalla media della popolazione.</p></li>
<li><p><span class="math notranslate nohighlight">\( X_{sd} \)</span>: È la variabile predittiva per il soggetto <span class="math notranslate nohighlight">\( s \)</span> al giorno <span class="math notranslate nohighlight">\( d \)</span>.</p></li>
<li><p><span class="math notranslate nohighlight">\( e_{sd} \)</span>: È l’errore casuale associato a ciascuna osservazione.</p></li>
</ul>
</section>
<section id="interpretazione-degli-effetti-fissi-e-casuali">
<h4><span class="section-number">17.4.2.5. </span>Interpretazione degli Effetti Fissi e Casuali<a class="headerlink" href="#interpretazione-degli-effetti-fissi-e-casuali" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p>Gli effetti fissi (<span class="math notranslate nohighlight">\( \gamma_0 \)</span> e <span class="math notranslate nohighlight">\( \gamma_1 \)</span>) sono costanti per tutti i soggetti e riflettono le caratteristiche della popolazione generale.</p></li>
<li><p>Gli effetti casuali (<span class="math notranslate nohighlight">\( S_{0s} \)</span> e <span class="math notranslate nohighlight">\( S_{1s} \)</span>) variano da soggetto a soggetto e sono modellati come distribuzioni normali centrate attorno a zero. Questo significa che la distribuzione degli effetti casuali è centrata attorno agli effetti fissi della popolazione.</p></li>
</ul>
</section>
<section id="uso-di-campioni-per-informare-sulla-popolazione">
<h4><span class="section-number">17.4.2.6. </span>Uso di Campioni per Informare sulla Popolazione<a class="headerlink" href="#uso-di-campioni-per-informare-sulla-popolazione" title="Link to this heading">#</a></h4>
<p>Trattare i soggetti come variabili casuali anziché fisse ci consente di usare i dati del campione per inferire sulla popolazione più ampia. Invece di stimare valori specifici per ogni soggetto, il modello stima la distribuzione da cui questi valori sono estratti, fornendo una visione più generalizzata e applicabile a livello di popolazione.</p>
</section>
</section>
<section id="spiegazione-della-matrice-di-varianza-covarianza-nel-modello-multilivello">
<h3><span class="section-number">17.4.3. </span>Spiegazione della Matrice di Varianza-Covarianza nel Modello Multilivello<a class="headerlink" href="#spiegazione-della-matrice-di-varianza-covarianza-nel-modello-multilivello" title="Link to this heading">#</a></h3>
<p>La matrice di varianza-covarianza nel modello multilivello gioca un ruolo cruciale nel definire come gli effetti casuali variano e sono correlati tra loro all’interno della popolazione studiata. Questa matrice è rappresentata come segue:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Sigma = 
\begin{pmatrix}
\tau_{00}^2 &amp; \rho \tau_{00} \tau_{11} \\
\rho \tau_{00} \tau_{11} &amp; \tau_{11}^2
\end{pmatrix},
\end{split}\]</div>
<p>dove <span class="math notranslate nohighlight">\(\Sigma\)</span> denota la matrice di varianza-covarianza per gli effetti casuali <span class="math notranslate nohighlight">\(\langle S_{0s}, S_{1s} \rangle\)</span>, che sono modellati come normalmente distribuiti con una media di zero e una varianza-covarianza data da <span class="math notranslate nohighlight">\(\Sigma\)</span>.</p>
<section id="componenti-della-matrice">
<h4><span class="section-number">17.4.3.1. </span>Componenti della Matrice<a class="headerlink" href="#componenti-della-matrice" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Varianze degli Effetti Casuali</strong>:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\tau_{00}^2\)</span>: Varianza dell’effetto casuale sull’intercetta (<span class="math notranslate nohighlight">\(S_{0s}\)</span>). Questo parametro indica quanto i soggetti differiscono nella loro reazione iniziale (tempo di reazione al Giorno 0) prima di qualsiasi privazione del sonno.</p></li>
<li><p><span class="math notranslate nohighlight">\(\tau_{11}^2\)</span>: Varianza dell’effetto casuale sulla pendenza (<span class="math notranslate nohighlight">\(S_{1s}\)</span>). Misura la variazione tra i soggetti nella loro reattività agli effetti della privazione del sonno.</p></li>
</ul>
</li>
<li><p><strong>Covarianze</strong>:</p>
<ul>
<li><p><span class="math notranslate nohighlight">\(\rho \tau_{00} \tau_{11}\)</span>: Covarianza tra l’intercetta e la pendenza casuali. Questo termine riflette come la reazione iniziale di un soggetto (intercetta) sia correlata con la variazione della sua reattività al sonno (pendenza). Un valore positivo di <span class="math notranslate nohighlight">\(\rho\)</span> indica che soggetti con un tempo di reazione inizialmente più lento tendono a mostrare un aumento più marcato del tempo di reazione con la privazione del sonno, e viceversa.</p></li>
</ul>
</li>
</ul>
</section>
<section id="significato-e-importanza-di-sigma">
<h4><span class="section-number">17.4.3.2. </span>Significato e Importanza di <span class="math notranslate nohighlight">\(\Sigma\)</span><a class="headerlink" href="#significato-e-importanza-di-sigma" title="Link to this heading">#</a></h4>
<ul class="simple">
<li><p><strong>Distribuzione degli Effetti Casuali</strong>: La matrice <span class="math notranslate nohighlight">\(\Sigma\)</span> determina le probabilità di estrarre una coppia specifica di effetti casuali (<span class="math notranslate nohighlight">\(S_{0s}, S_{1s}\)</span>) per un soggetto dal pool più ampio della popolazione.</p></li>
<li><p><strong>Analisi delle Variazioni Individuali</strong>: Attraverso <span class="math notranslate nohighlight">\(\Sigma\)</span>, possiamo comprendere meglio quanto e in che modo i soggetti variano sia nella loro reazione iniziale sia nella loro risposta alla privazione del sonno.</p></li>
<li><p><strong>Interpretazione dei Risultati</strong>: La comprensione di <span class="math notranslate nohighlight">\(\Sigma\)</span> aiuta a interpretare i risultati del modello in termini di varianza e covarianza tra i soggetti, permettendo di trarre conclusioni più precise sulla popolazione studiata.</p></li>
</ul>
<p>La matrice di varianza-covarianza <span class="math notranslate nohighlight">\(\Sigma\)</span> è fondamentale nel modello multilivello perché fornisce un quadro dettagliato della varianza e della covarianza degli effetti casuali, consentendo di cogliere le sottili variazioni e correlazioni tra i soggetti. Questa comprensione arricchisce l’analisi e rende possibili conclusioni più accurate sulla popolazione.</p>
</section>
</section>
<section id="tabella-delle-variabili">
<h3><span class="section-number">17.4.4. </span>Tabella delle Variabili<a class="headerlink" href="#tabella-delle-variabili" title="Link to this heading">#</a></h3>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Variabile</p></th>
<th class="head"><p>Tipo</p></th>
<th class="head"><p>Descrizione</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(Y_{sd}\)</span></p></td>
<td><p>Osservata</p></td>
<td><p>Valore di <code class="docutils literal notranslate"><span class="pre">Reaction</span></code> per il soggetto <span class="math notranslate nohighlight">\(s\)</span> al giorno <span class="math notranslate nohighlight">\(d\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(X_{sd}\)</span></p></td>
<td><p>Osservata</p></td>
<td><p>Valore di <code class="docutils literal notranslate"><span class="pre">days_deprived</span></code> (0-7) per il soggetto <span class="math notranslate nohighlight">\(s\)</span> al giorno <span class="math notranslate nohighlight">\(d\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\beta_{0s}\)</span></p></td>
<td><p>Derivata</p></td>
<td><p>Parametro di intercetta di livello 1 per il soggetto <span class="math notranslate nohighlight">\(s\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\beta_{1s}\)</span></p></td>
<td><p>Derivata</p></td>
<td><p>Parametro di pendenza di livello 1 per il soggetto <span class="math notranslate nohighlight">\(s\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(e_{sd}\)</span></p></td>
<td><p>Derivata</p></td>
<td><p>Errore per il soggetto <span class="math notranslate nohighlight">\(s\)</span> al giorno <span class="math notranslate nohighlight">\(d\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\gamma_0\)</span></p></td>
<td><p>Fissa</p></td>
<td><p>Intersezione generale (media di <span class="math notranslate nohighlight">\(\beta_{0s}\)</span> nella popolazione)</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\gamma_1\)</span></p></td>
<td><p>Fissa</p></td>
<td><p>Pendenza generale (media di <span class="math notranslate nohighlight">\(\beta_{1s}\)</span> nella popolazione)</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(S_{0s}\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Effetto random di intercetta per il soggetto <span class="math notranslate nohighlight">\(s\)</span></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(S_{1s}\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Effetto random di pendenza per il soggetto <span class="math notranslate nohighlight">\(s\)</span></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\mathbf{\Sigma}\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Matrice di varianza-covarianza</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\({\tau_{00}}^2\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Varianza degli effetti random di intercetta</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\rho\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Correlazione tra intercetta e pendenza</p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\({\tau_{11}}^2\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Varianza degli effetti random di pendenza</p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(\sigma^2\)</span></p></td>
<td><p>Casuale</p></td>
<td><p>Varianza dell’errore</p></td>
</tr>
</tbody>
</table>
<section id="spiegazione-delle-categorie-di-variabili-nel-modello-multilivello">
<h4><span class="section-number">17.4.4.1. </span>Spiegazione delle Categorie di Variabili nel Modello Multilivello<a class="headerlink" href="#spiegazione-delle-categorie-di-variabili-nel-modello-multilivello" title="Link to this heading">#</a></h4>
<p>Nella tabella delle variabili del modello multilivello, utilizziamo tre categorie specifiche per classificare le diverse variabili: <em>fisso</em>, <em>casuale</em> e <em>derivato</em>. Queste categorie ci aiutano a comprendere il ruolo e la natura di ciascuna variabile all’interno del modello:</p>
<section id="variabili-fisse">
<h5><span class="section-number">17.4.4.1.1. </span>Variabili Fisse<a class="headerlink" href="#variabili-fisse" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><strong>Definizione</strong>: Le variabili fisse sono quelle che assumiamo costanti attraverso il campione e la popolazione. Sono parametri che rappresentano le caratteristiche generali della popolazione da cui il campione è tratto.</p></li>
<li><p><strong>Esempi</strong>: Nella tabella, <span class="math notranslate nohighlight">\(\gamma_0\)</span> (intercetta generale) e <span class="math notranslate nohighlight">\(\gamma_1\)</span> (pendenza generale) sono variabili fisse.</p></li>
<li><p><strong>Ruolo nel Modello</strong>: Riflettono le tendenze centrali o gli effetti medi nella popolazione oggetto di studio.</p></li>
</ul>
</section>
<section id="variabili-casuali">
<h5><span class="section-number">17.4.4.1.2. </span>Variabili Casuali<a class="headerlink" href="#variabili-casuali" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><strong>Definizione</strong>: Le variabili casuali indicano i parametri che possono variare tra i soggetti o altre unità di analisi. Questi parametri sono concepiti come estratti da una distribuzione più ampia.</p></li>
<li><p><strong>Esempi</strong>: <span class="math notranslate nohighlight">\(S_{0s}\)</span> (intercetta casuale per soggetto) e <span class="math notranslate nohighlight">\(S_{1s}\)</span> (pendenza casuale per soggetto) sono esempi di variabili casuali.</p></li>
<li><p><strong>Ruolo nel Modello</strong>: Consentono di modellare e comprendere la varianza e la covarianza all’interno del campione, riflettendo la variabilità individuale o di gruppo.</p></li>
</ul>
</section>
<section id="variabili-derivate">
<h5><span class="section-number">17.4.4.1.3. </span>Variabili Derivate<a class="headerlink" href="#variabili-derivate" title="Link to this heading">#</a></h5>
<ul class="simple">
<li><p><strong>Definizione</strong>: ‘Derivato’ non è un termine standard nella modellistica statistica, ma lo utilizziamo qui per distinguere le variabili che non sono direttamente stimabili, ma piuttosto calcolate o derivate da altre variabili nel modello.</p></li>
<li><p><strong>Esempi</strong>: <span class="math notranslate nohighlight">\(\beta_{0s}\)</span> (intercetta di livello 1 per soggetto) e <span class="math notranslate nohighlight">\(\beta_{1s}\)</span> (pendenza di livello 1 per soggetto) sono variabili derivate, calcolate combinando variabili fisse e casuali.</p></li>
<li><p><strong>Ruolo nel Modello</strong>: Le variabili derivate rappresentano i parametri specifici per ciascun soggetto o unità di analisi, derivati dalla combinazione delle influenze fisse e casuali.</p></li>
</ul>
<p>In conclusione, il modello misto permette di tenere conto della variazione sia a livello di popolazione sia a livello individuale. Questa capacità di distinguere tra variazioni generali e specifiche dei soggetti è cruciale in molte situazioni, come quando si analizzano effetti di trattamenti o condizioni sperimentali diverse su gruppi di soggetti.</p>
</section>
</section>
</section>
</section>
<section id="stimare-i-parametri-del-modello">
<h2><span class="section-number">17.5. </span>Stimare i parametri del modello<a class="headerlink" href="#stimare-i-parametri-del-modello" title="Link to this heading">#</a></h2>
<p>Per stimare i parametri del modello usando R, utilizzeremo la funzione <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> del pacchetto <code class="docutils literal notranslate"><span class="pre">lme4</span></code> <span id="id3">Bates <em>et al.</em> [<a class="reference internal" href="../z_biblio.html#id13" title="Douglas Bates, Martin Mächler, Ben Bolker, and Steve Walker. Fitting linear mixed-effects models using lme4. arXiv preprint arXiv:1406.5823, 2014.">BMachlerBW14</a>]</span>. Questa funzione permette di specificare sia i fattori fissi (come i giorni di deprivazione del sonno) sia i fattori casuali (come i soggetti), ottenendo un modello che bilancia efficacemente le informazioni individuali con quelle aggregate.</p>
<p>La sintassi base di <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> è la seguente:</p>
<div class="math notranslate nohighlight">
\[ \text{lmer(formula, data, ...)}, \]</div>
<p>dove formula esprime la struttura del modello sottostante in un formato compatto e data è il data frame in cui si trovano le variabili menzionate nella formula.</p>
<p>Il formato generale della formula del modello per N effetti fissi (fix) e K effetti casuali (ran) è:</p>
<div class="math notranslate nohighlight">
\[ \text{DV ~ fix1 + fix2 + ... + fixN + (ran1 + ran2 + ... + ranK | random\_factor1)} \]</div>
<p>Le interazioni tra i fattori A e B possono essere specificate utilizzando sia A * B (interazione ed effetti principali) che A:B (solo l’interazione).</p>
<p>Una differenza chiave dalla sintassi standard dei modelli R è la presenza di un termine di effetto casuale, racchiuso tra parentesi, ad esempio <code class="docutils literal notranslate"><span class="pre">(ran1</span> <span class="pre">+</span> <span class="pre">ran2</span> <span class="pre">+</span> <span class="pre">...</span> <span class="pre">+</span> <span class="pre">ranK</span> <span class="pre">|</span> <span class="pre">random_factor)</span></code>. Ogni espressione tra parentesi rappresenta gli effetti casuali associati a un singolo fattore casuale. È possibile avere più di un termine di effetti casuali in una singola formula (fattori casuali incrociati). I termini relativi agli effetti casuali forniscono istruzioni a <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> su come costruire le matrici di varianza-covarianza.</p>
<p>Sul lato sinistro della barra <code class="docutils literal notranslate"><span class="pre">|</span></code> vengono elencati gli effetti che vogliamo fare variare tra i livelli del fattore casuale indicato sul lato destro. Di solito, la variabile sul lato destro è una variabile che identifica i soggetti (ad esempio, <code class="docutils literal notranslate"><span class="pre">subject_id</span></code>).</p>
<p>Consideriamo le seguenti possibili formule di modello per i dati <code class="docutils literal notranslate"><span class="pre">sleep2</span></code> e le matrici di varianza-covarianza che esse costruiscono.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>model</p></th>
<th class="head"><p>syntax</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>1. random intercepts only</p></td>
<td><p>Reaction ~ days_deprived + (1 | Subject)</p></td>
</tr>
<tr class="row-odd"><td><p>2. random intercepts and slopes</p></td>
<td><p>Reaction ~ days_deprived + (1 + days_deprived | Subject)</p></td>
</tr>
<tr class="row-even"><td><p>3. model 2 alternate syntax</p></td>
<td><p>Reaction ~ days_deprived + (days_deprived | Subject)</p></td>
</tr>
<tr class="row-odd"><td><p>4. random slopes only</p></td>
<td><p>Reaction ~ days_deprived + (0 + days_deprived | Subject)</p></td>
</tr>
<tr class="row-even"><td><p>5. model 2 + zero-covariances</p></td>
<td><p>Reaction ~ days_deprived + (days_deprived || Subject)</p></td>
</tr>
</tbody>
</table>
<p>Modello 1:</p>
<div class="math notranslate nohighlight">
\[\begin{split} \mathbf{\Sigma} =
\begin{pmatrix}
\tau_{00}^2 &amp; 0 \\
0 &amp; 0
\end{pmatrix}
\end{split}\]</div>
<p>Modelli 2 e 3:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{\Sigma} =
\begin{pmatrix}
\tau_{00}^2 &amp; \rho \tau_{00} \tau_{11} \\
\rho \tau_{00} \tau_{11} &amp; \tau_{11}^2
\end{pmatrix}
\end{split}\]</div>
<p>Modello 4:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{\Sigma} =
\begin{pmatrix}
0 &amp; 0 \\
0 &amp; \tau_{11}^2
\end{pmatrix}
\end{split}\]</div>
<p>Modello 5:</p>
<div class="math notranslate nohighlight">
\[\begin{split}  \mathbf{\Sigma} =
\begin{pmatrix}
\tau_{00}^2 &amp; 0 \\
0 &amp; \tau_{11}^2
\end{pmatrix}
\end{split}\]</div>
<p>Il modello più ragionevole per i dati dell’esempio è il Modello 2, quindi useremo quello.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">pp_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lmer</span><span class="p">(</span>
<span class="w">    </span><span class="n">Reaction</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">days_deprived</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">days_deprived</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Subject</span><span class="p">),</span><span class="w"> </span>
<span class="w">    </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sleep2</span>
<span class="p">)</span>

<span class="nf">summary</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Linear mixed model fit by REML [&#39;lmerMod&#39;]
Formula: Reaction ~ 1 + days_deprived + (1 + days_deprived | Subject)
   Data: sleep2

REML criterion at convergence: 1404.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-4.0157 -0.3541  0.0069  0.4681  5.0732 

Random effects:
 Groups   Name          Variance Std.Dev. Corr
 Subject  (Intercept)   958.35   30.957       
          days_deprived  45.78    6.766   0.18
 Residual               651.60   25.526       
Number of obs: 144, groups:  Subject, 18

Fixed effects:
              Estimate Std. Error t value
(Intercept)    267.967      8.266  32.418
days_deprived   11.435      1.845   6.197

Correlation of Fixed Effects:
            (Intr)
days_deprvd -0.062
</pre></div>
</div>
</div>
</div>
<p>Prima di discutere come interpretare l’output, iniziamo col rappresentare graficamente i dati rispetto alle previsioni del nostro modello. Possiamo ottenere le previsioni del modello utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">predict()</span></code> (vedi <code class="docutils literal notranslate"><span class="pre">?predict.merMod</span></code> per informazioni sull’uso con modelli a effetti misti).</p>
<p>Per prima cosa, creaiamo un nuovo dataframe con i valori dei predittori per <code class="docutils literal notranslate"><span class="pre">Subject</span></code> e <code class="docutils literal notranslate"><span class="pre">days_deprived</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">newdata</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">crossing</span><span class="p">(</span>
<span class="w">    </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sleep2</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">pull</span><span class="p">(</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">levels</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">factor</span><span class="p">(),</span>
<span class="w">    </span><span class="n">days_deprived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">7</span>
<span class="p">)</span>

<span class="nf">head</span><span class="p">(</span><span class="n">newdata</span><span class="p">,</span><span class="w"> </span><span class="m">17</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 17 × 2</caption>
<thead>
	<tr><th scope=col>Subject</th><th scope=col>days_deprived</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>308</td><td>0</td></tr>
	<tr><td>308</td><td>1</td></tr>
	<tr><td>308</td><td>2</td></tr>
	<tr><td>308</td><td>3</td></tr>
	<tr><td>308</td><td>4</td></tr>
	<tr><td>308</td><td>5</td></tr>
	<tr><td>308</td><td>6</td></tr>
	<tr><td>308</td><td>7</td></tr>
	<tr><td>309</td><td>0</td></tr>
	<tr><td>309</td><td>1</td></tr>
	<tr><td>309</td><td>2</td></tr>
	<tr><td>309</td><td>3</td></tr>
	<tr><td>309</td><td>4</td></tr>
	<tr><td>309</td><td>5</td></tr>
	<tr><td>309</td><td>6</td></tr>
	<tr><td>309</td><td>7</td></tr>
	<tr><td>310</td><td>0</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Il codice precedente crea un nuovo data frame chiamato <code class="docutils literal notranslate"><span class="pre">newdata</span></code> utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">crossing()</span></code> da <code class="docutils literal notranslate"><span class="pre">dplyr</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Subject</span> <span class="pre">=</span> <span class="pre">sleep2</span> <span class="pre">|&gt;</span> <span class="pre">pull(Subject)</span> <span class="pre">|&gt;</span> <span class="pre">levels()</span> <span class="pre">|&gt;</span> <span class="pre">factor()</span></code>: Questa parte del codice estrae la colonna “Subject” dal data frame “sleep2”, quindi applica una serie di operazioni successive utilizzando l’operatore <code class="docutils literal notranslate"><span class="pre">|&gt;</span></code> (pipe) per manipolare i dati nella colonna.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sleep2</span> <span class="pre">|&gt;</span> <span class="pre">pull(Subject)</span></code>: Inizia estraendo la colonna “Subject” dal data frame “sleep2”.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">levels()</span></code>: Successivamente, applica la funzione “levels()” per ottenere i livelli unici della colonna “Subject”. Questo è utile quando si ha a che fare con variabili categoriche (come un “factor”).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">factor()</span></code>: Infine, trasforma i livelli ottenuti in un “factor”. Questo è importante perché la funzione “crossing()” richiede che le variabili categoriche siano di tipo “factor”.</p></li>
</ul>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">days_deprived</span> <span class="pre">=</span> <span class="pre">0:7</span></code>: Questa parte del codice crea una nuova variabile chiamata “days_deprived” che contiene una sequenza da 0 a 7. Questo rappresenta i giorni di privazione.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">crossing(...)</span></code>: Infine, la funzione “crossing()” viene utilizzata per creare un nuovo data frame chiamato “newdata” combinando tutte le possibili combinazioni di valori tra la variabile “Subject” (con i suoi livelli unici) e la variabile “days_deprived” (con i valori da 0 a 7).</p></li>
</ol>
<p>Utilizziamo <code class="docutils literal notranslate"><span class="pre">predict()</span></code> per trovare le rette di regressione per ciascun soggetto.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">newdata2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Reaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Ora possiamo creare il grafico con le predizioni del modello.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">sleep2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_line</span><span class="p">(</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">newdata2</span><span class="p">,</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">7</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reaction Time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Days deprived of sleep (0 = baseline)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/75849048fde6d3f1a9452834035d09ac188c9e3def15c7e59cbbbd2c23cce223.png" src="../_images/75849048fde6d3f1a9452834035d09ac188c9e3def15c7e59cbbbd2c23cce223.png" />
</div>
</div>
</section>
<section id="interpretare-l-output-di-lmer-ed-estrarre-le-stime">
<h2><span class="section-number">17.6. </span>Interpretare l’output di <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> ed estrarre le stime<a class="headerlink" href="#interpretare-l-output-di-lmer-ed-estrarre-le-stime" title="Link to this heading">#</a></h2>
<p>La chiamata a <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> restituisce un oggetto della classe “lmerMod”.</p>
<section id="effetti-fissi">
<h3><span class="section-number">17.6.1. </span>Effetti fissi<a class="headerlink" href="#effetti-fissi" title="Link to this heading">#</a></h3>
<p>La sezione dell’output chiamata “Effetti fissi:” è simile a ciò che si vede nell’output per un modello lineare semplice adattato con <code class="docutils literal notranslate"><span class="pre">lm()</span></code>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Fixed</span> <span class="n">effects</span><span class="p">:</span>
              <span class="n">Estimate</span> <span class="n">Std</span><span class="o">.</span> <span class="n">Error</span> <span class="n">t</span> <span class="n">value</span>
<span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>    <span class="mf">267.967</span>      <span class="mf">8.266</span>  <span class="mf">32.418</span>
<span class="n">days_deprived</span>   <span class="mf">11.435</span>      <span class="mf">1.845</span>   <span class="mf">6.197</span>
</pre></div>
</div>
<p>L’output precedente indica che il tempo di reazione medio stimato per i partecipanti al Giorno 0 era di circa 268 millisecondi, con ogni giorno di privazione del sonno che aggiungeva mediamente ulteriori 11 millisecondi al tempo di risposta.</p>
<p>Se dobbiamo ottenere gli effetti fissi dal modello, possiamo estrarli utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">fixef()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">fixef</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (Intercept) days_deprived 
    267.96742      11.43543 
</pre></div>
</div>
</div>
</div>
<p>Gli errori standard ci forniscono stime della variabilità di questi parametri dovuta all’errore di campionamento. Possiamo utilizzarli per calcolare i valori <span class="math notranslate nohighlight">\(t\)</span> o derivare gli intervalli di confidenza. Per estrarli, utilizziamo <code class="docutils literal notranslate"><span class="pre">vcov(pp_mod)</span></code>, che restituirà una matrice di varianza-covarianza (non quella associata agli effetti casuali), quindi estraiamo la diagonale utilizzando <code class="docutils literal notranslate"><span class="pre">diag()</span></code> e calcoliamo infine la radice quadrata utilizzando <code class="docutils literal notranslate"><span class="pre">sqrt()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">vcov</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">diag</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">sqrt</span><span class="p">()</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (Intercept) days_deprived 
     8.265896      1.845293 
</pre></div>
</div>
</div>
</div>
<p>Si noti che, nell’output di <code class="docutils literal notranslate"><span class="pre">lmer</span></code>, i valori <span class="math notranslate nohighlight">\(t\)</span> non sono accompagnati dai valori <span class="math notranslate nohighlight">\(p\)</span>, come avviene di solito nei contesti di modellazione più semplici. Esistono molteplici approcci per ottenere i valori <span class="math notranslate nohighlight">\(p\)</span> da modelli a effetti misti, ciascuno con vantaggi e svantaggi (si veda, ad esempio, Luke (2017) per un’analisi delle opzioni disponibili). I valori <span class="math notranslate nohighlight">\(t\)</span> non vengono accompagnati dai gradi di libertà, poiché i gradi di libertà in un modello a effetti misti non sono ben definiti. Spesso i ricercatori trattano i valori <span class="math notranslate nohighlight">\(t\)</span> come valori <span class="math notranslate nohighlight">\(z\)</span> di Wald, ossia come osservazioni provenienti da una distribuzione normale standard. Poiché la distribuzione <span class="math notranslate nohighlight">\(t\)</span> si avvicina alla distribuzione normale standard all’aumentare del numero di osservazioni, questa pratica “t-as-z” è legittima se il numero di osservazioni campionarie è sufficientemente grande.</p>
<p>Per calcolare i valori <span class="math notranslate nohighlight">\(z\)</span> di Wald, basta dividere la stima dell’effetto fisso per il suo errore standard:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tvals</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">fixef</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nf">sqrt</span><span class="p">(</span><span class="nf">diag</span><span class="p">(</span><span class="nf">vcov</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)))</span>

<span class="n">tvals</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (Intercept) days_deprived 
    32.418437      6.197082 
</pre></div>
</div>
</div>
</div>
<p>I valori-<span class="math notranslate nohighlight">\(p\)</span> si ottengono nel modo seguente:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nf">pnorm</span><span class="p">(</span><span class="nf">abs</span><span class="p">(</span><span class="n">tvals</span><span class="p">))))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  (Intercept) days_deprived 
  0.00000e+00   5.75197e-10 
</pre></div>
</div>
</div>
</div>
<p>Questo fornisce una forte evidenza contro l’ipotesi nulla <span class="math notranslate nohighlight">\(H_0: \gamma_1 = 0\)</span>. Sembra che la privazione del sonno aumenti effettivamente il tempo di risposta.</p>
<p>È possibile ottenere gli intervalli di confidenza per le stime utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">confint()</span></code> (questa tecnica utilizza il bootstrap parametrico).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">confint</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Computing profile confidence intervals ...
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                    2.5 %      97.5 %
.sig01         19.0980993  46.3366669
.sig02         -0.4051075   0.8059258
.sig03          4.0079284  10.2487353
.sigma         22.4666029  29.3494508
(Intercept)   251.3443396 284.5904989
days_deprived   7.7245247  15.1463328
</pre></div>
</div>
</div>
</div>
</section>
<section id="effetti-random">
<h3><span class="section-number">17.6.2. </span>Effetti random<a class="headerlink" href="#effetti-random" title="Link to this heading">#</a></h3>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Random</span> <span class="n">effects</span><span class="p">:</span>
 <span class="n">Groups</span>   <span class="n">Name</span>          <span class="n">Variance</span> <span class="n">Std</span><span class="o">.</span><span class="n">Dev</span><span class="o">.</span> <span class="n">Corr</span>
 <span class="n">Subject</span>  <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>   <span class="mf">958.35</span>   <span class="mf">30.957</span>       
          <span class="n">days_deprived</span>  <span class="mf">45.78</span>    <span class="mf">6.766</span>   <span class="mf">0.18</span>
 <span class="n">Residual</span>               <span class="mf">651.60</span>   <span class="mf">25.526</span>       
<span class="n">Number</span> <span class="n">of</span> <span class="n">obs</span><span class="p">:</span> <span class="mi">144</span><span class="p">,</span> <span class="n">groups</span><span class="p">:</span>  <span class="n">Subject</span><span class="p">,</span> <span class="mi">18</span>
</pre></div>
</div>
<p>La parte relativa agli effetti casuali dell’output di <code class="docutils literal notranslate"><span class="pre">summary()</span></code> ci fornisce una tabella con informazioni sulle diverse componenti della varianza: la matrice di varianza-covarianza (o matrici, se ci sono più fattori casuali) e la varianza residua.</p>
<p>Cominciamo con la riga <code class="docutils literal notranslate"><span class="pre">Residual</span></code>. Questo ci indica che la varianza residua, <span class="math notranslate nohighlight">\(\sigma^2\)</span>, è stata stimata a circa 651.6. Il valore nella colonna successiva, 25.526, è la deviazione standard, <span class="math notranslate nohighlight">\(\sigma\)</span>, che è la radice quadrata della varianza.</p>
<p>Estraiamo la deviazione standard residua utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">sigma()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">sigma</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span><span class="w"> </span><span class="c1"># residual</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">25.526404577851</div></div>
</div>
<p>Le due righe sopra la riga Residual ci forniscono informazioni sulla matrice di varianza-covarianza per il fattore casuale “Subject”.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Random</span> <span class="n">effects</span><span class="p">:</span>
 <span class="n">Groups</span>   <span class="n">Name</span>          <span class="n">Variance</span> <span class="n">Std</span><span class="o">.</span><span class="n">Dev</span><span class="o">.</span> <span class="n">Corr</span>
 <span class="n">Subject</span>  <span class="p">(</span><span class="n">Intercept</span><span class="p">)</span>   <span class="mf">958.35</span>   <span class="mf">30.957</span>       
          <span class="n">days_deprived</span>  <span class="mf">45.78</span>    <span class="mf">6.766</span>   <span class="mf">0.18</span>
</pre></div>
</div>
<p>I valori nella colonna “Variance” ci forniscono la diagonale principale della matrice, mentre i valori nella colonna “Std.Dev.” rappresentano semplicemente le radici quadrate di questi valori. La colonna “Corr” indica la correlazione tra l’intercetta e la pendenza.</p>
<p>Possiamo estrarre questi valori dall’oggetto adattato <code class="docutils literal notranslate"><span class="pre">pp_mod</span></code> utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">VarCorr()</span></code>. Questa funzione restituisce una lista nominata, con un elemento per ciascun fattore casuale. Nel nostro caso, “Subject” è l’unico fattore casuale, quindi la lista avrà lunghezza 1.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># variance-covariance matrix for random factor Subject</span>
<span class="nf">VarCorr</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)[[</span><span class="s">&quot;Subject&quot;</span><span class="p">]]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span><span class="w"> </span><span class="c1"># oppure: VarCorr(pp_mod)[[1]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>              (Intercept) days_deprived
(Intercept)      958.3517      37.20460
days_deprived     37.2046      45.77766
attr(,&quot;stddev&quot;)
  (Intercept) days_deprived 
    30.957255      6.765919 
attr(,&quot;correlation&quot;)
              (Intercept) days_deprived
(Intercept)     1.0000000     0.1776263
days_deprived   0.1776263     1.0000000
</pre></div>
</div>
</div>
</div>
<p>Le prime righe rappresentano la matrice di varianza-covarianza. Le varianze sono riportate sulla diagonale principale. <code class="docutils literal notranslate"><span class="pre">correlation</span></code> indica la correlazione tra la stima della pendenza e la stima dell’intercetta.</p>
<p>Possiamo estrarre gli effetti casuali stimati (BLUPS) utilizzando la funzione <code class="docutils literal notranslate"><span class="pre">ranef()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ranef</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)[[</span><span class="s">&quot;Subject&quot;</span><span class="p">]]</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    (Intercept) days_deprived
308  24.4992891     8.6020000
309 -59.3723102    -8.1277534
310 -39.4762764    -7.4292365
330   1.3500428    -2.3845976
331  18.4576169    -3.7477340
332  30.5270040    -4.8936899
333  13.3682027     0.2888639
334 -18.1583020     3.8436686
335 -16.9737887   -12.0702333
337  44.5850842    10.1760837
349 -26.6839022     2.1946699
350  -5.9657957     8.1758613
351  -5.5710355    -2.3718494
352  46.6347253    -0.5616377
369   0.9616395     1.7385130
370 -18.5216778     5.6317534
371  -7.3431320     0.2729282
372  17.6826159     0.6623897
</pre></div>
</div>
</div>
</div>
<p>Possiamo ottenere i valori stimati dal modello utilizzando <code class="docutils literal notranslate"><span class="pre">fitted()</span></code> e i residui utilizzando <code class="docutils literal notranslate"><span class="pre">residuals()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">mutate</span><span class="p">(</span><span class="n">sleep2</span><span class="p">,</span>
<span class="w">    </span><span class="n">fit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">fitted</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">),</span>
<span class="w">    </span><span class="n">resid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">residuals</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">)</span>
<span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">group_by</span><span class="p">(</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">slice</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">10</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">print</span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">+</span><span class="kc">Inf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span># A tibble: 18 × 6
# Groups:   Subject [18]
   Reaction  Days Subject days_deprived   fit  resid
      &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;           &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1     251.     2 308                 0  292. -<span class=" -Color -Color-Red">41.7</span> 
 2     203.     2 309                 0  209.  -<span class=" -Color -Color-Red">5.62</span>
 3     234.     2 310                 0  228.   5.83
 4     284.     2 330                 0  269.  14.5 
 5     302.     2 331                 0  286.  15.4 
 6     273.     2 332                 0  298. -<span class=" -Color -Color-Red">25.5</span> 
 7     277.     2 333                 0  281.  -<span class=" -Color -Color-Red">4.57</span>
 8     243.     2 334                 0  250.  -<span class=" -Color -Color-Red">6.44</span>
 9     254.     2 335                 0  251.   3.50
10     292.     2 337                 0  313. -<span class=" -Color -Color-Red">20.9</span> 
11     239.     2 349                 0  241.  -<span class=" -Color -Color-Red">2.36</span>
12     256.     2 350                 0  262.  -<span class=" -Color -Color-Red">5.80</span>
13     270.     2 351                 0  262.   7.50
14     327.     2 352                 0  315.  12.3 
15     257.     2 369                 0  269. -<span class=" -Color -Color-Red">11.7</span> 
16     239.     2 370                 0  249. -<span class=" -Color -Color-Red">10.5</span> 
17     278.     2 371                 0  261.  17.3 
18     298.     2 372                 0  286.  11.9 
</pre></div>
</div>
</div>
</div>
<p>Infine, possiamo ottenere previsioni per nuovi dati utilizzando <code class="docutils literal notranslate"><span class="pre">predict()</span></code>, come abbiamo fatto in precedenza.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1">## create the table with new predictor values</span>
<span class="n">ndat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">crossing</span><span class="p">(</span>
<span class="w">    </span><span class="n">Subject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">sleep2</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">pull</span><span class="p">(</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">levels</span><span class="p">()</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span><span class="nf">factor</span><span class="p">(),</span>
<span class="w">    </span><span class="n">days_deprived</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">8</span><span class="o">:</span><span class="m">10</span>
<span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="nf">mutate</span><span class="p">(</span><span class="n">Reaction</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">predict</span><span class="p">(</span><span class="n">pp_mod</span><span class="p">,</span><span class="w"> </span><span class="n">newdata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="p">))</span>

<span class="n">ndat</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">    </span><span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 3</caption>
<thead>
	<tr><th scope=col>Subject</th><th scope=col>days_deprived</th><th scope=col>Reaction</th></tr>
	<tr><th scope=col>&lt;fct&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;dbl&gt;</th></tr>
</thead>
<tbody>
	<tr><td>308</td><td> 8</td><td>452.7661</td></tr>
	<tr><td>308</td><td> 9</td><td>472.8036</td></tr>
	<tr><td>308</td><td>10</td><td>492.8410</td></tr>
	<tr><td>309</td><td> 8</td><td>235.0565</td></tr>
	<tr><td>309</td><td> 9</td><td>238.3642</td></tr>
	<tr><td>309</td><td>10</td><td>241.6719</td></tr>
</tbody>
</table>
</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">ggplot</span><span class="p">(</span><span class="n">sleep2</span><span class="p">,</span><span class="w"> </span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">days_deprived</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reaction</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_line</span><span class="p">(</span>
<span class="w">        </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">bind_rows</span><span class="p">(</span><span class="n">newdata2</span><span class="p">,</span><span class="w"> </span><span class="n">ndat</span><span class="p">),</span>
<span class="w">        </span><span class="n">color</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;blue&quot;</span>
<span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="o">:</span><span class="m">10</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">Subject</span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">    </span><span class="nf">labs</span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Reaction Time&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Days deprived of sleep (0 = baseline)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3486759bf870f12a546170192c92f0d38e008120bf5e0b38de100b845f31d260.png" src="../_images/3486759bf870f12a546170192c92f0d38e008120bf5e0b38de100b845f31d260.png" />
</div>
</div>
</section>
</section>
<section id="considerazioni-conclusive">
<h2><span class="section-number">17.7. </span>Considerazioni Conclusive<a class="headerlink" href="#considerazioni-conclusive" title="Link to this heading">#</a></h2>
<p>Il presente capitolo presenta un’analisi approfondita dei modelli statistici multilivello discutendo l’esempio relativo all’effetto della deprivazione del sonno sulle prestazioni psicomotorie. Utilizzando il dataset <code class="docutils literal notranslate"><span class="pre">sleepstudy</span></code>, abbiamo introdotto concetti chiave quali “complete pooling”, “no pooling” e “partial pooling”. Questi approcci sono stati esplorati per evidenziare le loro implicazioni nella modellazione dei dati che contengono misure ripetute.</p>
<p>L’analisi si focalizza sull’applicazione pratica dei modelli multilivello, dettagliando le variabili fisse e casuali e la loro importanza nel contesto dei modelli. È stata posta particolare enfasi sulla matrice di varianza-covarianza, essenziale per comprendere le relazioni all’interno dei modelli multilivello.</p>
<p>I modelli multilivello sono di vitale importanza per l’assessment psicologico e la psicometria, in quanto permettono di analizzare dati complessi tenendo conto delle variazioni individuali e di gruppo. Questi modelli forniscono strumenti flessibili per esaminare l’influenza di fattori contestuali e individuali sul comportamento e le prestazioni psicologiche, un aspetto cruciale nell’assessment psicologico.</p>
<p>Il capitolo anticipa l’utilizzo dei modelli multilivello nel calcolo dell’affidabilità tra giudici, un tema che sarà approfondito nel capitolo successivo. Inoltre, i modelli multilivello sono presentati come un’introduzione o un’alternativa ai modelli di crescita latente, che verranno esplorati nei capitoli successivi. Questo collegamento sottolinea la continuità e l’importanza di tali modelli nell’ambito più ampio della ricerca psicologica e psicometrica.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./_raters"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../_ctt/E2_item_analyses.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">16. </span>✏️ Esercizi</p>
      </div>
    </a>
    <a class="right-next"
       href="02_interrater_reliability.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">18. </span>L’affidabilità tra giudici</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduzione">17.1. Introduzione</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descrizione-del-disegno-sperimentale">17.1.1. Descrizione del Disegno Sperimentale</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#preparazione-dei-dati">17.1.2. Preparazione dei Dati</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisi-della-relazione-tra-tempo-di-reazione-e-privazione-del-sonno">17.1.3. Analisi della Relazione tra Tempo di Reazione e Privazione del Sonno</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#complete-pooling">17.2. Complete pooling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caratteristiche-del-complete-pooling">17.2.1. Caratteristiche del Complete Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#limitazioni-dell-approccio-di-complete-pooling">17.2.2. Limitazioni dell’Approccio di Complete Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-di-regressione-lineare-in-complete-pooling">17.2.3. Modello di Regressione Lineare in Complete Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementazione-in-r">17.2.4. Implementazione in R</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-del-modello-di-regressione-e-visualizzazione-grafica">17.2.5. Interpretazione del Modello di Regressione e Visualizzazione Grafica</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-sui-limiti-del-modello">17.2.5.1. Considerazioni sui Limiti del Modello</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#aggiunta-delle-previsioni-al-grafico">17.2.5.2. Aggiunta delle Previsioni al Grafico</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approccio-di-no-pooling">17.3. Approccio di No Pooling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#caratteristiche-del-no-pooling">17.3.1. Caratteristiche del No Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementazione-del-modello-di-no-pooling">17.3.2. Implementazione del Modello di No Pooling</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#verifica-del-fattore-subject">17.3.3. Verifica del Fattore <code class="docutils literal notranslate"><span class="pre">Subject</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#approccio-di-partial-pooling">17.4. Approccio di Partial Pooling</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#implementazione-dei-modelli-a-effetti-misti">17.4.1. Implementazione dei Modelli a Effetti Misti</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#articolazione-e-applicazione-del-modello-multilivello">17.4.2. Articolazione e Applicazione del Modello Multilivello</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#livello-1-modellazione-della-relazione-individuale">17.4.2.1. Livello 1: Modellazione della Relazione Individuale</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#livello-2-modellazione-delle-variazioni-tra-soggetti">17.4.2.2. Livello 2: Modellazione delle Variazioni Tra Soggetti</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#componenti-di-varianza">17.4.2.3. Componenti di Varianza</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-complessiva-del-modello">17.4.2.4. Interpretazione Complessiva del Modello</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretazione-degli-effetti-fissi-e-casuali">17.4.2.5. Interpretazione degli Effetti Fissi e Casuali</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#uso-di-campioni-per-informare-sulla-popolazione">17.4.2.6. Uso di Campioni per Informare sulla Popolazione</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#spiegazione-della-matrice-di-varianza-covarianza-nel-modello-multilivello">17.4.3. Spiegazione della Matrice di Varianza-Covarianza nel Modello Multilivello</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#componenti-della-matrice">17.4.3.1. Componenti della Matrice</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#significato-e-importanza-di-sigma">17.4.3.2. Significato e Importanza di <span class="math notranslate nohighlight">\(\Sigma\)</span></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tabella-delle-variabili">17.4.4. Tabella delle Variabili</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#spiegazione-delle-categorie-di-variabili-nel-modello-multilivello">17.4.4.1. Spiegazione delle Categorie di Variabili nel Modello Multilivello</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#variabili-fisse">17.4.4.1.1. Variabili Fisse</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#variabili-casuali">17.4.4.1.2. Variabili Casuali</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#variabili-derivate">17.4.4.1.3. Variabili Derivate</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stimare-i-parametri-del-modello">17.5. Stimare i parametri del modello</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretare-l-output-di-lmer-ed-estrarre-le-stime">17.6. Interpretare l’output di <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> ed estrarre le stime</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effetti-fissi">17.6.1. Effetti fissi</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#effetti-random">17.6.2. Effetti random</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-conclusive">17.7. Considerazioni Conclusive</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>