

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>29. Dati longitudinali &#8212; cfa_book</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '321_lgm_prelims';</script>
    <link rel="shortcut icon" href="_static/increasing.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="30. LGM e modelli misti" href="324_lgm_mixed.html" />
    <link rel="prev" title="28. Curve di crescita latente" href="320_lgm_intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Modello lineare</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="05_intro_r.html">1. Linguaggio di programmazione R</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_regression.html">2. L’analisi di regressione</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria classica dei test</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="035_ctt.html">3. Fondamenti teorici</a></li>
<li class="toctree-l1"><a class="reference internal" href="037_err_std_mis.html">4. L’errore standard della misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="038_err_std_stima.html">5. La stima del punteggio vero</a></li>
<li class="toctree-l1"><a class="reference internal" href="040_exercises_ctt.html">6. Applicazioni della CTT</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi fattoriale</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="050_sviluppo_strumento.html">7. Utilizzo e costruzione di test psicometrici</a></li>
<li class="toctree-l1"><a class="reference internal" href="055_analisi_fattoriale_1.html">8. Il modello unifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="056_analisi_fattoriale_2.html">9. Il modello statistico dell’analisi fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="057_analisi_fattoriale_3.html">10. Il modello multifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="058_factor_scores.html">11. I punteggi fattoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="060_path_analysis.html">12. Visualizzare i modelli di equazioni strutturali</a></li>
<li class="toctree-l1"><a class="reference internal" href="062_constraints_on_parms.html">13. Attendibilità e modello fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="070_cfa_mod_comp.html">14. CFA: confronto tra modelli</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Costruzione di strumenti psicometrici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="200_problema_strumento.html">15. Tipologie dei test psicometrici</a></li>
<li class="toctree-l1"><a class="reference internal" href="201_valutare_le_matrici.html">16. Valutazione della matrice di correlazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="202_estrazione.html">17. L’estrazione dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="203_numero_fattori.html">18. Il numero dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="205_rotazione.html">19. La rotazione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="206_valutare_sol_fattoriale.html">20. Valutare e rifinire la soluzione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="250_group_invariance.html">21. Invarianza di misura</a></li>
<li class="toctree-l1"><a class="reference internal" href="300_gof.html">22. Indici di bontà dell’adattamento</a></li>
<li class="toctree-l1"><a class="reference internal" href="310_refine_solution.html">23. La revisione del modello</a></li>
<li class="toctree-l1"><a class="reference internal" href="315_mmm.html">24. CFA per matrici multi-tratto multi-metodo</a></li>
<li class="toctree-l1"><a class="reference internal" href="500_cat_data.html">25. Dati non gaussiani e categoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="501_missing_data.html">26. Dati mancanti</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli di equazioni strutturali</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="316_sem_intro.html">27. Introduzione ai modelli di equazioni struttural</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Curve di crescita latente</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="320_lgm_intro.html">28. Curve di crescita latente</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">29. Dati longitudinali</a></li>
<li class="toctree-l1"><a class="reference internal" href="324_lgm_mixed.html">30. LGM e modelli misti</a></li>
<li class="toctree-l1"><a class="reference internal" href="326_growth_1.html">31. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="327_growth_cont.html">32. Il tempo su una metrica continua</a></li>
<li class="toctree-l1"><a class="reference internal" href="328_time_inv_cov.html">33. Covariate indipendenti dal tempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="329_growth_groups.html">34. Modelli di crescita latenti a gruppi multipli</a></li>
<li class="toctree-l1"><a class="reference internal" href="330_bivariate_growth_models.html">35. Modelli di crescita latenti bivariati</a></li>
<li class="toctree-l1"><a class="reference internal" href="331_inv_measurement.html">36. Invarianza di misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="332_latent_change.html">37. Modello LCS univariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="333_biv_change.html">38. Modello LCS bivariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="351_lgm_meas_inv.html">39. Invarianza fattoriale nei modelli LGM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliografia</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="z_biblio.html">40. Bibliografia</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="900_lin_alg.html">41. Elementi di algebra lineare</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ccaudek/cfa_book_2023" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ccaudek/cfa_book_2023/issues/new?title=Issue%20on%20page%20%2F321_lgm_prelims.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/321_lgm_prelims.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Dati longitudinali</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-preliminari">29.1. Considerazioni preliminari</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strutture-dei-dati">29.2. Strutture dei dati</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizzazione-dei-dati-longitudinali">29.3. Visualizzazione dei dati longitudinali</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-screening">29.4. Data screening</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attendibilita">29.5. Attendibilità</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisi-con-lmer">29.5.1. Analisi con <code class="docutils literal notranslate"><span class="pre">lmer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formulazione-del-modello">29.5.2. Formulazione del modello</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invarianza-di-misurazione">29.6. Invarianza di misurazione</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="dati-longitudinali">
<span id="lgm-prelims-notebook"></span><h1><span class="section-number">29. </span>Dati longitudinali<a class="headerlink" href="#dati-longitudinali" title="Permalink to this headline">#</a></h1>
<section id="considerazioni-preliminari">
<h2><span class="section-number">29.1. </span>Considerazioni preliminari<a class="headerlink" href="#considerazioni-preliminari" title="Permalink to this headline">#</a></h2>
<p>I modelli di crescita latente (<em>Linear Growth Models</em>, LGN), noti anche come modelli di analisi dei dati longitudinali, vengono utilizzati per studiare il cambiamento nel tempo attraverso l’analisi di dati ripetuti ottenuti da molteplici individui. La ricerca psicologica mira a comprendere come le persone differiscono nei loro pensieri, sentimenti e comportamenti nel tempo e nello spazio e a descrivere queste differenze in modo accurato e completo.</p>
<p>Tradizionalmente, gli studi longitudinali sono stati condotti con un numero relativamente basso di valutazioni ripetute (meno di 8) e un numero elevato di individui (più di 200). Tuttavia, i progressi nelle teorie del cambiamento, che includono considerazioni non lineari, e nella tecnologia di raccolta dati, come i sondaggi basati sul web e gli smartphone, hanno notevolmente ampliato le possibilità di raccogliere e analizzare dati longitudinali. In particolare, <span id="id1">Grimm <em>et al.</em> [<a class="reference internal" href="z_biblio.html#id8" title="Kevin J Grimm, Nilam Ram, and Ryne Estabrook. Growth modeling: Structural equation and multilevel modeling approaches. Guilford Publications, 2016.">GRE16</a>]</span> hanno discusso l’applicazione di modelli di crescita a dati longitudinali di grandi dimensioni, comprendenti fino a 50.000 individui e 1.000 valutazioni ripetute.</p>
</section>
<section id="strutture-dei-dati">
<h2><span class="section-number">29.2. </span>Strutture dei dati<a class="headerlink" href="#strutture-dei-dati" title="Permalink to this headline">#</a></h2>
<p>I dati longitudinali tipicamente si presentano in due forme: <em>long</em> e <em>wide</em>. Nel formato <em>long</em>, la descrizione del tempo è sulle righe; nel formato <em>wide</em> le variabili relative ad ogni occasione temporale sono organizzate in colonne. È possibile trasformere i dati dal formato <em>long</em> in formato <em>wide</em> e viceversa usando le funzioni R <code class="docutils literal notranslate"><span class="pre">pivot_wider()</span></code> e <code class="docutils literal notranslate"><span class="pre">pivot_longer()</span></code>. La sintassi è spiegata nella pagina web <a class="reference external" href="https://tidyr.tidyverse.org/reference/pivot_wider.html">tidyr</a>.</p>
<p>Per fare un esempio, esaminiamo il cambiamento nel rendimento in matematica dei bambini durante la scuola elementare e media utilizzando il set di dati NLSY-CYA. Questi dati sono stati analizzati da <span id="id2">[<a class="reference internal" href="z_biblio.html#id8" title="Kevin J Grimm, Nilam Ram, and Ryne Estabrook. Growth modeling: Structural equation and multilevel modeling approaches. Guilford Publications, 2016.">GRE16</a>]</span> e possono essere utilizzati per illustrare i concetti relativi alle analisi di cambiamento longitudinale.</p>
<p>Iniziamo a leggere i dati.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="c1"># set filepath for data file</span>
<span class="n">filepath</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;https://raw.githubusercontent.com/LRI-2/Data/main/GrowthModeling/nlsy_math_long_R.dat&quot;</span>
<span class="c1"># read in the text data file using the url() function</span>
<span class="n">dat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">read.table</span><span class="p">(</span>
<span class="w">  </span><span class="n">file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">url</span><span class="p">(</span><span class="n">filepath</span><span class="p">),</span>
<span class="w">  </span><span class="n">na.strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;.&quot;</span>
<span class="p">)</span><span class="w"> </span><span class="c1"># indicates the missing data designator</span>
<span class="c1"># copy data with new name</span>
<span class="n">nlsy_math_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">dat</span>

<span class="c1"># Add names the columns of the data set</span>
<span class="nf">names</span><span class="p">(</span><span class="n">nlsy_math_long</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">  </span><span class="s">&quot;id&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;female&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;lb_wght&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;anti_k1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;math&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;grade&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;occ&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;age&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;men&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="s">&quot;spring&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;anti&quot;</span>
<span class="p">)</span>

<span class="c1"># view the first few observations in the data set</span>
<span class="nf">head</span><span class="p">(</span><span class="n">nlsy_math_long</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 6 × 11</caption>
<thead>
	<tr><th></th><th scope=col>id</th><th scope=col>female</th><th scope=col>lb_wght</th><th scope=col>anti_k1</th><th scope=col>math</th><th scope=col>grade</th><th scope=col>occ</th><th scope=col>age</th><th scope=col>men</th><th scope=col>spring</th><th scope=col>anti</th></tr>
	<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td> 201</td><td>1</td><td>0</td><td>0</td><td>38</td><td>3</td><td>2</td><td>111</td><td> 0</td><td>1</td><td>0</td></tr>
	<tr><th scope=row>2</th><td> 201</td><td>1</td><td>0</td><td>0</td><td>55</td><td>5</td><td>3</td><td>135</td><td> 1</td><td>1</td><td>0</td></tr>
	<tr><th scope=row>3</th><td> 303</td><td>1</td><td>0</td><td>1</td><td>26</td><td>2</td><td>2</td><td>121</td><td> 0</td><td>1</td><td>2</td></tr>
	<tr><th scope=row>4</th><td> 303</td><td>1</td><td>0</td><td>1</td><td>33</td><td>5</td><td>3</td><td>145</td><td> 0</td><td>1</td><td>2</td></tr>
	<tr><th scope=row>5</th><td>2702</td><td>0</td><td>0</td><td>0</td><td>56</td><td>2</td><td>2</td><td>100</td><td>NA</td><td>1</td><td>0</td></tr>
	<tr><th scope=row>6</th><td>2702</td><td>0</td><td>0</td><td>0</td><td>58</td><td>4</td><td>3</td><td>125</td><td>NA</td><td>1</td><td>2</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>I dati sono qui forniti nel formato <em>long</em>.</p>
<p>Contiamo il numero di partecipanti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nlsy_math_long</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">distinct</span><span class="p">(</span><span class="n">id</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 1 × 1</caption>
<thead>
	<tr><th scope=col>n</th></tr>
	<tr><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td>932</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Con <code class="docutils literal notranslate"><span class="pre">pivot_wider</span></code> possiamo trasformare i dati in formato <em>wide</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nlsy_math_wide</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nlsy_math_long</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">pivot_wider</span><span class="p">(</span><span class="n">names_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grade</span><span class="p">,</span><span class="w"> </span><span class="n">values_from</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">math</span><span class="p">)</span>

<span class="n">nlsy_math_wide</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A tibble: 6 × 16</caption>
<thead>
	<tr><th scope=col>id</th><th scope=col>female</th><th scope=col>lb_wght</th><th scope=col>anti_k1</th><th scope=col>occ</th><th scope=col>age</th><th scope=col>men</th><th scope=col>spring</th><th scope=col>anti</th><th scope=col>3</th><th scope=col>5</th><th scope=col>2</th><th scope=col>4</th><th scope=col>8</th><th scope=col>6</th><th scope=col>7</th></tr>
	<tr><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><td> 201</td><td>1</td><td>0</td><td>0</td><td>2</td><td>111</td><td> 0</td><td>1</td><td>0</td><td>38</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td></tr>
	<tr><td> 201</td><td>1</td><td>0</td><td>0</td><td>3</td><td>135</td><td> 1</td><td>1</td><td>0</td><td>NA</td><td>55</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td></tr>
	<tr><td> 303</td><td>1</td><td>0</td><td>1</td><td>2</td><td>121</td><td> 0</td><td>1</td><td>2</td><td>NA</td><td>NA</td><td>26</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td></tr>
	<tr><td> 303</td><td>1</td><td>0</td><td>1</td><td>3</td><td>145</td><td> 0</td><td>1</td><td>2</td><td>NA</td><td>33</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td></tr>
	<tr><td>2702</td><td>0</td><td>0</td><td>0</td><td>2</td><td>100</td><td>NA</td><td>1</td><td>0</td><td>NA</td><td>NA</td><td>56</td><td>NA</td><td>NA</td><td>NA</td><td>NA</td></tr>
	<tr><td>2702</td><td>0</td><td>0</td><td>0</td><td>3</td><td>125</td><td>NA</td><td>1</td><td>2</td><td>NA</td><td>NA</td><td>NA</td><td>58</td><td>NA</td><td>NA</td><td>NA</td></tr>
</tbody>
</table>
</div></div>
</div>
</section>
<section id="visualizzazione-dei-dati-longitudinali">
<h2><span class="section-number">29.3. </span>Visualizzazione dei dati longitudinali<a class="headerlink" href="#visualizzazione-dei-dati-longitudinali" title="Permalink to this headline">#</a></h2>
<p>Come in qualsiasi analisi statistica, è importante esaminare attentamente i dati. Ciò include la produzione di sia riepiloghi quantitativi che visualizzazioni.</p>
<p>Per fare un esempio di visualizzazione di dati longitudinali, esaminiamo il cambiamento nel rendimento in matematica dei bambini durante la scuola elementare e media utilizzando il set di dati NLSY-CYA [i dati sono presentati nel capitolo 3 del libro di <span id="id3">Grimm <em>et al.</em> [<a class="reference internal" href="z_biblio.html#id8" title="Kevin J Grimm, Nilam Ram, and Ryne Estabrook. Growth modeling: Structural equation and multilevel modeling approaches. Guilford Publications, 2016.">GRE16</a>]</span>]. Selezioniamo solo il grado scolastico, il codice identificativo e il punteggio di matematica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nlsy_math_only_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nlsy_math_long</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">grade</span><span class="p">,</span><span class="w"> </span><span class="n">math</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Le traiettorie di cambiamento intra-individuale possono essere prodotte nel modo seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nlsy_math_long</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span><span class="c1"># data set</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grade</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">math</span><span class="p">,</span><span class="w"> </span><span class="n">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">id</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># setting variables</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">(</span><span class="n">size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">5</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># adding points to plot</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="m">0.2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="c1"># adding lines to plot</span>
<span class="w">  </span><span class="c1"># setting the x-axis with breaks and labels</span>
<span class="w">  </span><span class="nf">scale_x_continuous</span><span class="p">(</span>
<span class="w">    </span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">,</span><span class="w"> </span><span class="m">4</span><span class="p">,</span><span class="w"> </span><span class="m">5</span><span class="p">,</span><span class="w"> </span><span class="m">6</span><span class="p">,</span><span class="w"> </span><span class="m">7</span><span class="p">,</span><span class="w"> </span><span class="m">8</span><span class="p">),</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Grade at Testing&quot;</span>
<span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># setting the y-axis with limits breaks and labels</span>
<span class="w">  </span><span class="nf">scale_y_continuous</span><span class="p">(</span>
<span class="w">    </span><span class="n">limits</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">),</span>
<span class="w">    </span><span class="n">breaks</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">10</span><span class="p">,</span><span class="w"> </span><span class="m">30</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">,</span><span class="w"> </span><span class="m">70</span><span class="p">,</span><span class="w"> </span><span class="m">90</span><span class="p">),</span>
<span class="w">    </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;PIAT Mathematics&quot;</span>
<span class="w">  </span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/303ddbc1a81e292178c3197fe0e23ecb014dfaaa4c7e8279bb2b75515f958f5b.png" src="_images/303ddbc1a81e292178c3197fe0e23ecb014dfaaa4c7e8279bb2b75515f958f5b.png" />
</div>
</div>
<p>Esaminiamo le traiettorie di sviluppo dei primi 9 partecipanti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">subset_it</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="m">201</span><span class="p">,</span><span class="w"> </span><span class="m">303</span><span class="p">,</span><span class="w"> </span><span class="m">2702</span><span class="p">,</span><span class="w"> </span><span class="m">4303</span><span class="p">,</span><span class="w"> </span><span class="m">5002</span><span class="p">,</span><span class="w"> </span><span class="m">5005</span><span class="p">,</span><span class="w"> </span><span class="m">5701</span><span class="p">,</span><span class="w"> </span><span class="m">6102</span><span class="p">,</span><span class="w"> </span><span class="m">6801</span><span class="p">)</span>
<span class="n">temp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nlsy_math_long</span><span class="p">[</span><span class="n">nlsy_math_long</span><span class="o">$</span><span class="n">id</span><span class="w"> </span><span class="o">%in%</span><span class="w"> </span><span class="n">subset_it</span><span class="p">,</span><span class="w"> </span><span class="p">]</span>

<span class="n">temp</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">grade</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">math</span><span class="p">))</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_point</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">geom_line</span><span class="p">()</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="c1"># coord_cartesian(ylim = c(1, 4)) +</span>
<span class="w">  </span><span class="nf">theme</span><span class="p">(</span><span class="n">panel.grid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">element_blank</span><span class="p">())</span><span class="w"> </span><span class="o">+</span>
<span class="w">  </span><span class="nf">facet_wrap</span><span class="p">(</span><span class="o">~</span><span class="n">id</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b9c43c471b657479035cad089e8453c48574b66046549bc657ba6dbe39075809.png" src="_images/b9c43c471b657479035cad089e8453c48574b66046549bc657ba6dbe39075809.png" />
</div>
</div>
</section>
<section id="data-screening">
<h2><span class="section-number">29.4. </span>Data screening<a class="headerlink" href="#data-screening" title="Permalink to this headline">#</a></h2>
<p>Prima di adattare i modelli di crescita ai dati longitudinali, è essenziale effettuare una valutazione preliminare dei dati e acquisire informazioni di base sulle variabili da utilizzare nell’analisi. Una delle prime fasi di questa valutazione preliminare è l’ispezione della distribuzione dei punteggi per ogni variabile, utilizzando le principali statistiche descrittive univariate, come la media, la mediana, la varianza (deviazione standard), l’asimmetria, la curtosi, il minimo, il massimo, l’intervallo e il numero di osservazioni per ogni variabile, in base alla metrica del tempo scelta. Le statistiche descrittive bivariate, come le correlazioni/covarianze e le tabelle di frequenza bivariate per variabili nominali o ordinali, possono fornire informazioni sui possibili schemi e relazioni non lineari, nonché sui potenziali valori anomali e codici errati.</p>
<p>I dati longitudinali sono caratterizzati dall’ordinamento dei dati lungo una o più metriche del tempo (ad esempio, l’occasione di misurazione, l’età, la data, il tempo dall’evento, il numero di esposizioni, ecc.). È importante esaminare come la media, la varianza e il numero di casi disponibili cambiano attraverso le misure ripetute (ad esempio wght5, wght6, wght7). Va notato che la selezione della metrica del tempo influisce notevolmente sulla capacità di interpretare i risultati di qualsiasi modello di crescita specifico. Pertanto, durante la fase di selezione dei dati, è necessario considerare attentamente come varie proprietà dei dati longitudinali cambiano quando i dati sono organizzati in relazione a diverse metriche del tempo.</p>
<p>Per i dati dell’esempio, le statistiche descrittive possono essere ottenute nel modo seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">describe</span><span class="p">(</span><span class="n">nlsy_math_long</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        vars    n      mean        sd median   trimmed       mad min     max
id         1 2221 528449.15 327303.70 497403 515466.90 384144.63 201 1256601
female     2 2221      0.49      0.50      0      0.49      0.00   0       1
lb_wght    3 2221      0.08      0.27      0      0.00      0.00   0       1
anti_k1    4 2221      1.42      1.50      1      1.19      1.48   0       8
math       5 2221     46.12     12.80     46     46.22     11.86  12      81
grade      6 2221      4.51      1.77      4      4.44      1.48   2       8
occ        7 2221      2.84      0.79      3      2.77      1.48   2       5
age        8 2221    126.90     22.06    126    126.28     25.20  82     175
men        9 1074      0.19      0.40      0      0.12      0.00   0       1
spring    10 2221      0.65      0.48      1      0.69      0.00   0       1
anti      11 2170      1.58      1.54      1      1.38      1.48   0       8
          range  skew kurtosis      se
id      1256400  0.30    -0.90 6945.07
female        1  0.03    -2.00    0.01
lb_wght       1  3.10     7.63    0.01
anti_k1       8  1.14     1.14    0.03
math         69 -0.03    -0.18    0.27
grade         6  0.26    -0.92    0.04
occ           3  0.55    -0.48    0.02
age          93  0.19    -0.91    0.47
men           1  1.54     0.37    0.01
spring        1 -0.63    -1.61    0.01
anti          8  0.98     0.64    0.03
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo le statistiche descrittive bivariate.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">cor</span><span class="p">(</span><span class="n">nlsy_math_long</span><span class="p">,</span><span class="w"> </span><span class="n">use</span><span class="o">=</span><span class="s">&#39;pairwise.complete.obs&#39;</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span><span class="w"> </span>
<span class="w">  </span><span class="nf">round</span><span class="p">(</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A matrix: 11 × 11 of type dbl</caption>
<thead>
	<tr><th></th><th scope=col>id</th><th scope=col>female</th><th scope=col>lb_wght</th><th scope=col>anti_k1</th><th scope=col>math</th><th scope=col>grade</th><th scope=col>occ</th><th scope=col>age</th><th scope=col>men</th><th scope=col>spring</th><th scope=col>anti</th></tr>
</thead>
<tbody>
	<tr><th scope=row>id</th><td> 1.00</td><td>-0.01</td><td>-0.01</td><td>-0.02</td><td>-0.22</td><td>-0.01</td><td> 0.01</td><td>-0.01</td><td>-0.02</td><td>-0.11</td><td> 0.01</td></tr>
	<tr><th scope=row>female</th><td>-0.01</td><td> 1.00</td><td> 0.06</td><td>-0.09</td><td>-0.05</td><td> 0.00</td><td>-0.02</td><td>-0.04</td><td> 0.02</td><td> 0.04</td><td>-0.07</td></tr>
	<tr><th scope=row>lb_wght</th><td>-0.01</td><td> 0.06</td><td> 1.00</td><td> 0.03</td><td>-0.03</td><td>-0.02</td><td>-0.03</td><td> 0.01</td><td> 0.04</td><td> 0.03</td><td> 0.02</td></tr>
	<tr><th scope=row>anti_k1</th><td>-0.02</td><td>-0.09</td><td> 0.03</td><td> 1.00</td><td>-0.08</td><td>-0.03</td><td>-0.04</td><td>-0.01</td><td> 0.01</td><td>-0.01</td><td> 0.52</td></tr>
	<tr><th scope=row>math</th><td>-0.22</td><td>-0.05</td><td>-0.03</td><td>-0.08</td><td> 1.00</td><td> 0.59</td><td> 0.53</td><td> 0.58</td><td> 0.30</td><td> 0.29</td><td>-0.05</td></tr>
	<tr><th scope=row>grade</th><td>-0.01</td><td> 0.00</td><td>-0.02</td><td>-0.03</td><td> 0.59</td><td> 1.00</td><td> 0.87</td><td> 0.95</td><td> 0.62</td><td> 0.12</td><td> 0.04</td></tr>
	<tr><th scope=row>occ</th><td> 0.01</td><td>-0.02</td><td>-0.03</td><td>-0.04</td><td> 0.53</td><td> 0.87</td><td> 1.00</td><td> 0.86</td><td> 0.57</td><td> 0.17</td><td> 0.04</td></tr>
	<tr><th scope=row>age</th><td>-0.01</td><td>-0.04</td><td> 0.01</td><td>-0.01</td><td> 0.58</td><td> 0.95</td><td> 0.86</td><td> 1.00</td><td> 0.64</td><td> 0.21</td><td> 0.06</td></tr>
	<tr><th scope=row>men</th><td>-0.02</td><td> 0.02</td><td> 0.04</td><td> 0.01</td><td> 0.30</td><td> 0.62</td><td> 0.57</td><td> 0.64</td><td> 1.00</td><td> 0.16</td><td> 0.13</td></tr>
	<tr><th scope=row>spring</th><td>-0.11</td><td> 0.04</td><td> 0.03</td><td>-0.01</td><td> 0.29</td><td> 0.12</td><td> 0.17</td><td> 0.21</td><td> 0.16</td><td> 1.00</td><td>-0.01</td></tr>
	<tr><th scope=row>anti</th><td> 0.01</td><td>-0.07</td><td> 0.02</td><td> 0.52</td><td>-0.05</td><td> 0.04</td><td> 0.04</td><td> 0.06</td><td> 0.13</td><td>-0.01</td><td> 1.00</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Scomponiamo i punteggi nelle componenti tra i soggetti ed entro i soggetti.</p>
<p>Esaminiamo la distribuzione delle medie dei punteggi tra i soggetti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">tmp</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">meanDecompose</span><span class="p">(</span><span class="n">math</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsy_math_long</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span>
<span class="w">    </span><span class="nf">testDistribution</span><span class="p">(</span>
<span class="w">        </span><span class="n">tmp</span><span class="p">[[</span><span class="s">&quot;math by id&quot;</span><span class="p">]]</span><span class="o">$</span><span class="n">X</span><span class="p">,</span>
<span class="w">        </span><span class="n">extremevalues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;theoretical&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ev.perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">001</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">varlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Between Person Math Scores&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/786d8a87b5356935b3f7da8525608dddccedab262aabde3c66f8717ba0af3fde.png" src="_images/786d8a87b5356935b3f7da8525608dddccedab262aabde3c66f8717ba0af3fde.png" />
</div>
</div>
<p>Esaminiamo la distribuzione dei punteggi entro i soggetti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">plot</span><span class="p">(</span>
<span class="w">    </span><span class="nf">testDistribution</span><span class="p">(</span>
<span class="w">        </span><span class="n">tmp</span><span class="p">[[</span><span class="s">&quot;math by residual&quot;</span><span class="p">]]</span><span class="o">$</span><span class="n">X</span><span class="p">,</span>
<span class="w">        </span><span class="n">extremevalues</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;theoretical&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">ev.perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">001</span>
<span class="w">    </span><span class="p">),</span>
<span class="w">    </span><span class="n">varlab</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Within Person Math Scores&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/8ceb93e71ccdaeb5402dada675388a511dc73a9f8886ba6d69e56fc4a6c921a4.png" src="_images/8ceb93e71ccdaeb5402dada675388a511dc73a9f8886ba6d69e56fc4a6c921a4.png" />
</div>
</div>
</section>
<section id="attendibilita">
<h2><span class="section-number">29.5. </span>Attendibilità<a class="headerlink" href="#attendibilita" title="Permalink to this headline">#</a></h2>
<p>Per garantire la validità delle analisi, è necessario valutare l’affidabilità degli strumenti di misurazione utilizzati. Ciò è particolarmente importante in analisi longitudinali, in cui si studiano i cambiamenti all’interno di ciascun individuo nel tempo. Una delle metodologie utilizzate per valutare l’affidabilità degli strumenti di misurazione è il calcolo dell’indice di affidabilità <span class="math notranslate nohighlight">\(\omega\)</span> di McDonald per ogni momento temporale in cui si effettua la misurazione. Tuttavia, è importante sottolineare che questo indice non è equivalente alle misure di affidabilità degli indici di cambiamento longitudinale. Quest’ultima è una problematica complessa, soprattutto in disegni longitudinali intensivi, e costituisce un tema di discussione nella letteratura metodologica contemporanea.</p>
<p>Mentre l’affidabilità dei cambiamenti intra-individuali è difficile da stimare, l’affidabilità delle differenze inter-individuali può essere trovata facilmente. L’affidabilità del cambiamento inter-individuale è la proporzione di varianza nei punteggi osservati tra gli individui che può essere attribuita alla varianza nei punteggi veri piuttosto che alla varianza dell’errore:</p>
<div class="math notranslate nohighlight">
\[
\frac{\text{varianza di interesse}}{\text{varianza di interesse} + \text{varianza d'errore}},
\]</div>
<p>Nel caso delle misure di differenza individuale ottenute tramite <em>Intensive Longitudinal Designs</em> (ILD), per valutare l’affidabilità delle medie intra-individuali <span class="math notranslate nohighlight">\(\bar{y}\)</span> (cioè la varianza “vera” delle medie tra i soggetti) si può utilizzare il coefficiente di correlazione intraclasse (ICC). In sostanza, l’ICC indica la proporzione di varianza totale che è attribuibile alle differenze tra gli individui rispetto alla varianza totale, che comprende sia le differenze tra gli individui che le differenze all’interno di ciascun individuo nel tempo. L’ICC viene calcolato come un rapporto tra varianze:</p>
<div class="math notranslate nohighlight">
\[
\rho^2_{\bar{y}} = \frac{\hat{\tau}^2_{\mu}}{\hat{\tau}^2_{\mu} + \hat{\tau}^2_{\varepsilon}}.
\]</div>
<p>Il coefficiente di correlazione intraclasse (ICC) può essere stimato utilizzano un modello misto lineare con intercetta casuale che tiene conto della clusterizzazione dei dati, cioè del fatto che le osservazioni sono raggruppate in base ai soggetti. L’ICC viene calcolato come il rapporto tra la varianza tra le medie dei cluster di raggruppamento dei dati e la varianza totale, che comprende la varianza tra i cluster e la varianza all’interno dei cluster. In altre parole, l’ICC rappresenta la proporzione di varianza totale che è dovuta alle differenze tra i soggetti rispetto alla varianza totale delle misure ripetute. Questo indice è utile per valutare l’affidabilità delle misure ripetute e la loro utilità per lo studio delle differenze individuali.</p>
<p>Un esempio concreto può aiutare a capire meglio il concetto. Consideriamo nuovamente i dati <code class="docutils literal notranslate"><span class="pre">nlsy_math_long</span></code>, che rappresentano il cambiamento nel rendimento in matematica dei bambini tra i gradi scolastici 2 e 8.</p>
<p>Selezioniamo solo le variabili di interesse.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">nlsy_math_only_long</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">nlsy_math_long</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">    </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span><span class="n">id</span><span class="p">,</span><span class="w"> </span><span class="n">grade</span><span class="p">,</span><span class="w"> </span><span class="n">math</span><span class="p">)</span>

<span class="n">nlsy_math_only_long</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="dataframe">
<caption>A data.frame: 6 × 3</caption>
<thead>
	<tr><th></th><th scope=col>id</th><th scope=col>grade</th><th scope=col>math</th></tr>
	<tr><th></th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th><th scope=col>&lt;int&gt;</th></tr>
</thead>
<tbody>
	<tr><th scope=row>1</th><td> 201</td><td>3</td><td>38</td></tr>
	<tr><th scope=row>2</th><td> 201</td><td>5</td><td>55</td></tr>
	<tr><th scope=row>3</th><td> 303</td><td>2</td><td>26</td></tr>
	<tr><th scope=row>4</th><td> 303</td><td>5</td><td>33</td></tr>
	<tr><th scope=row>5</th><td>2702</td><td>2</td><td>56</td></tr>
	<tr><th scope=row>6</th><td>2702</td><td>4</td><td>58</td></tr>
</tbody>
</table>
</div></div>
</div>
<p>Il coefficiente ICC può essere trovato, ad esempio, mediante la funzione <code class="docutils literal notranslate"><span class="pre">iccMixed</span></code> specificando un raggruppamento dei dati nei termini dei soggetti.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">iccMixed</span><span class="p">(</span>
<span class="w">  </span><span class="n">dv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;math&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">),</span>
<span class="w">  </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsy_math_long</span>
<span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">  </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        Var     Sigma       ICC
1:       id  47.02036 0.2872289
2: Residual 116.68307 0.7127711
</pre></div>
</div>
</div>
</div>
<p>Per capire meglio il significato dell’ICC calcolato in precedenza per i dati <code class="docutils literal notranslate"><span class="pre">nlsy_math_long</span></code>, possiamo replicare lo stesso risultato utilizzando il modello misto lineare <code class="docutils literal notranslate"><span class="pre">lmer</span></code>, che tiene conto dell’effetto casuale del soggetto. In questo modo, possiamo avere una stima della varianza intraclasse e quindi dell’ICC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lmer</span><span class="p">(</span><span class="n">math</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsy_math_only_long</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il modello misto decompone la varianza totale in due componenti: la varianza che dipende dalla differenze tra le medie di ciascun soggetto (tra i soggetti, o varianza delle intercette individuali, <span class="math notranslate nohighlight">\(\tau_{00}\)</span>) e la varianza che dipende dalle variazioni di ciascun soggetto attorno alla sua media.</p>
<p>Calcoliamo la varianza totale dei punteggi di matematica.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">var</span><span class="p">(</span><span class="n">nlsy_math_only_long</span><span class="o">$</span><span class="n">math</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1] 163.8379
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo ora la scomposizione della varianza eseguita dal modello misto. Si noti che la somma delle due componenti è uguale alla varianza totale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">VarCorr</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span> Groups   Name        Std.Dev.
 id       (Intercept)  6.8571 
 Residual             10.8020 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">6.8571</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">10.8020</span><span class="o">^</span><span class="m">2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">163.70302441</div></div>
</div>
<p>Il coefficiente ICC è data dal rapporto tra la varianza attribuibile alla variazione tra le medie dei soggetti e la varianza totale.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="m">6.8571</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="m">6.8571</span><span class="o">^</span><span class="m">2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">10.8020</span><span class="o">^</span><span class="m">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">0.287226339155697</div></div>
</div>
<p>In ambito di modelli LGM, l’ICC può essere utilizzato per stimare l’affidabilità delle medie intra-individuali dei fattori latenti, ma non è applicabile per l’affidabilità delle variazioni intra-individuali delle traiettorie di sviluppo. Per queste ultime, altre misure di affidabilità sono necessarie e hanno alcune limitazioni pratiche. Ad esempio, il coefficiente di affidabilità test-retest può essere utilizzato per stimare l’affidabilità intra-individuale delle traiettorie di sviluppo calcolate in due momenti temporali diversi, ma richiede l’assunzione che i punteggi veri non cambino nel tempo. In alternativa, le forme parallele dei test possono essere utilizzate per misurare l’affidabilità delle traiettorie intra-individuali, ma queste non sono sempre disponibili. Per stimare l’affidabilità della componente sistematica della variazione intra-individuale delle traiettorie di sviluppo, sono necessari metodi di stima specifici che sono ancora oggetto di dibattito nella letteratura metodologica corrente.</p>
<p>Prima di descrivere in dettaglio i modelli LGM, consideramo l’analisi dei dati longitudinali con i modelli misti. In R, queste analisi vengono svolte mediante la funzione <code class="docutils literal notranslate"><span class="pre">lmer</span></code> del pacchetto <code class="docutils literal notranslate"><span class="pre">lme4</span></code>.</p>
<section id="analisi-con-lmer">
<h3><span class="section-number">29.5.1. </span>Analisi con <code class="docutils literal notranslate"><span class="pre">lmer</span></code><a class="headerlink" href="#analisi-con-lmer" title="Permalink to this headline">#</a></h3>
<p>La funzione <code class="docutils literal notranslate"><span class="pre">lmer()</span></code> accetta i seguenti argomenti:</p>
<ul class="simple">
<li><p>formula: una formula lineare a due lati che descrive sia gli effetti fissi che gli effetti casuali del modello, con la risposta a sinistra dell’operatore <code class="docutils literal notranslate"><span class="pre">~</span></code> e i predittori e gli effetti casuali sulla destra dell’operatore <code class="docutils literal notranslate"><span class="pre">~</span></code>.</p></li>
<li><p>data: Un data.frame, che deve essere nel cosiddetto formato “lungo”, con una singola riga per osservazione.</p></li>
</ul>
<p>Iniziamo a descrivere la sintassi che consente la specificazione di un modello misto. Gli effetti fissi sono specificati come segue.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Formula</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span></code></p></td>
<td><p>main effects of a and b (and no interaction)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">a:b</span></code></p></td>
<td><p>only interaction of a and b (and no main effects)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">*</span> <span class="pre">b</span></code></p></td>
<td><p>main effects and interaction of a and b (expands to: a + b + a:b)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(a+b+c)^2</span></code></p></td>
<td><p>main effects and two-way interactions, but no three-way interaction (expands to: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">+</span> <span class="pre">c</span> <span class="pre">+</span> <span class="pre">a:b</span> <span class="pre">+</span> <span class="pre">b:c</span> <span class="pre">+</span> <span class="pre">a:c</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(a+b)*c</span></code></p></td>
<td><p>all main effects and pairwise interactions between c and a or b (expands to: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">+</span> <span class="pre">b</span> <span class="pre">+</span> <span class="pre">c</span> <span class="pre">+</span> <span class="pre">a:c</span> <span class="pre">+</span> <span class="pre">b:c</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">0</span> <span class="pre">+</span> <span class="pre">a</span></code></p></td>
<td><p>0 suppresses the intercept resulting in a model that has one parameter per level of a (identical to: <code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">-</span> <span class="pre">1</span></code>)</p></td>
</tr>
</tbody>
</table>
<p>Gli effetti random vengono aggiunti alla formula tra parentesi <code class="docutils literal notranslate"><span class="pre">()</span></code>. All’interno di queste parentesi si fornisce sul lato sinistro di un segno condizionale <code class="docutils literal notranslate"><span class="pre">|</span></code> la specifica degli effetti casuali relativi alle pendenze individuali da includere nel modello. Sul lato destro di questo segno condizionale, si specifica il fattore di raggruppamento o i fattori di raggruppamento da cui dipendono questi effetti casuali. I fattori di raggruppamento devono essere di classe <code class="docutils literal notranslate"><span class="pre">factor</span></code> (cioè non possono essere variabili numeriche).</p>
<p>Gli effetti random vengono specificati come segue.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Formula</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(1|s)</span></code></p></td>
<td><p>random intercepts for unique level of the factor s</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(1|s)</span> <span class="pre">+</span> <span class="pre">(1|i)</span></code></p></td>
<td><p>random intercepts for each unique level of s and for each unique level of i</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(1|s/i)</span></code></p></td>
<td><p>random intercepts for factor s and i, where the random effects for i are nested in s. This expands to <code class="docutils literal notranslate"><span class="pre">(1|s)</span> <span class="pre">+</span> <span class="pre">(1|s:i)</span></code> , i.e. a random intercept for each level of s, and each unique combination of the levels of s and i. Nested random effects are used in so-called multilevel models. For example, s might refer to schools, and i to classrooms within those schools.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(a|s)</span></code></p></td>
<td><p>random intercepts and random slopes for a, for each level of s. Correlations between the intercept and slope effects are also estimated – identical to <code class="docutils literal notranslate"><span class="pre">(a*b|s))</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(a*b|s)</span></code></p></td>
<td><p>random intercepts and slopes for a, b, and the a:b interaction, for each level of s. Correlations between all the random effects are estimated.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">(0+a|s)</span></code></p></td>
<td><p>random slopes for a for each level of s, but no random intercepts</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">(a||s)</span></code></p></td>
<td><p>random intercepts and random slopes for a, for each level of s, but no correlations between the random effects (i.e. they are set to 0). This expands to: <code class="docutils literal notranslate"><span class="pre">(0+a|s)</span> <span class="pre">+</span> <span class="pre">(1|s)</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="formulazione-del-modello">
<h3><span class="section-number">29.5.2. </span>Formulazione del modello<a class="headerlink" href="#formulazione-del-modello" title="Permalink to this headline">#</a></h3>
<p>In precedenza abbiamo descritto la variazione media tra gli individui mediante un modello misto ad intercetta casuale. È possibile estendere questo modello a casi più complessi, per esempio quello che assume una retta di regressione con pendenza ed intercetta diversa per ciascun soggetto. Per i dati <code class="docutils literal notranslate"><span class="pre">nlsy_math_long</span></code> possiamo specificare un tale modello in <code class="docutils literal notranslate"><span class="pre">lmer</span></code> usando la sintassi seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">m</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lmer</span><span class="p">(</span><span class="n">math</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">grade</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">grade</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">id</span><span class="p">),</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nlsy_math_long</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In un modello misto, i coefficienti delle rette di regressione di ciascun soggetto sono considerati come componenti casuali di una distribuzione di coefficienti relativi all’intercetta e alla pendenza complessive del gruppo. Questi coefficienti casuali possono essere modellati specificando una componente casuale <code class="docutils literal notranslate"><span class="pre">(1</span> <span class="pre">+</span> <span class="pre">grado</span> <span class="pre">|</span> <span class="pre">id)</span></code>. In questo tipo di modello, esiste una correlazione tra i parametri delle intercette e quelli delle pendenze individuali. Ciò significa che le componenti di varianza attribuibili ai vari effetti del modello (fissi e casuali) non sono più indipendenti e la varianza totale non può essere scomposta in componenti indipendenti.</p>
<p>Per estrarre le componenti di varianza di un modello misto, è possibile utilizzare le funzioni fornite dal pacchetto <code class="docutils literal notranslate"><span class="pre">insight</span></code>. Ad esempio, nel caso dell’esempio presentato, i risultati possono essere ottenuti attraverso l’oggetto creato dalla funzione <code class="docutils literal notranslate"><span class="pre">lmer</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">get_variance</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>$var.fixed
[1] 58.94602

$var.random
[1] 70.66767

$var.residual
[1] 36.23643

$var.distribution
[1] 36.23643

$var.dispersion
[1] 0

$var.intercept
      id 
68.40554 

$var.slope
 id.grade 
0.7391598 

$cor.slope_intercept
        id 
-0.2353174 
</pre></div>
</div>
</div>
</div>
<p>Una descrizione visiva della varianza delle varie componenti del modello può essere ottenuta mediante la funzione <code class="docutils literal notranslate"><span class="pre">modelDiagnostics</span></code> del pacchetto <code class="docutils literal notranslate"><span class="pre">JWileymisc</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">md</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">modelDiagnostics</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="w"> </span><span class="n">ev.perc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">.</span><span class="m">001</span><span class="p">)</span>
<span class="nf">plot</span><span class="p">(</span><span class="n">md</span><span class="p">,</span><span class="w"> </span><span class="n">ask</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">ncol</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="n">nrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/792b37a7f6d00033dce0ee993b4ae419d3672fd11b95a89979857dd2d9a711f1.png" src="_images/792b37a7f6d00033dce0ee993b4ae419d3672fd11b95a89979857dd2d9a711f1.png" />
</div>
</div>
<p>Una descrizione dei parametri del modello può essere ottenuta nel modo seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">mt</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">modelTest</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
<span class="nf">names</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span>
<span class="nf">APAStyler</span><span class="p">(</span><span class="n">mt</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Parameters and CIs are based on REML, 
but modelTests requires ML not REML fit for comparisons, 
and these are used in effect sizes. Refitting.
</pre></div>
</div>
<div class="output text_html"><style>
.list-inline {list-style: none; margin:0; padding: 0}
.list-inline>li {display: inline-block}
.list-inline>li:not(:last-child)::after {content: "\00b7"; padding: 0 .5ex}
</style>
<ol class=list-inline><li>'FixedEffects'</li><li>'RandomEffects'</li><li>'EffectSizes'</li><li>'OverallModel'</li></ol>
</div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                        Term                     Est           Type
 1:              (Intercept) 26.59*** [25.66, 27.51]  Fixed Effects
 2:                    grade  4.34*** [ 4.17,  4.51]  Fixed Effects
 3: cor_grade.(Intercept)|id                   -0.24 Random Effects
 4:        sd_(Intercept)|id                    8.27 Random Effects
 5:              sd_grade|id                    0.86 Random Effects
 6:                    sigma                    6.02 Random Effects
 7:                 Model DF                       6  Overall Model
 8:               N (Groups)                id (932)  Overall Model
 9:         N (Observations)                    2221  Overall Model
10:                   logLik                -7968.69  Overall Model
11:                      AIC                15949.39  Overall Model
12:                      BIC                15983.62  Overall Model
13:              Marginal R2                    0.36  Overall Model
14:              Marginal F2                    0.55  Overall Model
15:           Conditional R2                    0.78  Overall Model
16:           Conditional F2                    3.57  Overall Model
17:   grade (Fixed + Random)     0.55/2.26, p &lt; .001   Effect Sizes
18:           grade (Random)     0.01/0.09, p = .002   Effect Sizes
</pre></div>
</div>
</div>
</div>
<p>La varianza spiegata dal modello viene ottenuta nel modo seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">modelPerformance</span><span class="p">(</span><span class="n">m</span><span class="p">)</span><span class="w"> </span><span class="o">|&gt;</span>
<span class="w">    </span><span class="nf">print</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>$Performance
    Model Estimator N_Obs N_Groups      AIC      BIC        LL LLDF   Sigma
1: merMod      REML  2221 id (932) 15952.99 15987.22 -7970.494    6 6.01967
   MarginalR2 ConditionalR2 MarginalF2 ConditionalF2
1:  0.3553142      0.781476  0.5511433      3.576157

attr(,&quot;class&quot;)
[1] &quot;modelPerformance.merMod&quot; &quot;modelPerformance&quot;       
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="invarianza-di-misurazione">
<h2><span class="section-number">29.6. </span>Invarianza di misurazione<a class="headerlink" href="#invarianza-di-misurazione" title="Permalink to this headline">#</a></h2>
<p>Nell’ambito dei modelli LGM, è importante considerare l’invarianza di misurazione quando si analizzano dati longitudinali. L’invarianza di misurazione si riferisce alla capacità dello strumento di misurazione di rilevare lo stesso costrutto nella stessa metrica in ogni occasione di misurazione, garantendo la comparabilità dei punteggi tra le diverse occasioni e le diverse persone. Ad esempio, se si utilizza una bilancia per misurare il peso degli individui, è importante utilizzare la stessa bilancia tarata nello stesso modo in ogni occasione di misurazione per garantire l’invarianza di misurazione. Se non si garantisce l’invarianza di misurazione, i punteggi risultanti non saranno confrontabili quantitativamente e lo strumento di misurazione sarà considerato non invariante.</p>
<p>Tuttavia, l’invarianza di misurazione può essere difficile da garantire quando si utilizzano strumenti di misurazione psicologici, poiché non è possibile tarare gli strumenti in modo simile a quanto si fa con i dispositivi fisici. In questi casi, l’invarianza di misurazione viene o assunta (il che non è ideale) o testata utilizzando modelli di misurazione formali, che consentono di valutare se gli strumenti di misurazione mantengono la stessa metrica nel tempo. Questi modelli di misurazione formali consentono di verificare l’invarianza di misurazione e garantiscono la comparabilità dei punteggi nel tempo, anche quando si utilizzano strumenti di misurazione psicologici.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="320_lgm_intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">28. </span>Curve di crescita latente</p>
      </div>
    </a>
    <a class="right-next"
       href="324_lgm_mixed.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">30. </span>LGM e modelli misti</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considerazioni-preliminari">29.1. Considerazioni preliminari</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#strutture-dei-dati">29.2. Strutture dei dati</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizzazione-dei-dati-longitudinali">29.3. Visualizzazione dei dati longitudinali</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-screening">29.4. Data screening</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attendibilita">29.5. Attendibilità</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisi-con-lmer">29.5.1. Analisi con <code class="docutils literal notranslate"><span class="pre">lmer</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#formulazione-del-modello">29.5.2. Formulazione del modello</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#invarianza-di-misurazione">29.6. Invarianza di misurazione</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>