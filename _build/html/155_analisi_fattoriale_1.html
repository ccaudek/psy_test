

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>20. Il modello unifattoriale &#8212; psy_test</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="_static/a11y.css" />
    <link rel="stylesheet" type="text/css" href="_static/custom.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/custom.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '155_analisi_fattoriale_1';</script>
    <link rel="shortcut icon" href="_static/increasing.png"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="21. Il modello statistico dell’analisi fattoriale" href="156_analisi_fattoriale_2.html" />
    <link rel="prev" title="19. Introduzione all’analisi fattoriale" href="150_intro_fa.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="psy_test - Home"/>
    <script>document.write(`<img src="_static/logo.png" class="logo__image only-dark" alt="psy_test - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Benvenuti
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Test psicometrici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="002_measurement.html">1. Misurazione: affidabilità, validazione di costrutto e costruzione di Scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="005_tipologie_test.html">2. Introduzione alla Psicometria: Approcci, Metodologie e Applicazioni</a></li>
<li class="toctree-l1"><a class="reference internal" href="007_norms.html">3. Valutazioni normative e criteriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="010_development.html">4. Sviluppo dello strumento</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria classica dei test</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="020_ctt_1.html">5. Fondamenti teorici</a></li>
<li class="toctree-l1"><a class="reference internal" href="021_ctt_2.html">6. L’affidabilità del test</a></li>
<li class="toctree-l1"><a class="reference internal" href="022_ctt_3.html">7. Metodi di stima dell’affidabilità</a></li>
<li class="toctree-l1"><a class="reference internal" href="025_err_std_mis.html">8. L’errore standard della misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="026_err_std_stima.html">9. La stima del punteggio vero</a></li>
<li class="toctree-l1"><a class="reference internal" href="028_applications_ctt.html">10. Applicazioni della CTT</a></li>
<li class="toctree-l1"><a class="reference internal" href="E_ctt_1.html">11. ✏️ Esercizi</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Affidabilità tra giudici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="030_multilevel_1.html">12. Modelli multilivello</a></li>
<li class="toctree-l1"><a class="reference internal" href="031_interrater_reliability.html">13. L’affidabilità tra giudici</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Teoria della Generalizzabilità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="041_gtheory.html">14. Teoria della generalizzabilità</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Network Psychometrics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="045_networks.html">15. Network models</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Validità</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="051_validity.html">16. La validità del test</a></li>
<li class="toctree-l1"><a class="reference internal" href="055_relations_to_other_vars.html">17. Relazioni test-criterio</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi dei percorsi</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="061_path_analysis.html">18. Path analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analisi fattoriale</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="150_intro_fa.html">19. Introduzione all’analisi fattoriale</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">20. Il modello unifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="156_analisi_fattoriale_2.html">21. Il modello statistico dell’analisi fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="157_analisi_fattoriale_3.html">22. Il modello multifattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="158_factor_scores.html">23. I punteggi fattoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="162_constraints_on_parms.html">24. Attendibilità e modello fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="163_total_score.html">25. Punteggio totale e modello fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="170_cfa_mod_comp.html">26. CFA: confronto tra modelli</a></li>
<li class="toctree-l1"><a class="reference internal" href="175_bifactor.html">27. Modello bifattoriale</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Costruzione di strumenti psicometrici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="201_valutare_le_matrici.html">28. Valutazione della matrice di correlazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="202_estrazione.html">29. L’estrazione dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="203_numero_fattori.html">30. Il numero dei fattori</a></li>
<li class="toctree-l1"><a class="reference internal" href="205_rotazione.html">31. La rotazione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="206_valutare_sol_fattoriale.html">32. Valutare e rifinire la soluzione fattoriale</a></li>
<li class="toctree-l1"><a class="reference internal" href="210_group_invariance.html">33. Invarianza di misura</a></li>
<li class="toctree-l1"><a class="reference internal" href="215_gof.html">34. Indici di bontà dell’adattamento</a></li>
<li class="toctree-l1"><a class="reference internal" href="220_refine_solution.html">35. La revisione del modello</a></li>
<li class="toctree-l1"><a class="reference internal" href="225_mmm.html">36. CFA per matrici multi-tratto multi-metodo</a></li>
<li class="toctree-l1"><a class="reference internal" href="230_cat_data.html">37. Dati non gaussiani e categoriali</a></li>
<li class="toctree-l1"><a class="reference internal" href="235_missing_data.html">38. Dati mancanti</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli di equazioni strutturali</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="351_sem_intro.html">39. Introduzione ai modelli di equazioni struttural</a></li>
<li class="toctree-l1"><a class="reference internal" href="352_visualize_sem.html">40. Visualizzare i modelli di equazioni strutturali</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Modelli IRT</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="401_irt.html">41. Modelli di risposta all’item</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tutorial</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="500_sviluppo_strumento.html">42. Costruzione di test psicometrici</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Curve di crescita latente</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="701_lgm_intro.html">43. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="702_lgm_prelims.html">44. Dati longitudinali</a></li>
<li class="toctree-l1"><a class="reference internal" href="703_lgm_mixed.html">45. LGM e modelli misti</a></li>
<li class="toctree-l1"><a class="reference internal" href="705_growth_1.html">46. Curve di crescita latente</a></li>
<li class="toctree-l1"><a class="reference internal" href="706_growth_cont.html">47. Il tempo su una metrica continua</a></li>
<li class="toctree-l1"><a class="reference internal" href="710_time_inv_cov.html">48. Covariate indipendenti dal tempo</a></li>
<li class="toctree-l1"><a class="reference internal" href="711_growth_groups.html">49. Modelli di crescita latenti a gruppi multipli</a></li>
<li class="toctree-l1"><a class="reference internal" href="715_bivariate_growth_models.html">50. Modelli di crescita latenti bivariati</a></li>
<li class="toctree-l1"><a class="reference internal" href="720_inv_measurement.html">51. Invarianza di misurazione</a></li>
<li class="toctree-l1"><a class="reference internal" href="750_latent_change.html">52. Modello LCS univariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="751_biv_change.html">53. Modello LCS bivariato</a></li>
<li class="toctree-l1"><a class="reference internal" href="755_lgm_meas_inv.html">54. Invarianza fattoriale nei modelli LGM</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Bibliografia</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="z_biblio.html">55. Bibliografia</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendici</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="901_intro_r.html">56. Linguaggio di programmazione R</a></li>
<li class="toctree-l1"><a class="reference internal" href="910_regression.html">57. L’analisi di regressione</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/ccaudek/psy_test" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/ccaudek/psy_test/issues/new?title=Issue%20on%20page%20%2F155_analisi_fattoriale_1.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/155_analisi_fattoriale_1.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Il modello unifattoriale</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#errore-di-misura">20.1. Errore di misura</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-monofattoriale">20.2. Modello monofattoriale</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlazione-parziale">20.3. Correlazione parziale</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principio-base-dell-analisi-fattoriale">20.4. Principio base dell’analisi fattoriale</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vincoli-sulle-correlazioni">20.4.1. Vincoli sulle correlazioni</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teoria-dei-due-fattori">20.4.2. Teoria dei Due Fattori</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annullamento-della-tetrade">20.4.3. Annullamento della tetrade</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-del-centroide">20.4.4. Metodo del centroide</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduzione-a-lavaan">20.5. Introduzione a <code class="docutils literal notranslate"><span class="pre">lavaan</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sintassi-del-modello">20.5.1. Sintassi del modello</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#un-esempio-concreto">20.5.2. Un esempio concreto</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagrammi-di-percorso">20.5.3. Diagrammi di percorso</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisi-fattoriale-esplorativa">20.5.4. Analisi fattoriale esplorativa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusioni">20.6. Conclusioni</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="il-modello-unifattoriale">
<span id="fa-model-1-notebook"></span><h1><span class="section-number">20. </span>Il modello unifattoriale<a class="headerlink" href="#il-modello-unifattoriale" title="Permalink to this heading">#</a></h1>
<p>Questo capitolo presenta le nozioni fondamentali dell’analisi fattoriale, un modello statistico che consente di spiegare le correlazioni tra variabili osservate mediante la loro saturazione in uno o più fattori generali. In questo modello, le <span class="math notranslate nohighlight">\(p\)</span> variabili osservate (item) sono considerate condizionalmente indipendenti rispetto a <span class="math notranslate nohighlight">\(m\)</span> variabili latenti chiamate fattori. L’obiettivo dell’analisi fattoriale è di interpretare questi fattori come costrutti teorici inosservabili. Ad esempio, l’analisi fattoriale può essere utilizzata per spiegare le correlazioni tra le prestazioni di un gruppo di individui in una serie di compiti mediante il concetto di intelligenza. In questo modo, l’analisi fattoriale aiuta a identificare i costrutti cui gli item si riferiscono e a stabilire in che misura ciascun item rappresenta il costrutto. Il modello può essere unifattoriale (<span class="math notranslate nohighlight">\(m = 1\)</span>) o multifattoriale (<span class="math notranslate nohighlight">\(m &gt; 1\)</span>), e in questo capitolo si introdurrà il modello unifattoriale che assume l’esistenza di un unico fattore comune latente.</p>
<section id="errore-di-misura">
<h2><span class="section-number">20.1. </span>Errore di misura<a class="headerlink" href="#errore-di-misura" title="Permalink to this heading">#</a></h2>
<p>L’analisi fattoriale modella ogni misura osservata <span class="math notranslate nohighlight">\(y\)</span> come una combinazione del punteggio vero del costrutto latente <span class="math notranslate nohighlight">\(\xi\)</span> e di una componente di errore di misura latente <span class="math notranslate nohighlight">\(\delta\)</span>. In altre parole, il valore osservato di <span class="math notranslate nohighlight">\(y\)</span> è dato dalla somma del punteggio vero latente moltiplicato per il carico fattoriale <span class="math notranslate nohighlight">\(\lambda\)</span> e di un errore di misura latente <span class="math notranslate nohighlight">\(\delta_y\)</span>. Ad esempio, se consideriamo una bilancia imprecisa, ogni misura del peso corporeo è influenzata sia dal peso vero che dall’errore di misura della bilancia, che varia casualmente da misura a misura. In tal caso, il modello di analisi fattoriale sarebbe espresso come:</p>
<div class="math notranslate nohighlight">
\[
y = \lambda \xi + \delta_{y}.
\]</div>
<p>In questo modo, si può stimare il punteggio vero latente <span class="math notranslate nohighlight">\(\xi\)</span> e la componente di errore di misura latente <span class="math notranslate nohighlight">\(\delta\)</span>, se si dispone di molte misure osservate <span class="math notranslate nohighlight">\(y\)</span>, tutte che esprimono lo stesso costrutto latente <span class="math notranslate nohighlight">\(\xi\)</span>.</p>
</section>
<section id="modello-monofattoriale">
<h2><span class="section-number">20.2. </span>Modello monofattoriale<a class="headerlink" href="#modello-monofattoriale" title="Permalink to this heading">#</a></h2>
<p>Con <span class="math notranslate nohighlight">\(p\)</span> variabili manifeste <span class="math notranslate nohighlight">\(y_i\)</span>, il caso più semplice è quello di un solo fattore comune:</p>
<div class="math notranslate nohighlight" id="equation-eq-mod-unifattoriale">
<span class="eqno">(20.1)<a class="headerlink" href="#equation-eq-mod-unifattoriale" title="Permalink to this equation">#</a></span>\[
\begin{equation}
y_i = \mu_i + \lambda_{i} \xi +  1 \cdot \delta_i \qquad i=1, \dots, p,
\end{equation}
\]</div>
<p>dove <span class="math notranslate nohighlight">\(\xi\)</span> rappresenta il fattore comune a tutte le <span class="math notranslate nohighlight">\(y_i\)</span>, <span class="math notranslate nohighlight">\(\delta_i\)</span> sono i fattori specifici o unici di ogni variabile osservata e <span class="math notranslate nohighlight">\(\lambda_i\)</span> sono le saturazioni (o pesi) fattoriali le quali stabiliscono il peso del fattore latente su ciascuna variabile osservata.</p>
<p>Il modello di analisi fattoriale e il modello di regressione possono sembrare simili, ma presentano alcune differenze importanti. In primo luogo, sia il fattore comune <span class="math notranslate nohighlight">\(\xi\)</span> sia i fattori specifici <span class="math notranslate nohighlight">\(\delta_i\)</span> sono inosservabili, il che rende tutto ciò che si trova a destra dell’uguaglianza incognito. In secondo luogo, l’analisi di regressione e l’analisi fattoriale hanno obiettivi diversi. L’analisi di regressione mira a individuare le variabili esplicative, osservabili direttamente, che sono in grado di spiegare la maggior parte della varianza della variabile dipendente. Al contrario, il problema dell’analisi unifattoriale consiste nell’identificare la variabile esplicativa inosservabile che è in grado di spiegare la maggior parte della covarianza tra le variabili osservate.</p>
<p>Solitamente, per comodità, si assume che la media delle variabili osservate <span class="math notranslate nohighlight">\(y_i\)</span> sia zero, ovvero <span class="math notranslate nohighlight">\(\mu_i=0\)</span>. Ciò equivale a considerare gli scarti delle variabili rispetto alle rispettive medie. Il modello unifattoriale assume che le variabili osservate siano il risultato della combinazione lineare di un fattore comune <span class="math notranslate nohighlight">\(\xi\)</span> e dei fattori specifici <span class="math notranslate nohighlight">\(\delta_i\)</span>, ovvero:</p>
<div class="math notranslate nohighlight" id="equation-eq-mod-monofattoriale">
<span class="eqno">(20.2)<a class="headerlink" href="#equation-eq-mod-monofattoriale" title="Permalink to this equation">#</a></span>\[
\begin{equation}
y_i -\mu_i = \lambda_i \xi + 1 \cdot \delta_i,
\end{equation}
\]</div>
<p>dove <span class="math notranslate nohighlight">\(\lambda_i\)</span> è la saturazione o il peso della variabile <span class="math notranslate nohighlight">\(i\)</span>-esima sul fattore comune e <span class="math notranslate nohighlight">\(\delta_i\)</span> rappresenta il fattore specifico della variabile <span class="math notranslate nohighlight">\(i\)</span>-esima. Si assume che il fattore comune abbia media zero e varianza unitaria, mentre i fattori specifici abbiano media zero, varianza <span class="math notranslate nohighlight">\(\psi_{i}\)</span> e siano incorrelati tra loro e con il fattore comune. Nel modello unifattoriale, l’interdipendenza tra le variabili è completamente spiegata dal fattore comune.</p>
<p>Le ipotesi precedenti consentono di ricavare la covarianza tra la variabile osservata <span class="math notranslate nohighlight">\(y_i\)</span> e il fattore comune, la varianza della variabile osservata <span class="math notranslate nohighlight">\(y_i\)</span> e la covarianza tra due variabili osservate <span class="math notranslate nohighlight">\(y_i\)</span> e <span class="math notranslate nohighlight">\(y_k\)</span>. L’obiettivo della discussione in questo capitolo è appunto quello di analizzare tali grandezze statistiche.</p>
</section>
<section id="correlazione-parziale">
<h2><span class="section-number">20.3. </span>Correlazione parziale<a class="headerlink" href="#correlazione-parziale" title="Permalink to this heading">#</a></h2>
<p>Prima di entrare nel dettaglio del modello statistico dell’analisi fattoriale, è importante chiarire il concetto di correlazione parziale. Si attribuisce spesso a Charles Spearman la nascita dell’analisi fattoriale. Nel 1904, Spearman pubblicò un articolo intitolato “General Intelligence, Objectively Determined and Measured” in cui propose la Teoria dei Due Fattori. In questo articolo, dimostrò come fosse possibile identificare un fattore inosservabile a partire da una matrice di correlazioni, utilizzando il metodo dell’annullamento della tetrade (tetrad differences). L’annullamento della tetrade è un’applicazione della teoria della correlazione parziale, che mira a stabilire se, controllando un insieme di variabili inosservabili chiamate fattori <span class="math notranslate nohighlight">\(\xi_j\)</span>, le correlazioni tra le variabili osservabili <span class="math notranslate nohighlight">\(Y_i\)</span>, al netto degli effetti lineari delle <span class="math notranslate nohighlight">\(\xi_j\)</span>, diventino statisticamente nulle.</p>
<p>Possiamo considerare un esempio con tre variabili: <span class="math notranslate nohighlight">\(Y_1\)</span>, <span class="math notranslate nohighlight">\(Y_2\)</span> e <span class="math notranslate nohighlight">\(F\)</span>. La correlazione tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span>, <span class="math notranslate nohighlight">\(r_{1,2}\)</span>, può essere influenzata dalla presenza di <span class="math notranslate nohighlight">\(F\)</span>. Per calcolare la correlazione parziale tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span> al netto dell’effetto lineare di <span class="math notranslate nohighlight">\(F\)</span>, dobbiamo trovare le componenti di <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span> che sono linearmente indipendenti da <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>Per fare ciò, dobbiamo trovare la componente di <span class="math notranslate nohighlight">\(Y_1\)</span> che è ortogonale a <span class="math notranslate nohighlight">\(F\)</span>. Possiamo calcolare i residui <span class="math notranslate nohighlight">\(E_1\)</span> del modello:</p>
<div class="math notranslate nohighlight">
\[
Y_1 = b_{01} + b_{11}F + E_1.
\]</div>
<p>La componente di <span class="math notranslate nohighlight">\(Y_1\)</span> linearmente indipendente da <span class="math notranslate nohighlight">\(F\)</span> è quindi data dai residui <span class="math notranslate nohighlight">\(E_1\)</span>. Possiamo eseguire un’operazione analoga per <span class="math notranslate nohighlight">\(Y_2\)</span> per trovare la sua componente ortogonale a <span class="math notranslate nohighlight">\(F\)</span>. Calcolando la correlazione tra le due componenti così ottenute si ottiene la correlazione parziale tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span> al netto dell’effetto lineare di <span class="math notranslate nohighlight">\(F\)</span>.</p>
<p>L’eq. <a class="reference internal" href="#equation-eq-corr-parz">(20.3)</a> consente di calcolare la correlazione parziale tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span> al netto dell’effetto di <span class="math notranslate nohighlight">\(F\)</span> a partire dalle correlazioni semplici tra le tre variabili <span class="math notranslate nohighlight">\(Y_1\)</span>, <span class="math notranslate nohighlight">\(Y_2\)</span> e <span class="math notranslate nohighlight">\(F\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-corr-parz">
<span class="eqno">(20.3)<a class="headerlink" href="#equation-eq-corr-parz" title="Permalink to this equation">#</a></span>\[
\begin{equation}
r_{1,2 \mid F} = \frac{r_{12} - r_{1F}r_{2F}}{\sqrt{(1-r_{1F}^2)(1-r_{2F}^2)}}
\end{equation}
\]</div>
<p>In particolare, la correlazione parziale <span class="math notranslate nohighlight">\(r_{1,2 \mid F}\)</span> è data dalla differenza tra la correlazione <span class="math notranslate nohighlight">\(r_{12}\)</span> tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span> e il prodotto tra le correlazioni <span class="math notranslate nohighlight">\(r_{1F}\)</span> e <span class="math notranslate nohighlight">\(r_{2F}\)</span> tra ciascuna delle due variabili e <span class="math notranslate nohighlight">\(F\)</span>, il tutto diviso per la radice quadrata del prodotto delle differenze tra 1 e i quadrati delle correlazioni tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(F\)</span> e tra <span class="math notranslate nohighlight">\(Y_2\)</span> e <span class="math notranslate nohighlight">\(F\)</span>. In altre parole, la formula tiene conto dell’effetto di <span class="math notranslate nohighlight">\(F\)</span> sulle correlazioni tra <span class="math notranslate nohighlight">\(Y_1\)</span> e <span class="math notranslate nohighlight">\(Y_2\)</span> per ottenere una stima della relazione diretta tra le due variabili, eliminando l’effetto del fattore comune.</p>
<p>Consideriamo un esempio numerico. Sia <span class="math notranslate nohighlight">\(f\)</span> una variabile su cui misuriamo <span class="math notranslate nohighlight">\(n\)</span> valori</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">set.seed</span><span class="p">(</span><span class="m">123</span><span class="p">)</span>
<span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">1000</span>
<span class="n">f</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">24</span><span class="p">,</span><span class="w"> </span><span class="m">12</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Siano <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> funzioni lineari di <span class="math notranslate nohighlight">\(f\)</span>, a cui viene aggiunta una componente d’errore gaussiano:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">y1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="m">7</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
<span class="n">y2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">3</span><span class="w">  </span><span class="o">+</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">f</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nf">rnorm</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="w"> </span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La correlazione tra <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> (<span class="math notranslate nohighlight">\(r_{12}= 0.355\)</span>) deriva dal fatto che <span class="math notranslate nohighlight">\(\hat{y}_1\)</span> e <span class="math notranslate nohighlight">\(\hat{y}_2\)</span> sono entrambe funzioni lineari di <span class="math notranslate nohighlight">\(f\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">Y</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cbind</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">,</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="n">R</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">cor</span><span class="p">(</span><span class="n">Y</span><span class="p">)</span>
<span class="nf">round</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Eseguiamo le regressioni di <span class="math notranslate nohighlight">\(y_1\)</span> su <span class="math notranslate nohighlight">\(f\)</span> e di <span class="math notranslate nohighlight">\(y_2\)</span> su <span class="math notranslate nohighlight">\(F\)</span>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fm1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y1</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
<span class="n">fm2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">lm</span><span class="p">(</span><span class="n">y2</span><span class="w"> </span><span class="o">~</span><span class="w"> </span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Nella regressione, ciascuna osservazione <span class="math notranslate nohighlight">\(y_{i1}\)</span> viene scomposta in due componenti linearmente indipendenti, i valori adattati <span class="math notranslate nohighlight">\(\hat{y}_{i}\)</span> e i residui, <span class="math notranslate nohighlight">\(e_{i}\)</span>: <span class="math notranslate nohighlight">\(y_i = \hat{y}_i + e_1\)</span>. Nel caso di <span class="math notranslate nohighlight">\(y_1\)</span> abbiamo</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">round</span><span class="p">(</span><span class="nf">head</span><span class="p">(</span><span class="nf">cbind</span><span class="p">(</span><span class="n">y1</span><span class="p">,</span><span class="w"> </span><span class="n">y1.hat</span><span class="o">=</span><span class="n">fm1</span><span class="o">$</span><span class="n">fit</span><span class="p">,</span><span class="w"> </span><span class="n">e</span><span class="o">=</span><span class="n">fm1</span><span class="o">$</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">fm1</span><span class="o">$</span><span class="n">fit</span><span class="o">+</span><span class="n">fm1</span><span class="o">$</span><span class="n">res</span><span class="p">)),</span><span class="w"> </span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Lo stesso può dirsi di <span class="math notranslate nohighlight">\(y_2\)</span>. La correlazione parziale <span class="math notranslate nohighlight">\(r_{12 \mid f}\)</span>
tra <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> dato <span class="math notranslate nohighlight">\(f\)</span> è uguale alla correlazione di Pearson tra i
residui <span class="math notranslate nohighlight">\(e_1\)</span> e <span class="math notranslate nohighlight">\(e_2\)</span> calcolati mediante i due modelli di regressione
descritti sopra:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">cor</span><span class="p">(</span><span class="n">fm1</span><span class="o">$</span><span class="n">res</span><span class="p">,</span><span class="w"> </span><span class="n">fm2</span><span class="o">$</span><span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La correlazione parziale tra <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> al netto di <span class="math notranslate nohighlight">\(f\)</span> è .02829.</p>
<p>Per i dati esaminati sopra, dunque, la correlazione parziale tra le
variabili <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> diventa uguale a zero se la variabile <span class="math notranslate nohighlight">\(f\)</span> viene
controllata (ovvero, se escludiamo da <span class="math notranslate nohighlight">\(y_1\)</span> e da <span class="math notranslate nohighlight">\(y_2\)</span> l’effetto lineare
di <span class="math notranslate nohighlight">\(f\)</span>). Il fatto che la correlazione parziale sia zero significa che la
correlazione che abbiamo osservato tra <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> (<span class="math notranslate nohighlight">\(r = 0.355\)</span>) non
dipendeva dall’effetto che una variabile <span class="math notranslate nohighlight">\(y\)</span> esercitava sull’altra, ma
bensì dal fatto che c’era una terza variabile, <span class="math notranslate nohighlight">\(f\)</span>, che influenzava sia
<span class="math notranslate nohighlight">\(y_1\)</span> sia <span class="math notranslate nohighlight">\(y_2\)</span>. In altre parole, le variabili <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> sono
condizionalmente indipendenti dato <span class="math notranslate nohighlight">\(f\)</span>. Ciò significa, come abbiamo
visto sopra, che la componente di <span class="math notranslate nohighlight">\(y_1\)</span> linearmente indipendente da <span class="math notranslate nohighlight">\(f\)</span>
è incorrelata con la componente di <span class="math notranslate nohighlight">\(y_2\)</span> linearmente indipendente da
<span class="math notranslate nohighlight">\(f\)</span>.</p>
<p>La correlazione che abbiamo calcolato tra i residui di due modelli di
regressione è identica alla correlazione che viene calcolata
applicando l’eq. <a class="reference internal" href="#equation-eq-corr-parz">(20.3)</a>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">R</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">])</span><span class="w"> </span><span class="o">/</span><span class="w"> </span>
<span class="w">  </span><span class="nf">sqrt</span><span class="p">((</span><span class="m">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="m">1</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="p">(</span><span class="m">1</span><span class="o">-</span><span class="w"> </span><span class="n">R</span><span class="p">[</span><span class="m">2</span><span class="p">,</span><span class="w"> </span><span class="m">3</span><span class="p">]</span><span class="o">^</span><span class="m">2</span><span class="p">))</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">round</span><span class="p">(</span><span class="m">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>In conclusione, possiamo attribuire all’eq. <a class="reference internal" href="#equation-eq-corr-parz">(20.3)</a> la seguente interpretazione: la correlazione parziale tra le variabili <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> condizionata alla variabile <span class="math notranslate nohighlight">\(f\)</span> rappresenta la correlazione tra le componenti di <span class="math notranslate nohighlight">\(y_1\)</span> e <span class="math notranslate nohighlight">\(y_2\)</span> da cui è stato rimosso l’effetto lineare di <span class="math notranslate nohighlight">\(f\)</span>. Ricordiamo il ragionamento che abbiamo svolto in precedenza per fornire un’interpretazione al coefficiente parziale del modello di regressione.</p>
</section>
<section id="principio-base-dell-analisi-fattoriale">
<h2><span class="section-number">20.4. </span>Principio base dell’analisi fattoriale<a class="headerlink" href="#principio-base-dell-analisi-fattoriale" title="Permalink to this heading">#</a></h2>
<p>Nell’attuale pratica dell’inferenza statistica nell’analisi fattoriale, spesso si utilizzano stime della massima verosimiglianza, calcolate attraverso procedure iterative come l’algoritmo EM (Rubin &amp; Thayer, 1982). Tuttavia, all’inizio dell’analisi fattoriale, la procedura di estrazione dei fattori si basava sulle relazioni invarianti che il modello fattoriale imponeva agli elementi della matrice di covarianza delle variabili osservate. Uno dei più noti tra questi invarianti è la <em>tetrade</em>, presente nei modelli ad un fattore.</p>
<p>La tetrade consiste in una combinazione di quattro correlazioni. Se l’associazione tra le variabili osservate dipende dal fatto che queste sono state generate causalmente da un fattore comune inosservabile, allora è possibile generare una combinazione delle correlazioni che annulla la tetrade. In altre parole, l’analisi fattoriale si propone di individuare un insieme di sole <span class="math notranslate nohighlight">\(m&lt;p\)</span> variabili latenti che, al netto dei fattori comuni, annullano significativamente tutte le correlazioni parziali tra le <span class="math notranslate nohighlight">\(p\)</span> variabili osservate. Se il metodo della correlazione parziale consente di identificare <span class="math notranslate nohighlight">\(m\)</span> variabili latenti, allora lo psicologo può concludere che tali fattori corrispondono agli <span class="math notranslate nohighlight">\(m\)</span> costrutti che intende misurare.</p>
<p>Per illustrare il metodo dell’annullamento della tetrade, consideriamo la matrice di correlazioni riportata nella Tabella seguente.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\xi\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y_1\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y_2\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y_3\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y_4\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(y_5\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(\xi\)</span></p></td>
<td><p><strong>1.00</strong></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(y_1\)</span></p></td>
<td><p><strong>0.90</strong></p></td>
<td><p>1.00</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(y_2\)</span></p></td>
<td><p><strong>0.80</strong></p></td>
<td><p>0.72</p></td>
<td><p>1.00</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(y_3\)</span></p></td>
<td><p><strong>0.70</strong></p></td>
<td><p>0.63</p></td>
<td><p>0.56</p></td>
<td><p>1.00</p></td>
<td><p></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><span class="math notranslate nohighlight">\(y_4\)</span></p></td>
<td><p><strong>0.60</strong></p></td>
<td><p>0.54</p></td>
<td><p>0.48</p></td>
<td><p>0.42</p></td>
<td><p>1.00</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><span class="math notranslate nohighlight">\(y_5\)</span></p></td>
<td><p><strong>0.50</strong></p></td>
<td><p>0.45</p></td>
<td><p>0.40</p></td>
<td><p>0.35</p></td>
<td><p>0.30</p></td>
<td><p>1.00</p></td>
</tr>
</tbody>
</table>
<p>Matrice di correlazioni nella quale tutte le correlazioni parziali
tra le variabili <span class="math notranslate nohighlight">\(Y\)</span> al netto dell’effetto di <span class="math notranslate nohighlight">\(\xi\)</span> sono nulle.</p>
<p>Nella tabella, la correlazione parziale tra ciascuna coppia di variabili <span class="math notranslate nohighlight">\(y_i\)</span>, <span class="math notranslate nohighlight">\(y_j\)</span> (con <span class="math notranslate nohighlight">\(i \neq j\)</span>) dato <span class="math notranslate nohighlight">\(\xi\)</span> è sempre pari a zero. Ad esempio, la correlazione parziale tra <span class="math notranslate nohighlight">\(y_3\)</span> e <span class="math notranslate nohighlight">\(y_5\)</span> condizionata a <span class="math notranslate nohighlight">\(\xi\)</span> è:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{aligned}
  r_{35 \mid \xi} &amp;= \frac{r_{35} - r_{3\xi}r_{5\xi}}
  {\sqrt{(1-r_{3\xi}^2)(1-r_{5\xi}^2)}} \notag \\[12pt]
  &amp;= \frac{0.35 - 0.7 \times 0.5}
  {\sqrt{(1-0.7^2)(1-0.5^2)}} = 0. \notag
  \end{aligned}
\end{equation}
\end{split}\]</div>
<p>Lo stesso risultato si trova per qualunque altra coppia di variabili <span class="math notranslate nohighlight">\(y_i\)</span> e
<span class="math notranslate nohighlight">\(y_j\)</span>, ovvero <span class="math notranslate nohighlight">\(r_{ij \mid \xi} = 0\)</span>. Possiamo dunque dire che, per la matrice di correlazioni della Tabella, esiste un’unica variabile <span class="math notranslate nohighlight">\(\xi\)</span> la
quale, quando viene controllata, spiega tutte le</p>
<div class="math notranslate nohighlight">
\[
p(p-1)/2 = 5(5-1)/2=10
\]</div>
<p>correlazioni tra le variabili <span class="math notranslate nohighlight">\(y\)</span>. Questo risultato non è sorprendente, in quanto la matrice di correlazioni è stata costruita in modo tale da possedere tale proprietà.</p>
<p>Immaginiamo invece di trovarci in una situazione diversa, ovvero di avere a disposizione solo le variabili <span class="math notranslate nohighlight">\(y_i\)</span> senza conoscere <span class="math notranslate nohighlight">\(\xi\)</span>. In questo caso, ci poniamo la domanda: “Esiste una variabile latente <span class="math notranslate nohighlight">\(\xi\)</span> tale che, se fosse osservabile, renderebbe nulle tutte le correlazioni parziali tra le variabili <span class="math notranslate nohighlight">\(y\)</span>?”. Se esiste una tale variabile latente che spiega tutte le correlazioni tra le variabili osservate <span class="math notranslate nohighlight">\(y\)</span>, allora viene chiamata <em>fattore latente</em>.</p>
<p>Un fattore è una variabile inosservabile in grado di rendere significativamente nulle tutte le correlazioni parziali tra le variabili manifeste.</p>
<section id="vincoli-sulle-correlazioni">
<h3><span class="section-number">20.4.1. </span>Vincoli sulle correlazioni<a class="headerlink" href="#vincoli-sulle-correlazioni" title="Permalink to this heading">#</a></h3>
<p>Come si può stabilire se esiste una variabile inosservabile in grado di
rendere nulle tutte le correlazioni parziali tra le variabili osservate?
Riscriviamo l’eq. <a class="reference internal" href="#equation-eq-corr-parz">(20.3)</a> per specificare la correlazione parziale tra
le variabili <span class="math notranslate nohighlight">\(y_i\)</span> e <span class="math notranslate nohighlight">\(y_j\)</span> dato <span class="math notranslate nohighlight">\(\xi\)</span>:</p>
<div class="math notranslate nohighlight">
\[
  r_{ij \mid \xi} = \frac{r_{ij} - r_{i\xi}r_{j\xi}}
  {\sqrt{(1-r_{i\xi}^2)(1-r_{j\xi}^2)}}
\]</div>
<p>Affinché <span class="math notranslate nohighlight">\(r_{ij \mid \xi}\)</span> sia uguale a zero è necessario che</p>
<div class="math notranslate nohighlight">
\[
r_{ij} - r_{i\xi}r_{j\xi}=0
\]</div>
<p>ovvero</p>
<div class="math notranslate nohighlight">
\[
r_{ij} = r_{i\xi}r_{j\xi}.
\]</div>
<p>In altri termini, se esiste un fattore non osservato <span class="math notranslate nohighlight">\(\xi\)</span> in grado di
rendere uguali a zero tutte le correlazioni parziali <span class="math notranslate nohighlight">\(r_{ih \mid \xi}\)</span>,
allora la correlazione tra ciascuna coppia di variabili <span class="math notranslate nohighlight">\(y\)</span> deve essere
uguale al prodotto delle correlazioni tra ciascuna <span class="math notranslate nohighlight">\(y\)</span> e il fattore
latente <span class="math notranslate nohighlight">\(\xi\)</span>. Questo è il principio base dell’analisi fattoriale.</p>
</section>
<section id="teoria-dei-due-fattori">
<h3><span class="section-number">20.4.2. </span>Teoria dei Due Fattori<a class="headerlink" href="#teoria-dei-due-fattori" title="Permalink to this heading">#</a></h3>
<p>Per fornire un esempio concreto del metodo dell’annullamento della tetrade, possiamo esaminare la matrice di correlazioni utilizzata da Spearman (1904) nella sua ricerca sulle capacità intellettuali di alcuni studenti di una scuola superiore. In particolare, sono state considerate le prestazioni degli studenti in tre materie scolastiche (studio dei classici, letteratura inglese, abilità matematiche) e in un compito di discriminazione dell’altezza di suoni. Secondo la Teoria dei Due Fattori di Spearman, le prestazioni in ogni compito intellettuale sono costituite da due componenti: un fattore generale comune a tutte le attività intellettuali (fattore “g”) e un fattore specifico relativo al compito in questione (fattore “s”). In questo modello, il fattore “g” rappresenta la componente invariante dell’abilità intellettiva, mentre il fattore “s” è una componente che varia da condizione a condizione.</p>
<p>Per verificare l’esistenza di una variabile latente in grado di spiegare le correlazioni tra le variabili osservate da Spearman, è stato proposto uno strumento chiamato “annullamento della tetrade”. Tale strumento si basa sui vincoli sulle correlazioni derivanti dalla definizione di correlazione parziale. Come abbiamo visto in precedenza, la correlazione parziale tra le variabili <span class="math notranslate nohighlight">\(y\)</span> indicizzate da <span class="math notranslate nohighlight">\(i\)</span> e <span class="math notranslate nohighlight">\(j\)</span>, al netto dell’effetto di <span class="math notranslate nohighlight">\(\xi\)</span>, è nulla se la seguente relazione è soddisfatta:</p>
<div class="math notranslate nohighlight">
\[
r_{ij} = r_{i\xi}r_{j\xi}.
\]</div>
<p>In altre parole, se la correlazione tra due variabili osservate può essere spiegata dall’effetto di una terza variabile latente, allora la correlazione parziale tra tali variabili sarà nulla una volta che si tiene conto dell’effetto della variabile latente. Utilizzando questo strumento, Spearman ha dimostrato che le correlazioni tra le prestazioni degli studenti nei vari compiti intellettuali possono essere spiegate da due fattori: un fattore generale comune a tutti i compiti (fattore “g”) e un fattore specifico a ciascun compito (fattore “s”).</p>
<p>Nel caso dei dati di Spearman, le correlazioni parziali sono nulle quando la correlazione tra “studi classici” e “letteratura inglese” è pari al prodotto della correlazione tra “studi classici” e la variabile latente <span class="math notranslate nohighlight">\(\xi\)</span> e della correlazione tra “letteratura inglese” e la variabile latente <span class="math notranslate nohighlight">\(\xi\)</span>. Inoltre, la correlazione tra “studi classici” e “abilità matematica” deve essere uguale al prodotto della correlazione tra “studi classici” e la variabile latente <span class="math notranslate nohighlight">\(\xi\)</span> e della correlazione tra “abilità matematica” e la variabile latente <span class="math notranslate nohighlight">\(\xi\)</span>, e così via per tutte le altre coppie di variabili.</p>
<p>Le correlazioni tra le variabili manifeste e il fattore latente sono
dette <em>saturazioni fattoriali</em> e vengono denotate con la lettera
<span class="math notranslate nohighlight">\(\lambda\)</span>. Se il modello di Spearman è corretto, avremo che</p>
<div class="math notranslate nohighlight">
\[
r_{ec}=\lambda_e \times \lambda_{c},
\]</div>
<p>dove <span class="math notranslate nohighlight">\(r_{ec}\)</span> è la correlazione tra “letteratura inglese” (e) e “studi classici” (c), <span class="math notranslate nohighlight">\(\lambda_e\)</span> è la correlazione tra “letteratura inglese” e <span class="math notranslate nohighlight">\(\xi\)</span>, e <span class="math notranslate nohighlight">\(\lambda_{c}\)</span> è la
correlazione tra “studi classici” e <span class="math notranslate nohighlight">\(\xi\)</span>.</p>
<p>Allo stesso modo, la correlazione tra “studi classici” e “matematica”
(m) dovrà essere uguale a</p>
<div class="math notranslate nohighlight">
\[
\lambda_c \times \lambda_m,
\]</div>
<p>eccetera.</p>
</section>
<section id="annullamento-della-tetrade">
<h3><span class="section-number">20.4.3. </span>Annullamento della tetrade<a class="headerlink" href="#annullamento-della-tetrade" title="Permalink to this heading">#</a></h3>
<p>Utilizzando il metodo dell’annullamento della tetrade è possibile stimare i valori delle saturazioni fattoriali <span class="math notranslate nohighlight">\(\lambda\)</span>, partendo dalle correlazioni tra le tre coppie di variabili manifeste <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(m\)</span> ed <span class="math notranslate nohighlight">\(e\)</span>. In particolare, si possono scrivere tre equazioni in tre incognite, che consentono di calcolare le saturazioni <span class="math notranslate nohighlight">\(\lambda\)</span>. Ad esempio, per le tre variabili sopracitate, tali equazioni possono essere espresse nel seguente modo:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{aligned}
  r_{cm} &amp;= \lambda_c \times \lambda_m, \notag \\
  r_{em} &amp;= \lambda_e \times \lambda_m,  \\
  r_{ce} &amp;= \lambda_c \times \lambda_e. \notag
\end{aligned}
\end{equation}
\end{split}\]</div>
<p>Calcolando il determinante del sistema di equazioni lineari composto dalle correlazioni tra le variabili manifeste <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(m\)</span> ed <span class="math notranslate nohighlight">\(e\)</span>, possiamo ottenere il valore della saturazione fattoriale <span class="math notranslate nohighlight">\(\lambda\)</span> e, in particolare, il coefficiente di saturazione <span class="math notranslate nohighlight">\(\lambda_m\)</span> della variabile <span class="math notranslate nohighlight">\(y_m\)</span> nel fattore comune <span class="math notranslate nohighlight">\(\xi\)</span>. In altre parole, risolvendo il sistema di equazioni lineari, possiamo stimare il valore delle saturazioni fattoriali, compreso il coefficiente di saturazione <span class="math notranslate nohighlight">\(\lambda_m\)</span>, a partire dalle correlazioni tra le variabili manifeste:</p>
<div class="math notranslate nohighlight" id="equation-eq-tetradi">
<span class="eqno">(20.4)<a class="headerlink" href="#equation-eq-tetradi" title="Permalink to this equation">#</a></span>\[
\begin{equation}
\lambda_m = \sqrt{ \frac{r_{cm} r_{em}}{r_{ce}}}.
\end{equation}
\]</div>
<p>Lo stesso vale per le altre due saturazioni <span class="math notranslate nohighlight">\(\lambda_c\)</span> e <span class="math notranslate nohighlight">\(\lambda_e\)</span>.</p>
<p>Nel suo articolo del 1904, Spearman osservò le seguenti correlazioni tra
le variabili <span class="math notranslate nohighlight">\(Y_c\)</span>, <span class="math notranslate nohighlight">\(Y_e\)</span>, <span class="math notranslate nohighlight">\(Y_m\)</span> e <span class="math notranslate nohighlight">\(Y_p\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}{ccccc}
  \hline
    &amp; Y_C &amp; Y_E &amp; Y_M &amp; Y_P \\
  \hline
  Y_C &amp; 1.00 &amp; 0.78 &amp; 0.70 &amp; 0.66 \\
  Y_E &amp;   &amp; 1.00 &amp; 0.64 &amp; 0.54 \\
  Y_M &amp;   &amp;   &amp; 1.00 &amp; 0.45 \\
  Y_P &amp;   &amp;   &amp;   &amp; 1.00 \\
  \hline
\end{array}
\end{split}\]</div>
<p>Utilizzando l’eq. <a class="reference internal" href="#equation-eq-tetradi">(20.4)</a>, mediante le correlazioni <span class="math notranslate nohighlight">\(r_{cm}\)</span>, <span class="math notranslate nohighlight">\(r_{em}\)</span>, e
<span class="math notranslate nohighlight">\(r_{ce}\)</span> fornite dalla tabella precedente, la saturazione <span class="math notranslate nohighlight">\(\lambda_m\)</span>
diventa uguale a:</p>
<div class="math notranslate nohighlight">
\[
  \hat{\lambda}_m = \sqrt{ \frac{r_{cm} r_{em}}{r_{ce}} } = \sqrt{
    \frac{0.70 \times 0.64}{0.78} } = 0.76.
\]</div>
<p>È importante notare che il metodo dell’annullamento della tetrade
produce risultati falsificabili. Infatti, ci sono modi diversi per
calcolare la stessa saturazione fattoriale. Se il modello fattoriale è
corretto si deve ottenere lo stesso risultato in tutti i casi. Nel caso
presente, la saturazione fattoriale <span class="math notranslate nohighlight">\(\lambda_m\)</span> può essere calcolata in
altri due modi:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{equation}
\begin{aligned}
  \hat{\lambda}_m &amp;= \sqrt{ \frac{r_{cm} r_{mp}}{r_{cp}} } = \sqrt{ \frac{0.78 \times 0.45}{0.66} } = 0.69, \notag \\
  \hat{\lambda}_m &amp;= \sqrt{ \frac{r_{em} r_{mp}}{r_{ep}} } = \sqrt{
    \frac{0.64 \times 0.45}{0.54} } = 0.73. \notag\end{aligned}
\end{equation}
\end{split}\]</div>
<p>I tre valori che sono stati ottenuti sono molto simili. Qual è allora la stima
migliore di <span class="math notranslate nohighlight">\(\lambda_m\)</span>?</p>
</section>
<section id="metodo-del-centroide">
<h3><span class="section-number">20.4.4. </span>Metodo del centroide<a class="headerlink" href="#metodo-del-centroide" title="Permalink to this heading">#</a></h3>
<p>La soluzione più semplice è quella di fare la media di questi tre valori
(<span class="math notranslate nohighlight">\(\bar{\lambda}_m = 0.73\)</span>). Un metodo migliore (meno vulnerabile ai
valori anomali) è dato dal rapporto tra la somma dei numeratori e dei
denominatori:</p>
<div class="math notranslate nohighlight">
\[
  \hat{\lambda}_m = \sqrt{ \frac{0.70 \times 0.64 + 0.78 \times 0.45 + 0.64
      \times 0.45}{0.78+0.66+0.54} } = 0.73
\]</div>
<p>In questo caso, i due metodi danno lo stesso risultato. Le altre tre
saturazioni fattoriali trovate mediante il metodo del centroide sono:</p>
<div class="math notranslate nohighlight">
\[
\hat{\lambda}_c = 0.97, \quad \hat{\lambda}_e = 0.84, \quad
\hat{\lambda}_p = 0.65.
\]</div>
<p>In conclusione,</p>
<div class="math notranslate nohighlight">
\[
\boldsymbol{\hat{\Lambda}}^\prime=
(\hat{\lambda}_c, \hat{\lambda}_e, \hat{\lambda}_m, \hat{\lambda}_p) = (0.97, 0.84, 0.73, 0.65).
\]</div>
<!-- Il calcolo delle saturazioni fattoriali con il metodo del centroide aveva prodotto il risultato: $\boldsymbol{\hat{\Lambda}}'= (0.97, 0.84, 0.73, 0.65)$. Si noti che i due metodi producono risultati simili. -->
</section>
</section>
<section id="introduzione-a-lavaan">
<h2><span class="section-number">20.5. </span>Introduzione a <code class="docutils literal notranslate"><span class="pre">lavaan</span></code><a class="headerlink" href="#introduzione-a-lavaan" title="Permalink to this heading">#</a></h2>
<section id="sintassi-del-modello">
<h3><span class="section-number">20.5.1. </span>Sintassi del modello<a class="headerlink" href="#sintassi-del-modello" title="Permalink to this heading">#</a></h3>
<p>Al cuore del pacchetto lavaan si trova la “sintassi del modello”. La sintassi del modello è una descrizione del modello da stimare. In questa sezione, spieghiamo brevemente gli elementi della sintassi del modello lavaan.</p>
<p>Nell’ambiente R, una formula di regressione ha la seguente forma:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">~</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span> <span class="o">+</span> <span class="n">x3</span> <span class="o">+</span> <span class="n">x4</span>
</pre></div>
</div>
<p>In questa formula, la tilde (“~”) è l’operatore di regressione. Sul lato sinistro dell’operatore, abbiamo la variabile dipendente (y), e sul lato destro abbiamo le variabili indipendenti, separate dall’operatore “+” . In lavaan, un modello tipico è semplicemente un insieme (o sistema) di formule di regressione, in cui alcune variabili (che iniziano con una ‘f’ qui sotto) possono essere latenti. Ad esempio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span> <span class="o">~</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>
<span class="n">f1</span> <span class="o">~</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span>
<span class="n">f2</span> <span class="o">~</span> <span class="n">f3</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>
</pre></div>
</div>
<p>Se abbiamo variabili latenti in una qualsiasi delle formule di regressione, dobbiamo “definirle” elencando i loro indicatori (manifesti o latenti). Lo facciamo utilizzando l’operatore speciale “=~”, che può essere letto come “è misurato da”. Ad esempio, per definire le tre variabili latenti f1, f2 e f3, possiamo usare qualcosa del genere:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f1</span> <span class="o">=~</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">y3</span>
<span class="n">f2</span> <span class="o">=~</span> <span class="n">y4</span> <span class="o">+</span> <span class="n">y5</span> <span class="o">+</span> <span class="n">y6</span>
<span class="n">f3</span> <span class="o">=~</span> <span class="n">y7</span> <span class="o">+</span> <span class="n">y8</span> <span class="o">+</span> <span class="n">y9</span> <span class="o">+</span> <span class="n">y10</span>
</pre></div>
</div>
<p>Inoltre, le varianze e le covarianze sono specificate utilizzando un operatore “doppia tilde”, ad esempio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y1</span> <span class="o">~~</span> <span class="n">y1</span> <span class="c1"># varianza</span>
<span class="n">y1</span> <span class="o">~~</span> <span class="n">y2</span> <span class="c1"># covarianza</span>
<span class="n">f1</span> <span class="o">~~</span> <span class="n">f2</span> <span class="c1"># covarianza</span>
</pre></div>
</div>
<p>E infine, le intercette per le variabili osservate e latenti sono semplici formule di regressione con solo una intercetta (esplicitamente indicato dal numero “1”) come unico predittore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y1</span> <span class="o">~</span> <span class="mi">1</span>
<span class="n">f1</span> <span class="o">~</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Utilizzando questi quattro tipi di formule, è possibile descrivere una vasta gamma di modelli di variabili latenti. L’attuale insieme di tipi di formula è riassunto nella tabella sottostante.</p>
<table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>tipo di formula</p></th>
<th class="head"><p>operatore</p></th>
<th class="head"><p>mnemonic</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>definizione variabile latente</p></td>
<td><p>=~</p></td>
<td><p>è misurato da</p></td>
</tr>
<tr class="row-odd"><td><p>regressione</p></td>
<td><p>~</p></td>
<td><p>viene regredito su</p></td>
</tr>
<tr class="row-even"><td><p>(co)varianza (residuale)</p></td>
<td><p>~~</p></td>
<td><p>è correlato con</p></td>
</tr>
<tr class="row-odd"><td><p>intercetta</p></td>
<td><p>~ 1</p></td>
<td><p>intercetta</p></td>
</tr>
</tbody>
</table>
<p>Una sintassi completa del modello lavaan è semplicemente una combinazione di questi tipi di formule, racchiusi tra virgolette singole. Ad esempio:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">my_model</span> <span class="o">&lt;-</span> <span class="s1">&#39; </span>
  <span class="c1"># regressions</span>
  <span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">~</span> <span class="n">f1</span> <span class="o">+</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>
  <span class="n">f1</span> <span class="o">~</span> <span class="n">f2</span> <span class="o">+</span> <span class="n">f3</span>
  <span class="n">f2</span> <span class="o">~</span> <span class="n">f3</span> <span class="o">+</span> <span class="n">x1</span> <span class="o">+</span> <span class="n">x2</span>

  <span class="c1"># latent variable definitions </span>
  <span class="n">f1</span> <span class="o">=~</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">y2</span> <span class="o">+</span> <span class="n">y3</span> 
  <span class="n">f2</span> <span class="o">=~</span> <span class="n">y4</span> <span class="o">+</span> <span class="n">y5</span> <span class="o">+</span> <span class="n">y6</span> 
  <span class="n">f3</span> <span class="o">=~</span> <span class="n">y7</span> <span class="o">+</span> <span class="n">y8</span> <span class="o">+</span> <span class="n">y9</span>
  
  <span class="c1"># variances and covariances </span>
  <span class="n">y1</span> <span class="o">~~</span> <span class="n">y1</span> 
  <span class="n">y1</span> <span class="o">~~</span> <span class="n">y2</span> 
  <span class="n">f1</span> <span class="o">~~</span> <span class="n">f2</span>

  <span class="c1"># intercepts </span>
  <span class="n">y1</span> <span class="o">~</span> <span class="mi">1</span> 
  <span class="n">f1</span> <span class="o">~</span> <span class="mi">1</span>
<span class="s1">&#39;</span>
</pre></div>
</div>
<p>Per adattare il modello ai dati usiamo la seguente sintassi.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fit</span> <span class="o">&lt;-</span> <span class="n">cfa</span><span class="p">(</span><span class="n">model</span> <span class="o">=</span> <span class="n">my_model</span><span class="p">,</span> <span class="n">data</span> <span class="o">=</span> <span class="n">my_data</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="un-esempio-concreto">
<h3><span class="section-number">20.5.2. </span>Un esempio concreto<a class="headerlink" href="#un-esempio-concreto" title="Permalink to this heading">#</a></h3>
<p>Analizziamo nuovamente i dati di Spearman che abbiamo esaminato in precedenza usando <code class="docutils literal notranslate"><span class="pre">lavaan</span></code>. La matrice completa dei dati di Spearman è messa a disposizione da &#64;kan2019extending. Iniziamo a caricare i pacchetti necessari:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="s">&quot;lavaan&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;semPlot&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;knitr&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;kableExtra&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;tidyr&quot;</span><span class="p">)</span>
<span class="nf">library</span><span class="p">(</span><span class="s">&quot;corrplot&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Attaching package: ‘kableExtra’


The following object is masked from ‘package:dplyr’:

    group_rows


corrplot 0.92 loaded
</pre></div>
</div>
</div>
</div>
<p>Specifichiamo il nome delle variabili manifeste</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">varnames</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span>
<span class="w">  </span><span class="s">&quot;Classics&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;French&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;English&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Math&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Pitch&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Music&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>e il loro numero</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">ny</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">length </span><span class="p">(</span><span class="n">varnames</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Creiamo la matrice di correlazione:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">spearman_cor_mat</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">matrix</span><span class="p">(</span>
<span class="w">  </span><span class="nf">c</span><span class="p">(</span>
<span class="w">    </span><span class="m">1.00</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">83</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">78</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">70</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">66</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">63</span><span class="p">,</span>
<span class="w">     </span><span class="n">.</span><span class="m">83</span><span class="p">,</span><span class="w"> </span><span class="m">1.00</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">67</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">67</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">65</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">57</span><span class="p">,</span>
<span class="w">     </span><span class="n">.</span><span class="m">78</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">67</span><span class="p">,</span><span class="w"> </span><span class="m">1.00</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">64</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">54</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">51</span><span class="p">,</span>
<span class="w">     </span><span class="n">.</span><span class="m">70</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">67</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">64</span><span class="p">,</span><span class="w"> </span><span class="m">1.00</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">45</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">51</span><span class="p">,</span>
<span class="w">     </span><span class="n">.</span><span class="m">66</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">65</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">54</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">45</span><span class="p">,</span><span class="w"> </span><span class="m">1.00</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">40</span><span class="p">,</span>
<span class="w">     </span><span class="n">.</span><span class="m">63</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">57</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">51</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">51</span><span class="p">,</span><span class="w">  </span><span class="n">.</span><span class="m">40</span><span class="p">,</span><span class="w"> </span><span class="m">1.00</span>
<span class="w">  </span><span class="p">),</span>
<span class="w">  </span><span class="n">ny</span><span class="p">,</span><span class="w"> </span><span class="n">ny</span><span class="p">,</span>
<span class="w">  </span><span class="n">byrow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span>
<span class="w">  </span><span class="n">dimnames</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">list</span><span class="p">(</span><span class="n">varnames</span><span class="p">,</span><span class="w"> </span><span class="n">varnames</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Specifichiamo l’ampiezza campionaria:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">n</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="m">33</span>
</pre></div>
</div>
</div>
</div>
<p>Definiamo il modello unifattoriale in <code class="docutils literal notranslate"><span class="pre">lavaan</span></code>. L’operatore <code class="docutils literal notranslate"><span class="pre">=~</span></code> si può leggere dicendo che la variabile latente a sinistra dell’operatore viene identificata dalle variabili manifeste elencate a destra dell’operatore e separate dal segno <code class="docutils literal notranslate"><span class="pre">+</span></code>. Per il caso presente, il modello dei due fattori di Spearman può essere specificato come segue.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">spearman_mod</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&quot;</span>
<span class="s">  g =~ Classics + French + English + Math + Pitch + Music</span>
<span class="s">&quot;</span>
</pre></div>
</div>
</div>
</div>
<p>Adattiamo il modello ai dati con la funzione <code class="docutils literal notranslate"><span class="pre">cfa()</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fit1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lavaan</span><span class="o">::</span><span class="nf">cfa</span><span class="p">(</span>
<span class="w">  </span><span class="n">spearman_mod</span><span class="p">,</span>
<span class="w">  </span><span class="n">sample.cov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spearman_cor_mat</span><span class="p">,</span>
<span class="w">  </span><span class="n">sample.nobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span>
<span class="w">  </span><span class="n">std.lv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>La funzione cfa() è una funzione dedicata per adattare modelli di analisi fattoriale confermativa. Il primo argomento è il modello specificato dall’utente. Il secondo argomento è il dataset che contiene le variabili osservate. L’argomento <code class="docutils literal notranslate"><span class="pre">std.lv</span> <span class="pre">=</span> <span class="pre">TRUE</span></code> specifica che imponiamo una varianza pari a 1 a tutte le variabili latenti comuni (nel caso presente, solo una). Ciò consente di  stimare le saturazioni fattoriali.</p>
<p>Una volta adattato il modello, la funzione summary() ci consente di esaminare la soluzione ottenuta:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span>
<span class="w">  </span><span class="n">fit1</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">fit.measures</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span>
<span class="w">  </span><span class="n">standardized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span>
<span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lavaan 0.6.15 ended normally after 23 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        12

  Number of observations                            33

Model Test User Model:
                                                      
  Test statistic                                 2.913
  Degrees of freedom                                 9
  P-value (Chi-square)                           0.968

Model Test Baseline Model:

  Test statistic                               133.625
  Degrees of freedom                                15
  P-value                                        0.000

User Model versus Baseline Model:

  Comparative Fit Index (CFI)                    1.000
  Tucker-Lewis Index (TLI)                       1.086

Loglikelihood and Information Criteria:

  Loglikelihood user model (H0)               -212.547
  Loglikelihood unrestricted model (H1)       -211.091
                                                      
  Akaike (AIC)                                 449.094
  Bayesian (BIC)                               467.052
  Sample-size adjusted Bayesian (SABIC)        429.622

Root Mean Square Error of Approximation:

  RMSEA                                          0.000
  90 Percent confidence interval - lower         0.000
  90 Percent confidence interval - upper         0.000
  P-value H_0: RMSEA &lt;= 0.050                    0.976
  P-value H_0: RMSEA &gt;= 0.080                    0.016

Standardized Root Mean Square Residual:

  SRMR                                           0.025

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g =~                                                                  
    Classics          0.942    0.129    7.314    0.000    0.942    0.956
    French            0.857    0.137    6.239    0.000    0.857    0.871
    English           0.795    0.143    5.545    0.000    0.795    0.807
    Math              0.732    0.149    4.923    0.000    0.732    0.743
    Pitch             0.678    0.153    4.438    0.000    0.678    0.689
    Music             0.643    0.155    4.142    0.000    0.643    0.653

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Classics          0.083    0.051    1.629    0.103    0.083    0.086
   .French            0.234    0.072    3.244    0.001    0.234    0.242
   .English           0.338    0.094    3.610    0.000    0.338    0.349
   .Math              0.434    0.115    3.773    0.000    0.434    0.447
   .Pitch             0.510    0.132    3.855    0.000    0.510    0.526
   .Music             0.556    0.143    3.893    0.000    0.556    0.573
    g                 1.000                               1.000    1.000
</pre></div>
</div>
</div>
</div>
<p>L’output consiste in tre parti. Le prime nove righe sono chiamate intestazione. L’intestazione contiene le seguenti informazioni:</p>
<ul class="simple">
<li><p>il numero di versione di lavaan</p></li>
<li><p>se l’ottimizzazione è terminata normalmente o meno e quante iterazioni sono state necessarie</p></li>
<li><p>lo stimatore utilizzato (qui: ML, per la massima verosimiglianza)</p></li>
<li><p>l’ottimizzatore utilizzato per trovare i valori dei parametri di adattamento migliori per questo stimatore (qui: NLMINB)</p></li>
<li><p>il numero di parametri del modello (qui: 12)</p></li>
<li><p>il numero di osservazioni che sono state effettivamente utilizzate nell’analisi (qui: 33)</p></li>
<li><p>una sezione chiamata “Model Test User Model”: che fornisce una statistica di test, i gradi di libertà e un valore p per il modello specificato dall’utente.</p></li>
</ul>
<p>La sezione successiva contiene ulteriori misure di adattamento e viene mostrata solo se si utilizza l’argomento opzionale fit.measures = TRUE. Inizia con la riga Model Test Baseline Model: e termina con il valore per l’SRMR. L’ultima sezione contiene le stime dei parametri. Inizia con informazioni (tecniche) sul metodo utilizzato per calcolare gli errori standard. Quindi, vengono elencati tutti i parametri liberi (e fissati) inclusi nel modello. Di solito, prima vengono mostrate le variabili latenti, seguite dalle covarianze e dalle varianze (residui). La prima colonna (Stima) contiene il valore del parametro (stimato o fisso) per ogni parametro del modello; la seconda colonna (Std.err) contiene l’errore standard per ogni parametro stimato; la terza colonna (Z-value) contiene la statistica di Wald (che viene semplicemente ottenuta dividendo il valore del parametro per il suo errore standard), e l’ultima colonna (P(&gt;|z|)) contiene il valore p per testare l’ipotesi nulla che il valore del parametro sia uguale a zero nella popolazione.</p>
<p>Si noti che nella sezione Varianze: c’è un punto prima dei nomi delle variabili osservate. Ciò perché sono variabili dipendenti (o endogene) (predette dalle variabili latenti) e quindi il valore della varianza stampato in output è una stima della varianza residua: la varianza rimanente che non è spiegata dal/i predittore/i. Al contrario, non c’è un punto prima dei nomi delle variabili latenti, perché in questo modello sono variabili esogene. I valori delle varianze qui sono le varianze totali stimate delle variabili latenti.</p>
<p>È possibile semplificare l’output dalla funzione <code class="docutils literal notranslate"><span class="pre">summary()</span></code> in maniera tale da stampare solo la tabella completa delle stime dei parametri e degli errori standard. Qui usiamo <code class="docutils literal notranslate"><span class="pre">coef(fit1)</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">print</span><span class="p">(</span><span class="nf">round</span><span class="p">(</span><span class="nf">coef</span><span class="p">(</span><span class="n">fit1</span><span class="p">),</span><span class="w"> </span><span class="m">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>       g=~Classics          g=~French         g=~English            g=~Math 
              0.94               0.86               0.79               0.73 
          g=~Pitch           g=~Music Classics~~Classics     French~~French 
              0.68               0.64               0.08               0.23 
  English~~English         Math~~Math       Pitch~~Pitch       Music~~Music 
              0.34               0.43               0.51               0.56 
</pre></div>
</div>
</div>
</div>
<p>Usando <code class="docutils literal notranslate"><span class="pre">parameterEstimates</span></code>, l’output diventa il seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">parameterEstimates</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span><span class="w"> </span><span class="n">standardized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>        lhs op      rhs   est    se     z pvalue ci.lower ci.upper std.lv
1         g =~ Classics 0.942 0.129 7.314  0.000    0.689    1.194  0.942
2         g =~   French 0.857 0.137 6.239  0.000    0.588    1.127  0.857
3         g =~  English 0.795 0.143 5.545  0.000    0.514    1.076  0.795
4         g =~     Math 0.732 0.149 4.923  0.000    0.441    1.024  0.732
5         g =~    Pitch 0.678 0.153 4.438  0.000    0.379    0.978  0.678
6         g =~    Music 0.643 0.155 4.142  0.000    0.339    0.948  0.643
7  Classics ~~ Classics 0.083 0.051 1.629  0.103   -0.017    0.183  0.083
8    French ~~   French 0.234 0.072 3.244  0.001    0.093    0.376  0.234
9   English ~~  English 0.338 0.094 3.610  0.000    0.154    0.522  0.338
10     Math ~~     Math 0.434 0.115 3.773  0.000    0.208    0.659  0.434
11    Pitch ~~    Pitch 0.510 0.132 3.855  0.000    0.251    0.769  0.510
12    Music ~~    Music 0.556 0.143 3.893  0.000    0.276    0.836  0.556
13        g ~~        g 1.000 0.000    NA     NA    1.000    1.000  1.000
   std.all std.nox
1    0.956   0.956
2    0.871   0.871
3    0.807   0.807
4    0.743   0.743
5    0.689   0.689
6    0.653   0.653
7    0.086   0.086
8    0.242   0.242
9    0.349   0.349
10   0.447   0.447
11   0.526   0.526
12   0.573   0.573
13   1.000   1.000
</pre></div>
</div>
</div>
</div>
<p>Con opportuni parametri possiamo semplificare l’output nel modo seguente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">parameterEstimates</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span><span class="w"> </span><span class="n">standardized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">filter</span><span class="p">(</span><span class="n">op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;=~&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span>
<span class="w">  </span><span class="n">dplyr</span><span class="o">::</span><span class="nf">select</span><span class="p">(</span>
<span class="w">    </span><span class="s">&quot;Latent Factor&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">lhs</span><span class="p">,</span>
<span class="w">    </span><span class="n">Indicator</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rhs</span><span class="p">,</span>
<span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">est</span><span class="p">,</span>
<span class="w">    </span><span class="n">SE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">se</span><span class="p">,</span>
<span class="w">    </span><span class="n">Z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">z</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;p-value&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">pvalue</span><span class="p">,</span>
<span class="w">    </span><span class="n">Beta</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">std.all</span>
<span class="w">  </span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  Latent.Factor Indicator     B    SE     Z p.value  Beta
1             g  Classics 0.942 0.129 7.314       0 0.956
2             g    French 0.857 0.137 6.239       0 0.871
3             g   English 0.795 0.143 5.545       0 0.807
4             g      Math 0.732 0.149 4.923       0 0.743
5             g     Pitch 0.678 0.153 4.438       0 0.689
6             g     Music 0.643 0.155 4.142       0 0.653
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo la matrice delle correlazioni residue:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">cor_table</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">residuals</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;cor&quot;</span><span class="p">)</span><span class="o">$</span><span class="n">cov</span>
<span class="nf">print</span><span class="p">(</span><span class="n">cor_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         Clsscs French Englsh   Math  Pitch  Music
Classics  0.000                                   
French   -0.003  0.000                            
English   0.008 -0.033  0.000                     
Math     -0.011  0.023  0.040  0.000              
Pitch     0.001  0.050 -0.016 -0.062  0.000       
Music     0.005  0.001 -0.017  0.024 -0.050  0.000
</pre></div>
</div>
</div>
</div>
<p>Creiamo un qq-plot dei residui:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">res1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">residuals</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;cor&quot;</span><span class="p">)</span><span class="o">$</span><span class="n">cov</span>
<span class="n">res1</span><span class="p">[</span><span class="nf">upper.tri</span><span class="p">(</span><span class="n">res1</span><span class="p">,</span><span class="w"> </span><span class="n">diag</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)]</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="kc">NA</span>
<span class="n">v1</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="nf">as.vector</span><span class="p">(</span><span class="n">res1</span><span class="p">)</span>
<span class="n">v2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">v1</span><span class="p">[</span><span class="o">!</span><span class="nf">is.na</span><span class="p">(</span><span class="n">v1</span><span class="p">)]</span>

<span class="nf">tibble</span><span class="p">(</span><span class="n">v2</span><span class="p">)</span><span class="w"> </span><span class="o">%&gt;%</span><span class="w"> </span>
<span class="w">  </span><span class="nf">ggplot</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">sample</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">v2</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">stat_qq</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span>
<span class="w">  </span><span class="nf">stat_qq_line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/07f84cc04e2ede17194a61e051540f94dfb41adc21a435567cf6d531d6178929.png" src="_images/07f84cc04e2ede17194a61e051540f94dfb41adc21a435567cf6d531d6178929.png" />
</div>
</div>
</section>
<section id="diagrammi-di-percorso">
<h3><span class="section-number">20.5.3. </span>Diagrammi di percorso<a class="headerlink" href="#diagrammi-di-percorso" title="Permalink to this heading">#</a></h3>
<p>Il pacchetto <code class="docutils literal notranslate"><span class="pre">semPlot</span></code> consente di disegnare diagrammi di percorso per vari modelli SEM. La funzione <code class="docutils literal notranslate"><span class="pre">semPaths</span></code> prende in input un oggetto creato da <code class="docutils literal notranslate"><span class="pre">lavaan</span></code> e disegna il diagramma, con diverse opzioni disponibili. Il diagramma prodotto controlla le dimensioni dei caratteri/etichette, la visualizzazione dei residui e il colore dei percorsi/coefficienti. Sono disponibili queste e molte altre opzioni di controllo.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">nice_lavaanPlot</span><span class="p">(</span><span class="n">fit1</span><span class="p">,</span><span class="w"> </span><span class="n">stand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">stars</span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">covs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Il calcolo delle saturazioni fattoriali con il metodo del centroide aveva prodotto il seguente risultato:</p>
<ul class="simple">
<li><p>classici (Cls): 0.97</p></li>
<li><p>inglese (Eng): 0.84</p></li>
<li><p>matematica (Mth): 0.73</p></li>
<li><p>pitch discrimination (Ptc): 0.65</p></li>
</ul>
<p>Si noti la somiglianza con i valori ottenuti mediante il metodo di massima verosimiglianza riportati nella figura.</p>
</section>
<section id="analisi-fattoriale-esplorativa">
<h3><span class="section-number">20.5.4. </span>Analisi fattoriale esplorativa<a class="headerlink" href="#analisi-fattoriale-esplorativa" title="Permalink to this heading">#</a></h3>
<p>Quando abbiamo un’unica variabile latente, l’analisi fattoriale confermativa si riduce al caso dell’analisi fattoriale esplorativa. Esaminiamo qui sotto la sintassi per l’analisi fattoriale esplorativa in <code class="docutils literal notranslate"><span class="pre">lavaan</span></code>.</p>
<p>Specifichiamo il modello.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">efa_model</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="s">&#39;</span>
<span class="s">    efa(&quot;efa&quot;)*g =~ Classics + French + English + Math + Pitch + Music</span>
<span class="s">&#39;</span>
</pre></div>
</div>
</div>
</div>
<p>Adattiamo il modello ai dati.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">fit2</span><span class="w"> </span><span class="o">&lt;-</span><span class="w"> </span><span class="n">lavaan</span><span class="o">::</span><span class="nf">cfa</span><span class="p">(</span>
<span class="w">  </span><span class="n">efa_model</span><span class="p">,</span>
<span class="w">  </span><span class="n">sample.cov</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spearman_cor_mat</span><span class="p">,</span>
<span class="w">  </span><span class="n">sample.nobs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">n</span><span class="p">,</span>
<span class="w">  </span><span class="n">std.lv</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Esaminiamo la soluzione ottenuta.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">summary</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span><span class="w"> </span><span class="n">standardized</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lavaan 0.6.15 ended normally after 3 iterations

  Estimator                                         ML
  Optimization method                           NLMINB
  Number of model parameters                        12

  Rotation method                       GEOMIN OBLIQUE
  Geomin epsilon                                 0.001
  Rotation algorithm (rstarts)                GPA (30)
  Standardized metric                             TRUE
  Row weights                                     None

  Number of observations                            33

Model Test User Model:
                                                      
  Test statistic                                 2.913
  Degrees of freedom                                 9
  P-value (Chi-square)                           0.968

Parameter Estimates:

  Standard errors                             Standard
  Information                                 Expected
  Information saturated (h1) model          Structured

Latent Variables:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
  g =~ efa                                                              
    Classics          0.942    0.129    7.314    0.000    0.942    0.956
    French            0.857    0.137    6.239    0.000    0.857    0.871
    English           0.795    0.143    5.545    0.000    0.795    0.807
    Math              0.732    0.149    4.923    0.000    0.732    0.743
    Pitch             0.678    0.153    4.438    0.000    0.678    0.689
    Music             0.643    0.155    4.142    0.000    0.643    0.653

Variances:
                   Estimate  Std.Err  z-value  P(&gt;|z|)   Std.lv  Std.all
   .Classics          0.083    0.051    1.629    0.103    0.083    0.086
   .French            0.234    0.072    3.244    0.001    0.234    0.242
   .English           0.338    0.094    3.610    0.000    0.338    0.349
   .Math              0.434    0.115    3.773    0.000    0.434    0.447
   .Pitch             0.510    0.132    3.855    0.000    0.510    0.526
   .Music             0.556    0.143    3.893    0.000    0.556    0.573
    g                 1.000                               1.000    1.000
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">nice_lavaanPlot</span><span class="p">(</span><span class="n">fit2</span><span class="p">,</span><span class="w"> </span><span class="n">stand</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">,</span><span class="w"> </span><span class="n">stars</span><span class="o">=</span><span class="w"> </span><span class="kc">FALSE</span><span class="p">,</span><span class="w"> </span><span class="n">covs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">TRUE</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="conclusioni">
<h2><span class="section-number">20.6. </span>Conclusioni<a class="headerlink" href="#conclusioni" title="Permalink to this heading">#</a></h2>
<p>Nel presente capitolo abbiamo introdotto il metodo dell’annullamento
della tetrade che consente di stimare le saturazioni di un modello
monofattoriale. Abbiamo anche visto che il metodo dell’annullamento
della tetrade non è altro che un’applicazione della correlazione
parziale.</p>
<p>Possiamo dire che un tema cruciale nella costruzione dei test
psicologici è quello di stabilire il numero di fattori/tratti che sono
soggiacenti all’insieme degli indicatori che vengono considerati. La
teoria classica dei test richiede che il test sia monofattoriale, ovvero
che gli indicatori considerati siano l’espressione di un unico tratto
latente. La violazione della monodimensionalità rende problematica
l’applicazione dei principi della teoria classica dei test ai punteggi
di un test che non possiede tale proprietà. L’esame della dimensionalità
di un gruppo di indicatori rappresenta dunque una fase cruciale nel
processo di costruzione di un test e, solitamente, questo esame è
affrontato mediante l’analisi fattoriale. In questo capitolo abbiamo
presentato le proprietà di base del modello unifattoriale.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="150_intro_fa.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title"><span class="section-number">19. </span>Introduzione all’analisi fattoriale</p>
      </div>
    </a>
    <a class="right-next"
       href="156_analisi_fattoriale_2.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">21. </span>Il modello statistico dell’analisi fattoriale</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#errore-di-misura">20.1. Errore di misura</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#modello-monofattoriale">20.2. Modello monofattoriale</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#correlazione-parziale">20.3. Correlazione parziale</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#principio-base-dell-analisi-fattoriale">20.4. Principio base dell’analisi fattoriale</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#vincoli-sulle-correlazioni">20.4.1. Vincoli sulle correlazioni</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#teoria-dei-due-fattori">20.4.2. Teoria dei Due Fattori</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#annullamento-della-tetrade">20.4.3. Annullamento della tetrade</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#metodo-del-centroide">20.4.4. Metodo del centroide</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduzione-a-lavaan">20.5. Introduzione a <code class="docutils literal notranslate"><span class="pre">lavaan</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sintassi-del-modello">20.5.1. Sintassi del modello</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#un-esempio-concreto">20.5.2. Un esempio concreto</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagrammi-di-percorso">20.5.3. Diagrammi di percorso</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#analisi-fattoriale-esplorativa">20.5.4. Analisi fattoriale esplorativa</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusioni">20.6. Conclusioni</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Corrado Caudek
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>